(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){module.exports={major:6,minor:3,patch:1,prerelease:null,toString:function(){return'6.3.1 (1d3aced)'},toArray:function(){return[6,3,1]}}},{}],2:[function(require,module,exports){module.exports={"majorVersionNumber":"3.x"}},{}],3:[function(require,module,exports){"use strict";var proto;var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var sharedRAFExecutorInstance=require('./sharedRAFExecutorInstance');var sharedRAFEmitterIDGeneratorInstance=require('./sharedRAFEmitterIDGeneratorInstance');function RAFEmitter(options){options=options||{};EventEmitterMicro.call(this);this.id=sharedRAFEmitterIDGeneratorInstance.getNewID();this.executor=options.executor||sharedRAFExecutorInstance;this._reset();this._willRun=!1;this._didDestroy=!1}
proto=RAFEmitter.prototype=Object.create(EventEmitterMicro.prototype);proto.run=function(){if(!this._willRun){this._willRun=!0}
return this._subscribe()};proto.cancel=function(){this._unsubscribe();if(this._willRun){this._willRun=!1}
this._reset()};proto.destroy=function(){var didCancel=this.willRun();this.cancel();this.executor=null;EventEmitterMicro.prototype.destroy.call(this);this._didDestroy=!0;return didCancel};proto.willRun=function(){return this._willRun};proto.isRunning=function(){return this._isRunning};proto._subscribe=function(){return this.executor.subscribe(this)};proto._unsubscribe=function(){return this.executor.unsubscribe(this)};proto._onAnimationFrameStart=function(data){this._isRunning=!0;this._willRun=!1;if(!this._didEmitFrameData){this._didEmitFrameData=!0;this.trigger('start',data)}};proto._onAnimationFrameEnd=function(data){if(!this._willRun){this.trigger('stop',data);this._reset()}};proto._reset=function(){this._didEmitFrameData=!1;this._isRunning=!1};module.exports=RAFEmitter},{"./sharedRAFEmitterIDGeneratorInstance":9,"./sharedRAFExecutorInstance":10,"@marcom/ac-event-emitter-micro":89}],4:[function(require,module,exports){"use strict";var proto;var EventEmitterMicro=require('@marcom/ac-event-emitter-micro/EventEmitterMicro');function RAFExecutor(options){options=options||{};this._reset();this.updatePhases();this.eventEmitter=new EventEmitterMicro();this._willRun=!1;this._totalSubscribeCount=-1;this._requestAnimationFrame=window.requestAnimationFrame;this._cancelAnimationFrame=window.cancelAnimationFrame;this._boundOnAnimationFrame=this._onAnimationFrame.bind(this);this._boundOnExternalAnimationFrame=this._onExternalAnimationFrame.bind(this)}
proto=RAFExecutor.prototype;proto.frameRequestedPhase='requested';proto.startPhase='start';proto.runPhases=['update','external','draw'];proto.endPhase='end';proto.disabledPhase='disabled';proto.beforePhaseEventPrefix='before:';proto.afterPhaseEventPrefix='after:';proto.subscribe=function(rafEmitter,shouldPrepend){this._totalSubscribeCount++;if(!this._nextFrameSubscribers[rafEmitter.id]){if(shouldPrepend){this._nextFrameSubscribersOrder.unshift(rafEmitter.id)}else{this._nextFrameSubscribersOrder.push(rafEmitter.id)}
this._nextFrameSubscribers[rafEmitter.id]=rafEmitter;this._nextFrameSubscriberArrayLength++;this._nextFrameSubscriberCount++;this._run()}
return this._totalSubscribeCount};proto.subscribeImmediate=function(rafEmitter,shouldRunInSamePhase){this._totalSubscribeCount++;if(!this._subscribers[rafEmitter.id]){if(!shouldRunInSamePhase){this._subscribersOrder.unshift(rafEmitter.id)}else{this._subscribersOrder.splice(this._currentSubscriberIndex+1,0,rafEmitter.id)}
this._subscribers[rafEmitter.id]=rafEmitter;this._subscriberArrayLength++;this._subscriberCount++}
return this._totalSubscribeCount};proto.unsubscribe=function(rafEmitter){if(!this._nextFrameSubscribers[rafEmitter.id]){return!1}
this._nextFrameSubscribers[rafEmitter.id]=null;this._nextFrameSubscriberCount--;if(this._nextFrameSubscriberCount===0){this._cancel()}
return!0};proto.getSubscribeID=function(){return this._totalSubscribeCount+=1};proto.destroy=function(){var didCancel=this._cancel();this.eventEmitter.destroy();this.eventEmitter=null;this.phases=null;this._subscribers=null;this._subscribersOrder=null;this._nextFrameSubscribers=null;this._nextFrameSubscribersOrder=null;this._rafData=null;this._boundOnAnimationFrame=null;this._onExternalAnimationFrame=null;return didCancel};proto.useExternalAnimationFrame=function(shouldUseExternalAnimationFrame){if(typeof shouldUseExternalAnimationFrame!=='boolean'){return}
var wasUsingExternalAnimationFrame=this._isUsingExternalAnimationFrame;if(shouldUseExternalAnimationFrame&&this._animationFrame){this._cancelAnimationFrame.call(window,this._animationFrame);this._animationFrame=null}
if(this._willRun&&!shouldUseExternalAnimationFrame&&!this._animationFrame){this._animationFrame=this._requestAnimationFrame.call(window,this._boundOnAnimationFrame)}
this._isUsingExternalAnimationFrame=shouldUseExternalAnimationFrame;if(shouldUseExternalAnimationFrame){return this._boundOnExternalAnimationFrame}
return wasUsingExternalAnimationFrame||!1};proto.updatePhases=function(){if(!this.phases){this.phases=[]}
this.phases.length=0;this.phases.push(this.frameRequestedPhase);this.phases.push(this.startPhase);Array.prototype.push.apply(this.phases,this.runPhases);this.phases.push(this.endPhase);this._runPhasesLength=this.runPhases.length;this._phasesLength=this.phases.length};proto._run=function(){if(!this._willRun){this._willRun=!0;if(this.lastFrameTime===0){this.lastFrameTime=performance.now()}
this._animationFrameActive=!0;if(!this._isUsingExternalAnimationFrame){this._animationFrame=this._requestAnimationFrame.call(window,this._boundOnAnimationFrame)}
if(this.phase===this.disabledPhase){this.phaseIndex=0;this.phase=this.phases[this.phaseIndex]}
return!0}};proto._cancel=function(){var result=!1;if(this._animationFrameActive){if(this._animationFrame){this._cancelAnimationFrame.call(window,this._animationFrame);this._animationFrame=null}
this._animationFrameActive=!1;this._willRun=!1;result=!0}
if(!this._isRunning){this._reset()}
return result};proto._onAnimationFrame=function(time){this._subscribers=this._nextFrameSubscribers;this._subscribersOrder=this._nextFrameSubscribersOrder;this._subscriberArrayLength=this._nextFrameSubscriberArrayLength;this._subscriberCount=this._nextFrameSubscriberCount;this._nextFrameSubscribers={};this._nextFrameSubscribersOrder=[];this._nextFrameSubscriberArrayLength=0;this._nextFrameSubscriberCount=0;this.phaseIndex=0;this.phase=this.phases[this.phaseIndex];this._isRunning=!0;this._willRun=!1;this._didRequestNextRAF=!1;this._rafData.delta=time-this.lastFrameTime;this.lastFrameTime=time;this._rafData.fps=0;if(this._rafData.delta>=1000){this._rafData.delta=0}
if(this._rafData.delta!==0){this._rafData.fps=1000/this._rafData.delta}
this._rafData.time=time;this._rafData.naturalFps=this._rafData.fps;this._rafData.timeNow=Date.now();this.phaseIndex++;this.phase=this.phases[this.phaseIndex];this.eventEmitter.trigger(this.beforePhaseEventPrefix+this.phase);for(this._currentSubscriberIndex=0;this._currentSubscriberIndex<this._subscriberArrayLength;this._currentSubscriberIndex++){if(this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]]!==null&&this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]]._didDestroy===!1){this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]]._onAnimationFrameStart(this._rafData)}}
this.eventEmitter.trigger(this.afterPhaseEventPrefix+this.phase);for(this._runPhaseIndex=0;this._runPhaseIndex<this._runPhasesLength;this._runPhaseIndex++){this.phaseIndex++;this.phase=this.phases[this.phaseIndex];this.eventEmitter.trigger(this.beforePhaseEventPrefix+this.phase);for(this._currentSubscriberIndex=0;this._currentSubscriberIndex<this._subscriberArrayLength;this._currentSubscriberIndex++){if(this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]]!==null&&this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]]._didDestroy===!1){this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]].trigger(this.phase,this._rafData)}}
this.eventEmitter.trigger(this.afterPhaseEventPrefix+this.phase)}
this.phaseIndex++;this.phase=this.phases[this.phaseIndex];this.eventEmitter.trigger(this.beforePhaseEventPrefix+this.phase);for(this._currentSubscriberIndex=0;this._currentSubscriberIndex<this._subscriberArrayLength;this._currentSubscriberIndex++){if(this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]]!==null&&this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]]._didDestroy===!1){this._subscribers[this._subscribersOrder[this._currentSubscriberIndex]]._onAnimationFrameEnd(this._rafData)}}
this.eventEmitter.trigger(this.afterPhaseEventPrefix+this.phase);if(this._willRun){this.phaseIndex=0;this.phaseIndex=this.phases[this.phaseIndex]}else{this._reset()}};proto._onExternalAnimationFrame=function(time){if(!this._isUsingExternalAnimationFrame){return}
this._onAnimationFrame(time)};proto._reset=function(){if(!this._rafData){this._rafData={}}
this._rafData.time=0;this._rafData.delta=0;this._rafData.fps=0;this._rafData.naturalFps=0;this._rafData.timeNow=0;this._subscribers={};this._subscribersOrder=[];this._currentSubscriberIndex=-1;this._subscriberArrayLength=0;this._subscriberCount=0;this._nextFrameSubscribers={};this._nextFrameSubscribersOrder=[];this._nextFrameSubscriberArrayLength=0;this._nextFrameSubscriberCount=0;this._didEmitFrameData=!1;this._animationFrame=null;this._animationFrameActive=!1;this._isRunning=!1;this._shouldReset=!1;this.lastFrameTime=0;this._runPhaseIndex=-1;this.phaseIndex=-1;this.phase=this.disabledPhase};module.exports=RAFExecutor},{"@marcom/ac-event-emitter-micro/EventEmitterMicro":90}],5:[function(require,module,exports){'use strict';var SingleCallRAFEmitter=require('./SingleCallRAFEmitter');var RAFInterface=function(phase){this.phase=phase;this.rafEmitter=new SingleCallRAFEmitter();this._cachePhaseIndex();this.requestAnimationFrame=this.requestAnimationFrame.bind(this);this.cancelAnimationFrame=this.cancelAnimationFrame.bind(this);this._onBeforeRAFExecutorStart=this._onBeforeRAFExecutorStart.bind(this);this._onBeforeRAFExecutorPhase=this._onBeforeRAFExecutorPhase.bind(this);this._onAfterRAFExecutorPhase=this._onAfterRAFExecutorPhase.bind(this);this.rafEmitter.on(this.phase,this._onRAFExecuted.bind(this));this.rafEmitter.executor.eventEmitter.on('before:start',this._onBeforeRAFExecutorStart);this.rafEmitter.executor.eventEmitter.on('before:'+this.phase,this._onBeforeRAFExecutorPhase);this.rafEmitter.executor.eventEmitter.on('after:'+this.phase,this._onAfterRAFExecutorPhase);this._frameCallbacks=[];this._currentFrameCallbacks=[];this._nextFrameCallbacks=[];this._phaseActive=!1;this._currentFrameID=-1;this._cancelFrameIdx=-1;this._frameCallbackLength=0;this._currentFrameCallbacksLength=0;this._nextFrameCallbacksLength=0;this._frameCallbackIteration=0};var proto=RAFInterface.prototype;proto.requestAnimationFrame=function(rafCallback,runInCurrentFrame){if(runInCurrentFrame===!0&&(this.rafEmitter.executor.phaseIndex>0&&this.rafEmitter.executor.phaseIndex<=this.phaseIndex)){if(!this._phaseActive){this._currentFrameID=this.rafEmitter.executor.subscribeImmediate(this.rafEmitter,!1);this._currentFrameCallbacks.push(this._currentFrameID,rafCallback);this._currentFrameCallbacksLength+=2}else{this._currentFrameID=this.rafEmitter.executor.subscribeImmediate(this.rafEmitter,!0);this._frameCallbacks.push(this._currentFrameID,rafCallback);this._frameCallbackLength+=2}}else{this._currentFrameID=this.rafEmitter.run();this._nextFrameCallbacks.push(this._currentFrameID,rafCallback);this._nextFrameCallbacksLength+=2}
return this._currentFrameID};proto.cancelAnimationFrame=function(id){this._cancelFrameIdx=this._nextFrameCallbacks.indexOf(id);if(this._cancelFrameIdx>-1){this._cancelNextAnimationFrame()}else{this._cancelFrameIdx=this._currentFrameCallbacks.indexOf(id);if(this._cancelFrameIdx>-1){this._cancelCurrentAnimationFrame()}else{this._cancelFrameIdx=this._frameCallbacks.indexOf(id);if(this._cancelFrameIdx>-1){this._cancelRunningAnimationFrame()}}}};proto._onRAFExecuted=function(e){for(this._frameCallbackIteration=0;this._frameCallbackIteration<this._frameCallbackLength;this._frameCallbackIteration+=2){this._frameCallbacks[this._frameCallbackIteration+1](e.time,e)}
this._frameCallbacks.length=0;this._frameCallbackLength=0};proto._onBeforeRAFExecutorStart=function(){Array.prototype.push.apply(this._currentFrameCallbacks,this._nextFrameCallbacks.splice(0,this._nextFrameCallbacksLength));this._currentFrameCallbacksLength=this._nextFrameCallbacksLength;this._nextFrameCallbacks.length=0;this._nextFrameCallbacksLength=0};proto._onBeforeRAFExecutorPhase=function(){this._phaseActive=!0;Array.prototype.push.apply(this._frameCallbacks,this._currentFrameCallbacks.splice(0,this._currentFrameCallbacksLength));this._frameCallbackLength=this._currentFrameCallbacksLength;this._currentFrameCallbacks.length=0;this._currentFrameCallbacksLength=0};proto._onAfterRAFExecutorPhase=function(){this._phaseActive=!1};proto._cachePhaseIndex=function(){this.phaseIndex=this.rafEmitter.executor.phases.indexOf(this.phase)};proto._cancelRunningAnimationFrame=function(){this._frameCallbacks.splice(this._cancelFrameIdx,2);this._frameCallbackLength-=2};proto._cancelCurrentAnimationFrame=function(){this._currentFrameCallbacks.splice(this._cancelFrameIdx,2);this._currentFrameCallbacksLength-=2};proto._cancelNextAnimationFrame=function(){this._nextFrameCallbacks.splice(this._cancelFrameIdx,2);this._nextFrameCallbacksLength-=2;if(this._nextFrameCallbacksLength===0){this.rafEmitter.cancel()}};module.exports=RAFInterface},{"./SingleCallRAFEmitter":7}],6:[function(require,module,exports){'use strict';var RAFInterface=require('./RAFInterface');var RAFInterfaceController=function(){this.events={}};var proto=RAFInterfaceController.prototype;proto.requestAnimationFrame=function(evt){if(!this.events[evt]){this.events[evt]=new RAFInterface(evt)}
return this.events[evt].requestAnimationFrame};proto.cancelAnimationFrame=function(evt){if(!this.events[evt]){this.events[evt]=new RAFInterface(evt)}
return this.events[evt].cancelAnimationFrame};module.exports=new RAFInterfaceController()},{"./RAFInterface":5}],7:[function(require,module,exports){'use strict';var RAFEmitter=require('./RAFEmitter');var SingleCallRAFEmitter=function(options){RAFEmitter.call(this,options)};var proto=SingleCallRAFEmitter.prototype=Object.create(RAFEmitter.prototype);proto._subscribe=function(){return this.executor.subscribe(this,!0)};module.exports=SingleCallRAFEmitter},{"./RAFEmitter":3}],8:[function(require,module,exports){'use strict';var RAFInterfaceController=require('./RAFInterfaceController');module.exports=RAFInterfaceController.cancelAnimationFrame('update')},{"./RAFInterfaceController":6}],9:[function(require,module,exports){'use strict';var SharedInstance=require('@marcom/ac-shared-instance').SharedInstance;var majorVersionNumber=require('https://www.apple.com/jobs/.release-info.js').majorVersionNumber;var RAFEmitterIDGenerator=function(){this._currentID=0}
RAFEmitterIDGenerator.prototype.getNewID=function(){this._currentID++;return'raf:'+this._currentID};module.exports=SharedInstance.share('@marcom/ac-raf-emitter/sharedRAFEmitterIDGeneratorInstance',majorVersionNumber,RAFEmitterIDGenerator)},{"../.release-info.js":2,"@marcom/ac-shared-instance":163}],10:[function(require,module,exports){'use strict';var SharedInstance=require('@marcom/ac-shared-instance').SharedInstance;var majorVersionNumber=require('https://www.apple.com/jobs/.release-info.js').majorVersionNumber;var RAFExecutor=require('./RAFExecutor');module.exports=SharedInstance.share('@marcom/ac-raf-emitter/sharedRAFExecutorInstance',majorVersionNumber,RAFExecutor)},{"../.release-info.js":2,"./RAFExecutor":4,"@marcom/ac-shared-instance":163}],11:[function(require,module,exports){'use strict';var RAFInterfaceController=require('./RAFInterfaceController');module.exports=RAFInterfaceController.requestAnimationFrame('update')},{"./RAFInterfaceController":6}],12:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var vector3CordsFromLatLon=require('./utils/vector3FromLatLon');var update=require('@marcom/ac-raf-emitter/update');var cancelUpdate=require('@marcom/ac-raf-emitter/cancelUpdate');var PointerControls=require('./controls/PointerControls');var OrientationControls=require('./controls/OrientationControls');var EventEmitterMicro=require('@marcom/ac-event-emitter-micro/EventEmitterMicro');var createBezier=require('@marcom/ac-easing/src/ac-easing/createBezier');var acUserAgent=require('@marcom/ac-useragent');var simpleTimer=require('./utils/simpleTimer');var inverseLongitude=require('./utils/inverseLongitude');var ArrowControls=require('./controls/ArrowControls');var map=require('./utils/map');var WEBGL_SUPPORTED=require('@marcom/ac-feature/webGLAvailable')();var loadScript=require('./utils/loadScript');var IS_IOS=acUserAgent.os.ios;var MAX_LATITUDE=80;var OVERSHOOT_MULTIPLIER=1.25;var POWER_PREFERENCE=acUserAgent.browser.safari&&acUserAgent.os.osx?'high-performance':'default';var DEFAULT_PAN_VELOCITY={slow:80,fast:120};var EASE=createBezier(0.25,0.1,0,1);var SINE_EASE=createBezier(0.1,0.15,0,1);var MAP_MIN_VALUE=0.001;var MAP_MAX_VALUE=0.999;var ROTATION_DURATION=1600;var OSCILLATION_DURATON=1600;var OSCILLATION_DISTANCE=12;var DEFAULT_THREE_URL='https://www.apple.com/ac/libs/three/92/three.min.js';var AC360=function(_EventEmitterMicro){_inherits(AC360,_EventEmitterMicro);function AC360(options){_classCallCheck(this,AC360);var _this=_possibleConstructorReturn(this,(AC360.__proto__||Object.getPrototypeOf(AC360)).call(this));_this.el=options.el;if(!WEBGL_SUPPORTED){setTimeout(function(){_this.trigger('error')})}
_this._textureSrc=options.src;if(options.video){_this._videoElement=options.video}else if(options.src instanceof HTMLVideoElement){_this._videoElement=options.src}else if(_this._textureSrc&&(_this._textureSrc.endsWith('.mp4')||_this._textureSrc.endsWith('.m3u8')||_this._textureSrc.endsWith('.webm'))){_this._videoElement=document.createElement('video')}
_this._maxLat=options.maxLat||MAX_LATITUDE;_this._pointerControls=new PointerControls({el:options.mouseTarget||_this.el});_this.arrowControls=new ArrowControls();_this._easing=options.easing||EASE;_this._sineEasing=options.sineEasing||SINE_EASE;_this._mapMinValue=options.mapMinValue!==undefined?options.mapMinValue:MAP_MIN_VALUE;_this._mapMaxValue=options.mapMaxValue||MAP_MAX_VALUE;_this._rotationDuration=options.rotationDuration||ROTATION_DURATION;if(IS_IOS){_this._orientationControls=new OrientationControls()}
_this._panVelocity=Object.assign({},options.panVelocity||DEFAULT_PAN_VELOCITY);_this._overshootMultiplier=options.overshootMultiplier||OVERSHOOT_MULTIPLIER;_this._oscillationDuration=options.ocillationDuration||OSCILLATION_DURATON;_this._oscillationDistance=options.ocillationDistance||OSCILLATION_DISTANCE;_this._bindMethods();var promise=window.THREE?Promise.resolve():loadScript(options.threeUrl||DEFAULT_THREE_URL);_this._cachedPos={lat:0,lon:0};promise.then(function(){_this._attach();_this.refreshSize()});return _this}
_createClass(AC360,[{key:'_bindMethods',value:function _bindMethods(){this._onPlaying=this._onPlaying.bind(this)}},{key:'_attach',value:function _attach(){this._distance=50;var pos={lat:0,lon:0};this._cachedPos=pos;this._pointerControls.position=pos;if(this._orientationControls){this._orientationControls.position=pos}
var width=this.el.clientWidth;var height=this.el.clientHeight;var aspect=width/height;this._camera=new THREE.PerspectiveCamera(75,aspect,1,1100);this._camera.target=new THREE.Vector3(0,0,0);this._scene=new THREE.Scene();this._geometry=new THREE.SphereBufferGeometry(500,60,40);this._geometry.scale(-1,1,1);this._texture=this._createTexture(this._textureSrc);this._material=new THREE.MeshBasicMaterial({map:this._texture});this._mesh=new THREE.Mesh(this._geometry,this._material);this._scene.add(this._mesh);this._renderer=new THREE.WebGLRenderer({antialias:!1,powerPreference:POWER_PREFERENCE});this._renderer.setPixelRatio(window.devicePixelRatio);this._renderer.setSize(width,height);this._renderer.domElement.classList.add('threesixty-renderer');this.el.appendChild(this._renderer.domElement);this._animate=this._animate.bind(this);this._animateRAF=update(this._animate)}},{key:'_animate',value:function _animate(){this._update();this._animateRAF=update(this._animate)}},{key:'_update',value:function _update(position){if(!window.THREE){return}
var pos=position;if(pos){}else if(this.arrowControls.isActive){pos=this.arrowControls.position}else if(this._pointerControls.isActive){pos=this._pointerControls.position}else if(this._orientationControls){pos=this._orientationControls.position}else{pos=this._cachedPos}
var trigger=!1;if(this._cachedPos.lat!==pos.lat||this._cachedPos.lon!==pos.lon){trigger=!0}else if(!this._videoElement||this._videoElement.paused){return}
var lat=Math.max(-this._maxLat,Math.min(this._maxLat,pos.lat));var phi=THREE.Math.degToRad(90-lat);var theta=THREE.Math.degToRad(pos.lon);var x=this._distance*Math.sin(phi)*Math.cos(theta);var y=this._distance*Math.cos(phi);var z=this._distance*Math.sin(phi)*Math.sin(theta);this._camera.zoom=this._pointerControls.scale;this._camera.position.x=x;this._camera.position.y=y;this._camera.position.z=z;this._camera.lookAt(this._camera.target);this._camera.updateProjectionMatrix();this._renderer.render(this._scene,this._camera);var newPos={lat:lat,lon:pos.lon,x:x,y:y,z:z};this._cachedPos={lat:newPos.lat,lon:newPos.lon,x:newPos.x,y:newPos.y,z:newPos.z};this._pointerControls.position=newPos;this.arrowControls.position=newPos;if(this._orientationControls){this._orientationControls.position=newPos}
if(!this._originQuaternion){this._originQuaternion=new THREE.Quaternion().copy(this._camera.quaternion)}
if(trigger){this.trigger(AC360.POSITION_CHANGE)}}},{key:'_createTexture',value:function _createTexture(src){if(src instanceof HTMLVideoElement){this._videoElement=src;this._videoElement.setAttribute('playsinline','playsinline');this._videoElement.setAttribute('webkit-playsinline','webkit-playsinline');this._videoElement.addEventListener('playing',this._onPlaying);var texture=new THREE.VideoTexture(this._videoElement);texture.minFilter=THREE.LinearFilter;texture.format=THREE.RGBFormat;return texture}else if(src.endsWith('.mp4')||src.endsWith('.m3u8')||src.endsWith('.webm')){if(!this._videoElement){this._videoElement=document.createElement('video')}
this._videoElement.src=src;this._videoElement.loop=!0;this._videoElement.muted=!0;this._videoElement.crossOrigin='anonymous';this._videoElement.setAttribute('webkit-playsinline','webkit-playsinline');this._videoElement.setAttribute('playsinline','playsinline');this._videoElement=this._videoElement;this._videoElement.addEventListener('playing',this._onPlaying);var _texture=new THREE.VideoTexture(this._videoElement);_texture.minFilter=THREE.LinearFilter;_texture.format=THREE.RGBFormat;return _texture}else{this._orientationControls.enable();return new THREE.TextureLoader().load(src)}}},{key:'refreshSize',value:function refreshSize(){this._onResize()}},{key:'setPos',value:function setPos(lat,lon){if(this._pointerControls){this._pointerControls.position={lat:lat,lon:lon}}
if(this._orientationControls){this._orientationControls.position={lat:lat,lon:lon}}
this._update({lat:lat,lon:lon})}},{key:'_onResize',value:function _onResize(){if(!window.THREE||!this._camera||!this._renderer){return}
var width=void 0;var height=void 0;if(this._videoElement.parentElement){width=this._videoElement.clientWidth;height=this._videoElement.clientHeight}else{width=this.el.clientWidth;height=this.el.clientHeight}
cancelUpdate(this._animateRAF);this._pointerControls.setViewerSize(width,height);this._camera.aspect=width/height;this._camera.updateProjectionMatrix();this._renderer.setSize(width,height);this._renderer.render(this._scene,this._camera);this._animate()}},{key:'_onPlaying',value:function _onPlaying(){this._videoElement.removeEventListener('playing',this._onPlaying);if(this._orientationControls){this._orientationControls.enable()}}},{key:'play',value:function play(){if(this._videoElement){this._videoElement.play()}}},{key:'pause',value:function pause(){if(this._videoElement&&!this._videoElement.paused){this._videoElement.pause()}}},{key:'sendMouseDown',value:function sendMouseDown(evt){this._pointerControls.sendMouseDown(evt)}},{key:'destroy',value:function destroy(){_get(AC360.prototype.__proto__||Object.getPrototypeOf(AC360.prototype),'destroy',this).call(this)}},{key:'oscillateLongitude',value:function oscillateLongitude(){var _this2=this;this._pointerControls.cancelInertia();this.arrowControls.cancelInertia();var start=new THREE.Vector2(this.position.lon,this.position.lat);var time=this._oscillationDuration;var payload={time:time,startPosition:Object.assign({},this.position),targetPosition:Object.assign({},this.position)};this.trigger(AC360.ROTATION_START,payload);return new Promise(function(resolve){simpleTimer(time,function(t){var value=Math.sin(Math.PI*_this2._sineEasing.getValue(t));var adjustedVector=new THREE.Vector2().copy(start);adjustedVector.x=start.x-value*_this2._oscillationDistance;var newVect=vector3CordsFromLatLon(adjustedVector.y,adjustedVector.x,_this2._distance);_this2.trigger(AC360.ROTATION_UPDATE,{t:t,easedVal:value,startPosition:payload.startPosition,currentPosition:{lat:adjustedVector.y,lon:adjustedVector.x},targetPosition:payload.targetPosition});_this2._camera.position.copy(newVect);_this2._camera.lookAt(_this2._camera.target);_this2._camera.updateProjectionMatrix();_this2._renderer.render(_this2._scene,_this2._camera)}).then(function(){_this2.trigger(AC360.ROTATION_COMPLETE,payload);_this2.setPos(start.y,start.x);_this2._animate();resolve()})})}},{key:'panToPosition',value:function panToPosition(pos){return this._respositionCameraToPosition(pos)}},{key:'_respositionCameraToPosition',value:function _respositionCameraToPosition(pos){var _this3=this;this._pointerControls.cancelInertia();this.arrowControls.cancelInertia();if(pos.lat===this.position.lat&&pos.lon===this.position.lon){this.trigger(AC360.ROTATION_START,{time:0,startPosition:Object.assign({},this.position),targetPosition:Object.assign({},this.position)});this.trigger(AC360.ROTATION_COMPLETE,{time:1,startPosition:Object.assign({},this.position),targetPosition:Object.assign({},this.position)});return Promise.resolve()}
var start=new THREE.Vector2(this.position.lon,this.position.lat);var inversedEnd=new THREE.Vector2(inverseLongitude(pos.lon),pos.lat);var end=new THREE.Vector2(pos.lon,pos.lat);var distanceTo=start.distanceTo(end);var distanceToInversed=start.distanceTo(inversedEnd);if(distanceToInversed<distanceTo){distanceTo=distanceToInversed;end=inversedEnd}
var vect=new THREE.Vector2().copy(start);cancelUpdate(this._animateRAF);var time=this._rotationDuration;var payload={time:time,startPosition:Object.assign({},this._cachedPos),targetPosition:Object.assign({},pos)};this.trigger(AC360.ROTATION_START,payload);return new Promise(function(resolve){simpleTimer(time,function(t){var easedVal=void 0;if(t===1){easedVal=1}else{easedVal=map(_this3._easing.getValue(t),0,1,_this3._mapMinValue,_this3._mapMaxValue)}
var lerpedLatLon=vect.lerpVectors(start,end,easedVal);var newVect=vector3CordsFromLatLon(lerpedLatLon.y,lerpedLatLon.x,_this3._distance);_this3._camera.position.copy(newVect);_this3._camera.lookAt(_this3._camera.target);_this3._camera.updateProjectionMatrix();_this3._renderer.render(_this3._scene,_this3._camera);_this3.trigger(AC360.ROTATION_UPDATE,{t:t,easedVal:easedVal,startPosition:payload.startPosition,currentPosition:{lat:lerpedLatLon.y,lon:lerpedLatLon.x},targetPosition:{lat:end.x,lon:end.y}})}).then(function(){_this3.trigger(AC360.ROTATION_COMPLETE,payload);_this3.setPos(pos.lat,pos.lon);_this3._animate();resolve()})})}},{key:'position',get:function get(){return Object.assign({},this._cachedPos)}},{key:'isAtOrigin',get:function get(){return Math.abs(this.position.lat)<=0.5&&Math.abs(this.position.lon)<=0.5}},{key:'mediaElement',get:function get(){return this._videoElement}}]);return AC360}(EventEmitterMicro);AC360.ROTATION_START='RotationStart';AC360.ROTATION_UPDATE='RotationUpdate';AC360.ROTATION_COMPLETE='RotationComplete';AC360.POSITION_CHANGE='360PositionChange';module.exports=AC360},{"./controls/ArrowControls":14,"./controls/OrientationControls":16,"./controls/PointerControls":17,"./utils/inverseLongitude":18,"./utils/loadScript":19,"./utils/map":20,"./utils/simpleTimer":22,"./utils/vector3FromLatLon":23,"@marcom/ac-easing/src/ac-easing/createBezier":87,"@marcom/ac-event-emitter-micro/EventEmitterMicro":90,"@marcom/ac-feature/webGLAvailable":99,"@marcom/ac-raf-emitter/cancelUpdate":8,"@marcom/ac-raf-emitter/update":11,"@marcom/ac-useragent":195}],13:[function(require,module,exports){'use strict';module.exports=require('./AC360')},{"./AC360":12}],14:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var InertialControls=require('./InertialControls');var normalizeLongitude=require('../utils/normalizeLongitude');var update=require('@marcom/ac-raf-emitter/update');var cancelUpdate=require('@marcom/ac-raf-emitter/cancelUpdate');var DEFAULT_OPTIONS={acceleration:{x:0.6,y:0.6},friction:{x:0.95,y:0.95},minVelocity:0.1,maxVelocity:20};var ArrowControls=function(_InertialControls){_inherits(ArrowControls,_InertialControls);function ArrowControls(options){_classCallCheck(this,ArrowControls);options=Object.assign({},DEFAULT_OPTIONS,options);var _this=_possibleConstructorReturn(this,(ArrowControls.__proto__||Object.getPrototypeOf(ArrowControls)).call(this,options));_this._bindMethods();return _this}
_createClass(ArrowControls,[{key:'_bindMethods',value:function _bindMethods(){this.leftArrowDown=this.leftArrowDown.bind(this);this.rightArrowDown=this.rightArrowDown.bind(this);this.downArrowDown=this.downArrowDown.bind(this);this.upArrowDown=this.upArrowDown.bind(this);this.leftArrowUp=this.leftArrowUp.bind(this);this.rightArrowUp=this.rightArrowUp.bind(this);this.downArrowUp=this.downArrowUp.bind(this);this.upArrowUp=this.upArrowUp.bind(this);_get(ArrowControls.prototype.__proto__||Object.getPrototypeOf(ArrowControls.prototype),'_bindMethods',this).call(this)}},{key:'leftArrowDown',value:function leftArrowDown(){if(Math.abs(this._velocity.x-this._horizontalIncrement)<this._maxVelocity){this._velocity.x-=this._horizontalIncrement}else{this._velocity.x=-this._maxVelocity}
this._lon=normalizeLongitude(this._lon+this._velocity.x);this._triggerInertia()}},{key:'rightArrowDown',value:function rightArrowDown(){if(Math.abs(this._velocity.x+this._horizontalIncrement)<this._maxVelocity){this._velocity.x+=this._horizontalIncrement}else{this._velocity.x=this._maxVelocity}
this._velocity.x+=this._horizontalIncrement;this._lon=normalizeLongitude(this._lon+this._velocity.x);this._triggerInertia()}},{key:'upArrowDown',value:function upArrowDown(evt){if(Math.abs(this._velocity.y-this._verticalIncrement)<this._maxVelocity){this._velocity.y-=this._verticalIncrement}else{this._velocity.y=-this._maxVelocity}
this._lat=this._lat+this._velocity.y;this._triggerInertia()}},{key:'downArrowDown',value:function downArrowDown(){if(Math.abs(this._velocity.y+this._verticalIncrement)<this._maxVelocity){this._velocity.y+=this._verticalIncrement}else{this._velocity.y=this._maxVelocity}
this._lat=this._lat+this._velocity.y;this._triggerInertia()}},{key:'leftArrowUp',value:function leftArrowUp(){this._triggerInertia()}},{key:'rightArrowUp',value:function rightArrowUp(){this._triggerInertia()}},{key:'upArrowUp',value:function upArrowUp(){this._triggerInertia()}},{key:'downArrowUp',value:function downArrowUp(){this._triggerInertia()}},{key:'_triggerInertia',value:function _triggerInertia(){cancelUpdate(this._inertiaRaf);update(this._updateInertia)}},{key:'isActive',get:function get(){return Math.abs(this._velocity.x)>this._minVelocity||Math.abs(this._velocity.y)>this._minVelocity}}]);return ArrowControls}(InertialControls);module.exports=ArrowControls},{"../utils/normalizeLongitude":21,"./InertialControls":15,"@marcom/ac-raf-emitter/cancelUpdate":8,"@marcom/ac-raf-emitter/update":11}],15:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var update=require('@marcom/ac-raf-emitter/update');var cancelUpdate=require('@marcom/ac-raf-emitter/cancelUpdate');var normalizeLongitude=require('../utils/normalizeLongitude');var FRICTION=0.5;var DEFAULT_INCREMENT=0.1;var MIN_VELOCITY=5;var MAX_VELOCITY=20;var InertialControls=function(){function InertialControls(){var options=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};_classCallCheck(this,InertialControls);this._horizontalFriction=options.friction&&options.friction.x||FRICTION;this._verticalFriction=options.friction&&options.friction.x||FRICTION;this._horizontalIncrement=options.acceleration&&options.acceleration.x||DEFAULT_INCREMENT;this._verticalIncrement=options.acceleration&&options.acceleration.y||DEFAULT_INCREMENT;this._minVelocity=options.minVelocity||MIN_VELOCITY;this._maxVelocity=options.maxVelocity||MAX_VELOCITY;this._velocity={x:0,y:0};this._bindMethods()}
_createClass(InertialControls,[{key:'_bindMethods',value:function _bindMethods(){this._updateInertia=this._updateInertia.bind(this)}},{key:'_updateInertia',value:function _updateInertia(){if(Math.abs(this._velocity.x)>this._minVelocity||Math.abs(this._velocity.y)>this._minVelocity){this._velocity.x*=this._horizontalFriction;this._velocity.y*=this._verticalFriction;this._lon+=this._velocity.x*this._horizontalIncrement;this._lat+=this._velocity.y*this._verticalIncrement;this._inertiaRaf=update(this._updateInertia)}else{this._velocity={x:0,y:0};cancelUpdate(this._inertiaRaf);this._inertiaComplete()}}},{key:'cancelInertia',value:function cancelInertia(){this._velocity={x:0,y:0};cancelUpdate(this._inertiaRaf)}},{key:'_inertiaComplete',value:function _inertiaComplete(){}},{key:'position',set:function set(pos){this._lat=pos.lat;this._lon=normalizeLongitude(pos.lon)},get:function get(){return{lat:this._lat,lon:this._lon}}}]);return InertialControls}();module.exports=InertialControls},{"../utils/normalizeLongitude":21,"@marcom/ac-raf-emitter/cancelUpdate":8,"@marcom/ac-raf-emitter/update":11}],16:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var normalizeLongitude=require('../utils/normalizeLongitude');var ORIENTATION_MOTION_MULTIPLIER=0.02;var OrientationControls=function(){function OrientationControls(options){_classCallCheck(this,OrientationControls);this._bindMethods()}
_createClass(OrientationControls,[{key:'_bindMethods',value:function _bindMethods(){this._onOrientation=this._onOrientation.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){window.addEventListener('devicemotion',this._onOrientation,!0)}},{key:'_removeEventListeners',value:function _removeEventListeners(){window.removeEventListener('devicemotion',this._onOrientation,!0)}},{key:'_onOrientation',value:function _onOrientation(evt){if(window.matchMedia('(orientation: portrait)').matches){this._lon=normalizeLongitude(this._lon-evt.rotationRate.beta*ORIENTATION_MOTION_MULTIPLIER);this._lat=this._lat-evt.rotationRate.alpha*ORIENTATION_MOTION_MULTIPLIER}else{if(evt.orientation||window.orientation===-90){this._lon=normalizeLongitude(this._lon+evt.rotationRate.alpha*ORIENTATION_MOTION_MULTIPLIER);this._lat=this._lat-evt.rotationRate.beta*ORIENTATION_MOTION_MULTIPLIER}else{this._lon=normalizeLongitude(this._lon-evt.rotationRate.alpha*ORIENTATION_MOTION_MULTIPLIER);this._lat=this._lat+evt.rotationRate.beta*ORIENTATION_MOTION_MULTIPLIER}}}},{key:'disable',value:function disable(){this._removeEventListeners()}},{key:'enable',value:function enable(){this._addEventListeners()}},{key:'destroy',value:function destroy(){this._removeEventListeners()}},{key:'position',set:function set(pos){this._lat=pos.lat;this._lon=normalizeLongitude(pos.lon)},get:function get(){return{lat:this._lat,lon:this._lon}}}]);return OrientationControls}();module.exports=OrientationControls},{"../utils/normalizeLongitude":21}],17:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var normalizeLongitude=require('../utils/normalizeLongitude');var InertialControls=require('./InertialControls');var MOUSE_MOTION_MULTIPLIER=0.1;var TOUCH_MOTION_MULTIPLIER=0.1;var FRICTION=0.95;var MIN_VELOCITY=0.5;var MAX_VELOCITY=15;var FOV_WIDTH=135;var FOV_HEIGHT=90;var DEFAULT_OPTIONS={acceleration:{x:MOUSE_MOTION_MULTIPLIER,y:MOUSE_MOTION_MULTIPLIER},friction:{x:FRICTION,y:FRICTION},minVelocity:MIN_VELOCITY,maxVelocity:20};var PointerControls=function(_InertialControls){_inherits(PointerControls,_InertialControls);function PointerControls(options){_classCallCheck(this,PointerControls);options=Object.assign({},DEFAULT_OPTIONS,options);var _this=_possibleConstructorReturn(this,(PointerControls.__proto__||Object.getPrototypeOf(PointerControls)).call(this,options));_this.el=options.el;_this._mouseDown=!1;_this._scale=1;_this._hasInertia=options.inertia===!1?options.inertia:!0;_this._bindMethods();_this._addEventListeners();return _this}
_createClass(PointerControls,[{key:'_bindMethods',value:function _bindMethods(){this._onMouseMove=this._onMouseMove.bind(this);this._onMouseDown=this._onMouseDown.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onTouchMove=this._onTouchMove.bind(this);this._onClick=this._onClick.bind(this);_get(PointerControls.prototype.__proto__||Object.getPrototypeOf(PointerControls.prototype),'_bindMethods',this).call(this)}},{key:'_addEventListeners',value:function _addEventListeners(){this.el.addEventListener('mousedown',this._onMouseDown);this.el.addEventListener('touchstart',this._onMouseDown,{passive:!1});this.el.addEventListener('click',this._onClick);this.el.addEventListener('touchmove',this._onTouchMove,{passive:!1})}},{key:'_removeEventListeners',value:function _removeEventListeners(){this.el.removeEventListener('mousedown',this._onMouseDown);this.el.removeEventListener('touchstart',this._onMouseDown);window.removeEventListener('mousemove',this._onMouseMove);window.removeEventListener('mouseup',this._onMouseUp);this.el.removeEventListener('touchmove',this._onTouchMove);document.body.removeEventListener('touchmove',this._onTouchMove);document.body.removeEventListener('touchend',this._onMouseUp)}},{key:'_onMouseUp',value:function _onMouseUp(evt){var _this2=this;window.removeEventListener('mousemove',this._onMouseMove);window.removeEventListener('mouseup',this._onMouseUp);document.body.removeEventListener('touchmove',this._onTouchMove);document.body.removeEventListener('touchend',this._onMouseUp);if(this._mouseDown&&this._hasInertia&&Date.now()-this._mouseMoveTime<300){this._updateInertia()}
setTimeout(function(){if(!_this2._mouseDown){_this2._dragging=!1}},350);this._mouseDown=!1}},{key:'sendMouseDown',value:function sendMouseDown(evt){this._onMouseDown(evt)}},{key:'_onClick',value:function _onClick(evt){if(this._dragging){return}
this._velocity={x:0,y:0};this._mouseDown=!1;this._cachedPosition=evt;document.removeEventListener('mousemove',this._onMouseMove);document.removeEventListener('mouseup',this._onMouseUp);document.body.removeEventListener('touchmove',this._onTouchMove);document.body.removeEventListener('touchend',this._onMouseUp)}},{key:'_onMouseDown',value:function _onMouseDown(evt){this._mouseDownTime=Date.now();var position=evt;if(evt.touches){if(evt.touches.length===1){position=evt.touches[0]}else{return}}
this._cachedPosition=evt;window.addEventListener('mousemove',this._onMouseMove);window.addEventListener('mouseup',this._onMouseUp);document.body.addEventListener('touchmove',this._onTouchMove,{passive:!1});document.body.addEventListener('touchend',this._onMouseUp);this._mouseDown=!0;this._lastMouseX=position.clientX;this._lastMouseY=position.clientY;this._lastMouseDownLon=normalizeLongitude(this._lon);this._lastMouseDownLat=this._lat}},{key:'_onTouchMove',value:function _onTouchMove(evt){if(evt.cancelable){evt.preventDefault()}
this._onMouseMove(evt)}},{key:'_onMouseMove',value:function _onMouseMove(evt){if(!this._mouseDown){return}
this._dragging=!0;var position=evt;if(evt.touches){position=evt.touches[0]}
if(this._cachedPosition.clientX===position.clientX&&this._cachedPosition.clientY===position.clientY){return}
var xDelta=this._lastMouseX-position.clientX;var yDelta=this._lastMouseY-position.clientY;var xMultiplier=xDelta/this._viewerWidth;var yMultiplier=yDelta/this._viewerHeight;if(this._cachedPosition){var xVelocityDelta=this._cachedPosition.clientX-position.clientX;var yVelocityDelta=this._cachedPosition.clientY-position.clientY;this._velocity.x=Math.max(Math.min(xVelocityDelta,this._maxVelocity),-this._maxVelocity);this._velocity.y=Math.max(Math.min(yVelocityDelta,this._maxVelocity),-this._maxVelocity)}
this._lon=normalizeLongitude(xMultiplier*FOV_WIDTH+this._lastMouseDownLon);this._lat=yMultiplier*FOV_HEIGHT+this._lastMouseDownLat;this._cachedPosition=position;this._mouseMoveTime=Date.now()}},{key:'setViewerSize',value:function setViewerSize(width,height){this._viewerWidth=width;this._viewerHeight=height}},{key:'destroy',value:function destroy(){this._removeEventListeners()}},{key:'isActive',get:function get(){return this._mouseDown||this._hasInertia&&(Math.abs(this._velocity.x)>this._minVelocity||Math.abs(this._velocity.y)>this._minVelocity)}},{key:'scale',get:function get(){return this._scale}}]);return PointerControls}(InertialControls);module.exports=PointerControls},{"../utils/normalizeLongitude":21,"./InertialControls":15}],18:[function(require,module,exports){'use strict';var normalizeLongitude=require('./normalizeLongitude');module.exports=function(lon){var newLon=lon;if(Math.abs(newLon)>180){return normalizeLongitude(newLon)}else if(newLon>0){return-360+newLon}else{return 360+newLon}}},{"./normalizeLongitude":21}],19:[function(require,module,exports){'use strict';module.exports=function loadScript(url){return new Promise(function(resolve,reject){var scriptEl=document.createElement('script');scriptEl.type='text/javascript';scriptEl.src=url;scriptEl.onload=resolve;scriptEl.onerror=reject;try{document.body.appendChild(scriptEl)}catch(err){reject(err)}})}},{}],20:[function(require,module,exports){"use strict";module.exports=function(value,low1,high1,low2,high2){return low2+(high2-low2)*(value-low1)/(high1-low1)}},{}],21:[function(require,module,exports){"use strict";module.exports=function(lon){var newLon=lon;if(newLon>180){newLon=newLon%180-180}else if(newLon<=-180){newLon=newLon%180+180}
return newLon}},{}],22:[function(require,module,exports){'use strict';var update=require('@marcom/ac-raf-emitter/update');module.exports=function simpleTimer(time,func){var lastT=0;return new Promise(function(resolve){var startTime=performance.now();var tween=function tween(){var delta=performance.now()-startTime;var t=delta/time;if(t>=1){func(1);resolve()}else{lastT=t;func(t);update(tween)}};update(tween)})}},{"@marcom/ac-raf-emitter/update":11}],23:[function(require,module,exports){"use strict";function vector3FromLatLon(lat,lon,distance){var phi=THREE.Math.degToRad(90-lat);var theta=THREE.Math.degToRad(lon);var x=distance*Math.sin(phi)*Math.cos(theta);var y=distance*Math.cos(phi);var z=distance*Math.sin(phi)*Math.sin(theta);return new THREE.Vector3(x,y,z)}
module.exports=vector3FromLatLon},{}],24:[function(require,module,exports){'use strict';var TabManager=require('./helpers/TabManager');var hideSiblingElements=require('./helpers/hideSiblingElements');var showSiblingElements=require('./helpers/showSiblingElements');var CircularTab=function(element,options){options=options||{};this._tabbables=null;this._excludeHidden=options.excludeHidden;this._firstTabbableElement=options.firstFocusElement;this._lastTabbableElement=null;this._relatedTarget=null;this.el=element;this._handleOnFocus=this._handleOnFocus.bind(this)};var proto=CircularTab.prototype;proto.start=function(){this.updateTabbables();hideSiblingElements(this.el,null,this._excludeHidden);if(this._firstTabbableElement){if(!this.el.contains(document.activeElement)){this._firstTabbableElement.focus()}}else{console.warn('this._firstTabbableElement is null, CircularTab needs at least one tabbable element.')}
this._relatedTarget=document.activeElement;document.addEventListener('focus',this._handleOnFocus,!0)};proto.stop=function(){showSiblingElements(this.el);document.removeEventListener('focus',this._handleOnFocus,!0)};proto.updateTabbables=function(){this._tabbables=TabManager.getTabbableElements(this.el,this._excludeHidden);this._firstTabbableElement=this._firstTabbableElement||this._tabbables[0];this._lastTabbableElement=this._tabbables[this._tabbables.length-1]};proto._handleOnFocus=function(e){if(!this.el.contains(e.target)){e.preventDefault();this.updateTabbables();if(this._relatedTarget===this._lastTabbableElement||this._relatedTarget===null){this._firstTabbableElement.focus();this._relatedTarget=this._firstTabbableElement;return}
if(this._relatedTarget===this._firstTabbableElement&&this._lastTabbableElement){this._lastTabbableElement.focus();this._relatedTarget=this._lastTabbableElement;return}}else{this._relatedTarget=e.target}};proto.destroy=function(){this.stop();this.el=null;this._tabbables=null;this._firstTabbableElement=null;this._lastTabbableElement=null;this._relatedTarget=null;this._handleOnFocus=null};module.exports=CircularTab},{"./helpers/TabManager":25,"./helpers/hideSiblingElements":27,"./helpers/showSiblingElements":30}],25:[function(require,module,exports){'use strict';var focusableElements=require('./../maps/focusableElement');var TabManager=function(){this.focusableSelectors=focusableElements.selectors};var proto=TabManager.prototype;proto.isFocusableElement=function(element,excludeHidden,tabIndex){if(excludeHidden&&!this._isDisplayed(element)){return!1}
var focusableElement=focusableElements.nodeName[element.nodeName];if(focusableElement){return!element.disabled}
if(!element.contentEditable){return!0}
tabIndex=tabIndex||parseFloat(element.getAttribute('tabindex'));return!isNaN(tabIndex)};proto.isTabbableElement=function(element,excludeHidden){if(excludeHidden&&!this._isDisplayed(element)){return!1}
var tabIndex=element.getAttribute('tabindex');tabIndex=parseFloat(tabIndex);if(!isNaN(tabIndex)){return(tabIndex>=0)}else{return this.isFocusableElement(element,excludeHidden,tabIndex)}};proto._isDisplayed=function(el){var clientBounding=el.getBoundingClientRect();if(clientBounding.top===0&&clientBounding.left===0&&clientBounding.width===0&&clientBounding.height===0){return!1}
return window.getComputedStyle(el).visibility!=='hidden'};proto.getTabbableElements=function(parentElement,excludeHidden){var elements=parentElement.querySelectorAll(this.focusableSelectors);var l=elements.length;var tabbableElements=[];for(var i=0;i<l;i++){if(this.isTabbableElement(elements[i],excludeHidden)){tabbableElements.push(elements[i])}}
return tabbableElements};proto.getFocusableElements=function(parentElement,excludeHidden){var elements=parentElement.querySelectorAll(this.focusableSelectors);var l=elements.length;var focusableElements=[];for(var i=0;i<l;i++){if(this.isFocusableElement(elements[i],excludeHidden)){focusableElements.push(elements[i])}}
return focusableElements};module.exports=new TabManager()},{"./../maps/focusableElement":32}],26:[function(require,module,exports){'use strict';var aria=require('./../maps/ariaMap');var TabManager=require('./TabManager');var PREFIX='data-original-';var TAB_INDEX='tabindex';var setOriginalValue=function(el,prop){var originalValue=el.getAttribute(PREFIX+prop);if(!originalValue){originalValue=el.getAttribute(prop)||'';el.setAttribute(PREFIX+prop,originalValue)}};module.exports=function hide(el,excludeHidden){if(TabManager.isFocusableElement(el,excludeHidden)){setOriginalValue(el,TAB_INDEX);el.setAttribute(TAB_INDEX,'-1')}else{var tabbables=TabManager.getTabbableElements(el,excludeHidden);var i=tabbables.length;while(i--){setOriginalValue(tabbables[i],TAB_INDEX);tabbables[i].setAttribute(TAB_INDEX,'-1')}}
setOriginalValue(el,aria.HIDDEN);el.setAttribute(aria.HIDDEN,'true')}},{"./../maps/ariaMap":31,"./TabManager":25}],27:[function(require,module,exports){'use strict';var hide=require('./hide');module.exports=function hideSiblingElements(el,ancestor,excludeHidden){ancestor=ancestor||document.body;var previousNode=el;var nextNode=el;while((previousNode=previousNode.previousElementSibling)){hide(previousNode,excludeHidden)}
while((nextNode=nextNode.nextElementSibling)){hide(nextNode,excludeHidden)}
if(el.parentElement&&el.parentElement!==ancestor){hideSiblingElements(el.parentElement,ancestor,excludeHidden)}}},{"./hide":26}],28:[function(require,module,exports){'use strict';var removeAttributes=function(item,attributes){let items;if(item instanceof NodeList){items=item}else{items=[].concat(item)}
attributes=(Array.isArray(attributes))?attributes:[].concat(attributes);items.forEach((item)=>{attributes.forEach((attribute)=>{item.removeAttribute(attribute)})})};module.exports=removeAttributes},{}],29:[function(require,module,exports){'use strict';var removeAttributes=require('./removeAttributes');var aria=require('./../maps/ariaMap');var PREFIX='data-original-';var TAB_INDEX='tabindex';var restoreOrigValue=function(el,prop){var originalValue=el.getAttribute(PREFIX+prop);if(originalValue===null){return}
if(originalValue===''){removeAttributes(el,prop)}else{el.setAttribute(prop,originalValue)}
removeAttributes(el,PREFIX+prop)};module.exports=function show(el){restoreOrigValue(el,TAB_INDEX);restoreOrigValue(el,aria.HIDDEN);var tabbables=el.querySelectorAll(`[${PREFIX + TAB_INDEX}]`);var i=tabbables.length;while(i--){restoreOrigValue(tabbables[i],TAB_INDEX)}}},{"./../maps/ariaMap":31,"./removeAttributes":28}],30:[function(require,module,exports){'use strict';var show=require('./show');module.exports=function showSiblingElements(el,ancestor){ancestor=ancestor||document.body;var previousNode=el;var nextNode=el;while((previousNode=previousNode.previousElementSibling)){show(previousNode)}
while((nextNode=nextNode.nextElementSibling)){show(nextNode)}
if(el.parentElement&&el.parentElement!==ancestor){showSiblingElements(el.parentElement,ancestor)}}},{"./show":29}],31:[function(require,module,exports){'use strict';module.exports={'AUTOCOMPLETE':'aria-autocomplete','CHECKED':'aria-checked','DISABLED':'aria-disabled','EXPANDED':'aria-expanded','HASPOPUP':'aria-haspopup','HIDDEN':'aria-hidden','INVALID':'aria-invalid','LABEL':'aria-label','LEVEL':'aria-level','MULTILINE':'aria-multiline','MULTISELECTABLE':'aria-multiselectable','ORIENTATION':'aria-orientation','PRESSED':'aria-pressed','READONLY':'aria-readonly','REQUIRED':'aria-required','SELECTED':'aria-selected','SORT':'aria-sort','VALUEMAX':'aria-valuemax','VALUEMIN':'aria-valuemin','VALUENOW':'aria-valuenow','VALUETEXT':'aria-valuetext','ATOMIC':'aria-atomic','BUSY':'aria-busy','LIVE':'aria-live','RELEVANT':'aria-relevant','DROPEFFECT':'aria-dropeffect','GRABBED':'aria-grabbed','ACTIVEDESCENDANT':'aria-activedescendant','CONTROLS':'aria-controls','DESCRIBEDBY':'aria-describedby','FLOWTO':'aria-flowto','LABELLEDBY':'aria-labelledby','OWNS':'aria-owns','POSINSET':'aria-posinset','SETSIZE':'aria-setsize'}},{}],32:[function(require,module,exports){'use strict';let selectors=['input','select','textarea','button','optgroup','option','menuitem','fieldset','object','a[href]','[tabindex]','[contenteditable]'];module.exports={selectors:selectors.join(','),nodeName:{INPUT:'input',SELECT:'select',TEXTAREA:'textarea',BUTTON:'button',OPTGROUP:'optgroup',OPTION:'option',MENUITEM:'menuitem',FIELDSET:'fieldset',OBJECT:'object',A:'a',}}},{}],33:[function(require,module,exports){'use strict';var getTransport=require('./request/factory');var DEFAULT_SETTINGS={complete:function(xhr,status){},error:function(xhr,status){},method:'GET',headers:{},success:function(data,status,xhr){},timeout:5000};var extend=function(){for(var i=1;i<arguments.length;i++){for(var key in arguments[i]){if(arguments[i].hasOwnProperty(key)){arguments[0][key]=arguments[i][key]}}}
return arguments[0]};var ac_ajax_xhr={ajax:function(url,settings){settings=extend({},DEFAULT_SETTINGS,settings);if(url.substr(0,2)==='//'){url=window.location.protocol+url}
var transport=getTransport(url);transport.open(settings.method,url);transport.setTransportHeaders(settings.headers);transport.setReadyStateChangeHandlers(settings.complete,settings.error,settings.success);transport.setTimeout(settings.timeout,settings.error,settings.complete);transport.send(settings.data);return transport},get:function(url,settings){settings.method='GET';return ac_ajax_xhr.ajax(url,settings)},head:function(url,settings){settings.method='HEAD';return ac_ajax_xhr.ajax(url,settings)},post:function(url,settings){settings.method='POST';return ac_ajax_xhr.ajax(url,settings)}};module.exports=ac_ajax_xhr},{"./request/factory":34}],34:[function(require,module,exports){'use strict';var XMLRequest=require('./xmlhttprequest');var XDRequest=require('./xdomainrequest');var PROTOCOL_PATTERN=/.*(?=:\/\/)/;var HOST_NAME_PATTERN=/^.*:\/\/|\/.+$/g;var IS_OLD_IE=window.XDomainRequest&&document.documentMode<10;var isCrossDomain=function(url){if(!url.match(PROTOCOL_PATTERN)){return!1}
var urlHostName=url.replace(HOST_NAME_PATTERN,'');return urlHostName!==window.location.hostname};module.exports=function(url,data){var Transport=IS_OLD_IE&&isCrossDomain(url)?XDRequest:XMLRequest;return new Transport()}},{"./xdomainrequest":36,"./xmlhttprequest":37}],35:[function(require,module,exports){'use strict';var Request=function(){};Request.create=function(){var F=function(){};F.prototype=Request.prototype;return new F()};Request.prototype.open=function(method,url){method=method.toUpperCase();this.xhr.open(method,url)};Request.prototype.send=function(data){this.xhr.send(data)};Request.prototype.setTimeout=function(duration,error,complete){this.xhr.ontimeout=function(){error(this.xhr,this.status);complete(this.xhr,this.status)}.bind(this)};Request.prototype.setTransportHeaders=function(headers){for(var header in headers){this.xhr.setRequestHeader(header,headers[header])}};module.exports=Request},{}],36:[function(require,module,exports){'use strict';var Request=require('./request');var toQueryParameters=require('@marcom/ac-object/toQueryParameters');var XDRequest=function(){this.xhr=new XDomainRequest()};XDRequest.prototype=Request.create();XDRequest.prototype.setReadyStateChangeHandlers=function(complete,error,success){this.xhr.onerror=function(){error(this.xhr,this.status);complete(this.xhr,this.status)}.bind(this);this.xhr.onload=function(){success(this.xhr.responseText,this.xhr.status,this.xhr);complete(this.xhr,this.status)}.bind(this)};XDRequest.prototype.send=function(data){if(data&&typeof data==='object'){data=toQueryParameters(data)}
this.xhr.send(data)};XDRequest.prototype.setTransportHeaders=function(headers){};module.exports=XDRequest},{"./request":35,"@marcom/ac-object/toQueryParameters":131}],37:[function(require,module,exports){'use strict';var Request=require('./request');var XMLRequest=function(){this.xhr=new XMLHttpRequest()};XMLRequest.prototype=Request.create();XMLRequest.prototype.setReadyStateChangeHandlers=function(complete,error,success){this.xhr.onreadystatechange=function(e){if(this.xhr.readyState===4){clearTimeout(this.timeout);if(this.xhr.status>=200&&this.xhr.status<300){success(this.xhr.responseText,this.xhr.status,this.xhr);complete(this.xhr,this.status)}else{error(this.xhr,this.status);complete(this.xhr,this.status)}}}.bind(this)};module.exports=XMLRequest},{"./request":35}],38:[function(require,module,exports){'use strict';module.exports={log:require('./ac-console/log')}},{"./ac-console/log":39}],39:[function(require,module,exports){'use strict';var debugMessagingKey='f7c9180f-5c45-47b4-8de4-428015f096c0';var allowDebugMessaging=!!(function(){try{return window.localStorage.getItem(debugMessagingKey)}catch(err){}}());module.exports=function log(){if(window.console&&typeof console.log!=='undefined'&&allowDebugMessaging){console.log.apply(console,Array.prototype.slice.call(arguments,0))}}},{}],40:[function(require,module,exports){'use strict';var ac_Analytics;var extend=require('@marcom/ac-object/extend');var create=require('@marcom/ac-object/create');var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var ac_querySelectorAll=require('@marcom/ac-dom-traversal/querySelectorAll');var ac_addEventListener=require('@marcom/ac-dom-events/addEventListener');var ac_removeEventListener=require('@marcom/ac-dom-events/removeEventListener');var ac_console=require('@marcom/ac-console');try{ac_Analytics=require('@marcom/ac-analytics')}catch(e){ac_console.log(e.message)}
var defaultOptions={dataAttribute:'analytics-share',interactionEvents:['click'],autoEnable:!0};var AnalyticsShare=function(options){options=options||{};this.options=extend(defaultOptions,options);EventEmitterMicro.call(this);this.elements=[];this.eventObserver=null;this.publishShareClick=this.publishShareClick.bind(this);if(this.options.autoEnable){this.enable()}};var Super=EventEmitterMicro.prototype;var proto=AnalyticsShare.prototype=create(Super);proto.enable=function(){if(!ac_Analytics){return!1}
this._createObserver();this.bindEventListener()};proto.disable=function(){if(!ac_Analytics){return!1}
this.unbindEventListener()};proto.bindEventListener=function(){var length=0;this.elements=this.populateElements();length=this.elements.length;for(var i=0;i<length;i++){ac_addEventListener(this.elements[i],'click',this.publishShareClick)}};proto.unbindEventListener=function(){var length=(this.elements&&this.elements.length?this.elements.length:0);for(var i=0;i<length;i++){ac_removeEventListener(this.elements[i],'click',this.publishShareClick)}};proto.populateElements=function(){return ac_querySelectorAll('[data-'+this.options.dataAttribute+']',(this.options.context||document))};proto.publishShareClick=function(e){var targetEl=e.currentTarget;var data=this.parseDataAttribute(targetEl.getAttribute('data-'+this.options.dataAttribute));if(typeof data==='object'){if(!data.title){console.log('data-'+this.options.dataAttribute+' attribute must have a `title` property');return!1}
this.trigger('click',data)}};proto.parseDataAttribute=function(dataAttrStr){var data={};try{data=JSON.parse(dataAttrStr)}catch(e){console.log('data-'+this.options.dataAttribute+' must be a valid JSON string')}
return data};proto.destroy=function(){this.disable();this.elements=[];this.eventObserver=null;this.publishShareClick=null;this.options=null};proto._createObserver=function(){if(!ac_Analytics||!ac_Analytics.observer||!ac_Analytics.observer.Event){return!1}
this.eventObserver=new ac_Analytics.observer.Event(this,this.options)};module.exports=AnalyticsShare},{"@marcom/ac-analytics":"@marcom/ac-analytics","@marcom/ac-console":38,"@marcom/ac-dom-events/addEventListener":55,"@marcom/ac-dom-events/removeEventListener":59,"@marcom/ac-dom-traversal/querySelectorAll":83,"@marcom/ac-event-emitter-micro":89,"@marcom/ac-object/create":124,"@marcom/ac-object/extend":126}],41:[function(require,module,exports){'use strict';var AnalyticsShare=require('./../AnalyticsShare');module.exports=function(options){return new AnalyticsShare(options)}},{"./../AnalyticsShare":40}],42:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/Array/prototype.slice');require('@marcom/ac-polyfills/Element/prototype.classList');var classNameAdd=require('./className/add');module.exports=function add(){var tokens=Array.prototype.slice.call(arguments);var el=tokens.shift(tokens);var i;if(el.classList&&el.classList.add){el.classList.add.apply(el.classList,tokens);return}
for(i=0;i<tokens.length;i++){classNameAdd(el,tokens[i])}}},{"./className/add":43,"@marcom/ac-polyfills/Array/prototype.slice":136,"@marcom/ac-polyfills/Element/prototype.classList":139}],43:[function(require,module,exports){'use strict';var classNameContains=require('./contains');module.exports=function add(el,token){if(!classNameContains(el,token)){el.className+=' '+token}}},{"./contains":44}],44:[function(require,module,exports){'use strict';var getTokenRegExp=require('./getTokenRegExp');module.exports=function classNameAdd(el,token){return getTokenRegExp(token).test(el.className)}},{"./getTokenRegExp":45}],45:[function(require,module,exports){'use strict';module.exports=function getTokenRegExp(token){return new RegExp('(\\s|^)'+token+'(\\s|$)')}},{}],46:[function(require,module,exports){'use strict';var classNameContains=require('./contains');var getTokenRegExp=require('./getTokenRegExp');module.exports=function remove(el,token){if(classNameContains(el,token)){el.className=el.className.replace(getTokenRegExp(token),'$1').trim()}}},{"./contains":44,"./getTokenRegExp":45}],47:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/Array/prototype.slice');require('@marcom/ac-polyfills/Element/prototype.classList');var classNameRemove=require('./className/remove');module.exports=function remove(){var tokens=Array.prototype.slice.call(arguments);var el=tokens.shift(tokens);var i;if(el.classList&&el.classList.remove){el.classList.remove.apply(el.classList,tokens);return}
for(i=0;i<tokens.length;i++){classNameRemove(el,tokens[i])}}},{"./className/remove":46,"@marcom/ac-polyfills/Array/prototype.slice":136,"@marcom/ac-polyfills/Element/prototype.classList":139}],48:[function(require,module,exports){'use strict';module.exports=function select(el){if(typeof el.select==='function'){var success=!1;success=el.select();if(!success){el.setSelectionRange(0,el.value.length)}}else{var range=document.createRange();range.selectNodeContents(el);var sel=window.getSelection();sel.removeAllRanges();sel.addRange(range)}}},{}],49:[function(require,module,exports){'use strict';var DEBUG_MESSAGING_KEY='f7c9180f-5c45-47b4-8de4-428015f096c0';var enabled=!1;var _window=window||self;try{enabled=!!_window.localStorage.getItem(DEBUG_MESSAGING_KEY)}catch(err){}
module.exports=enabled},{}],50:[function(require,module,exports){'use strict';var enabled=require('../enabled');module.exports=function expose(funcName){return function(){if(enabled&&typeof(window.console)==='object'&&typeof(console[funcName])==='function'){return console[funcName].apply(console,Array.prototype.slice.call(arguments,0))}}}},{"../enabled":49}],51:[function(require,module,exports){'use strict';module.exports=require('./internal/expose')('log')},{"./internal/expose":50}],52:[function(require,module,exports){'use strict';module.exports={DOMEmitter:require('./ac-dom-emitter/DOMEmitter')}},{"./ac-dom-emitter/DOMEmitter":53}],53:[function(require,module,exports){'use strict';var proto;var EventEmitter=require('ac-event-emitter').EventEmitter,DOMEmitterEvent=require('./DOMEmitterEvent'),ac_dom_events={addEventListener:require('@marcom/ac-dom-events/addEventListener'),removeEventListener:require('@marcom/ac-dom-events/removeEventListener'),dispatchEvent:require('@marcom/ac-dom-events/dispatchEvent')},ac_dom_traversal={querySelectorAll:require('@marcom/ac-dom-traversal/querySelectorAll'),matchesSelector:require('@marcom/ac-dom-traversal/matchesSelector')};var internalEventPrefix='dom-emitter';function DOMEmitter(el){if(el===null){return}
this.el=el;this._bindings={};this._delegateFuncs={};this._eventEmitter=new EventEmitter()}
proto=DOMEmitter.prototype;proto.on=function(){this._normalizeArgumentsAndCall(Array.prototype.slice.call(arguments,0),this._on);return this};proto.once=function(){this._normalizeArgumentsAndCall(Array.prototype.slice.call(arguments,0),this._once);return this};proto.off=function(){this._normalizeArgumentsAndCall(Array.prototype.slice.call(arguments,0),this._off);return this};proto.has=function(evt,callbackOrDelegateQuery,callbackOrContext,context){var delegateQuery,callback;if(typeof callbackOrDelegateQuery==='string'){delegateQuery=callbackOrDelegateQuery;callback=callbackOrContext}else{callback=callbackOrDelegateQuery;context=callbackOrContext}
if(delegateQuery){var matchIdx=this._getDelegateFuncBindingIdx(evt,delegateQuery,callback,context,!0);if(matchIdx>-1){return!0}
return!1}
if(this._eventEmitter&&this._eventEmitter.has.apply(this._eventEmitter,arguments)){return!0}
return!1};proto.trigger=function(evts,dataOrDelegateQuery,doNotPropogateOrData,doNotPropogate){evts=this._parseEventNames(evts);evts=this._cleanStringData(evts);var delegateQuery,data,i,len=evts.length;if(typeof dataOrDelegateQuery==='string'){delegateQuery=this._cleanStringData(dataOrDelegateQuery);data=doNotPropogateOrData}else{data=dataOrDelegateQuery;doNotPropogate=doNotPropogateOrData}
for(i=0;i<len;i++){this._triggerDOMEvents(evts[i],data,delegateQuery)}
return this};proto.emitterTrigger=function(evts,data,doNotPropogate){if(!this._eventEmitter){return this}
evts=this._parseEventNames(evts);evts=this._cleanStringData(evts);data=new DOMEmitterEvent(data,this);var i,len=evts.length;for(i=0;i<len;i++){this._eventEmitter.trigger(evts[i],data,doNotPropogate)}
return this};proto.propagateTo=function(eventEmitter,prefix){this._eventEmitter.propagateTo(eventEmitter,prefix);return this};proto.stopPropagatingTo=function(eventEmitter){this._eventEmitter.stopPropagatingTo(eventEmitter);return this};proto.stopImmediatePropagation=function(){this._eventEmitter.stopImmediatePropagation();return this};proto.destroy=function(){this._triggerInternalEvent('willdestroy');this.off();var i;for(i in this){if(this.hasOwnProperty(i)){this[i]=null}}};proto._parseEventNames=function(evt){if(!evt){return[evt]}
return evt.split(' ')};proto._onListenerEvent=function(evtName,e){var data=new DOMEmitterEvent(e,this);this._eventEmitter.trigger(evtName,data,!1)};proto._setListener=function(evt){this._bindings[evt]=this._onListenerEvent.bind(this,evt);ac_dom_events.addEventListener(this.el,evt,this._bindings[evt])};proto._removeListener=function(evt){ac_dom_events.removeEventListener(this.el,evt,this._bindings[evt]);this._bindings[evt]=null};proto._triggerInternalEvent=function(evt,data){this.emitterTrigger(internalEventPrefix+':'+evt,data)};proto._normalizeArgumentsAndCall=function(argsArr,func){var binding={};if(argsArr.length===0){func.call(this,binding);return}
if(typeof argsArr[0]==='string'||argsArr[0]===null){argsArr=this._cleanStringData(argsArr);binding.events=argsArr[0];if(typeof argsArr[1]==='string'){binding.delegateQuery=argsArr[1];binding.callback=argsArr[2];binding.context=argsArr[3]}else{binding.callback=argsArr[1];binding.context=argsArr[2]}
func.call(this,binding);return}
var i,splits,splitChar=':',obj=argsArr[0];for(i in obj){if(obj.hasOwnProperty(i)){binding={};splits=this._cleanStringData(i.split(splitChar));binding.events=splits[0];binding.delegateQuery=splits[1];binding.callback=obj[i];binding.context=argsArr[1];func.call(this,binding)}}};proto._registerDelegateFunc=function(evt,delegateQuery,callback,unboundCallback,context){var delegateFunc=this._delegateFunc.bind(this,evt,delegateQuery,callback,context);this._delegateFuncs[delegateQuery]=this._delegateFuncs[delegateQuery]||{};this._delegateFuncs[delegateQuery][evt]=this._delegateFuncs[delegateQuery][evt]||[];this._delegateFuncs[delegateQuery][evt].push({func:unboundCallback,context:context,delegateFunc:delegateFunc});return delegateFunc};proto._cleanStringData=function(arr){var isString=!1;if(typeof arr==='string'){arr=[arr];isString=!0}
var result=[],i,val,valLen,spaceIdx,len=arr.length;for(i=0;i<len;i++){val=arr[i];if(typeof val==='string'){if(val===''||val===' '){continue}
valLen=val.length;while(val[0]===' '){val=val.slice(1,valLen);valLen--}
while(val[valLen-1]===' '){val=val.slice(0,valLen-1);valLen--}}
result.push(val)}
if(isString){return result[0]}
return result};proto._unregisterDelegateFunc=function(evt,delegateQuery,unboundCallback,context){if(!this._delegateFuncs[delegateQuery]||!this._delegateFuncs[delegateQuery][evt]){return}
var matchIdx=this._getDelegateFuncBindingIdx(evt,delegateQuery,unboundCallback,context),delegateFunc;if(matchIdx>-1){delegateFunc=this._delegateFuncs[delegateQuery][evt][matchIdx].delegateFunc;this._delegateFuncs[delegateQuery][evt].splice(matchIdx,1);if(this._delegateFuncs[delegateQuery][evt].length===0){this._delegateFuncs[delegateQuery][evt]=null}}
return delegateFunc};proto._unregisterDelegateFuncs=function(evt,delegateQuery){if(!this._delegateFuncs[delegateQuery]){return}
if(evt!==null&&!this._delegateFuncs[delegateQuery][evt]){return}
if(evt===null){var i;for(i in this._delegateFuncs[delegateQuery]){if(this._delegateFuncs[delegateQuery].hasOwnProperty(i)){this._unbindDelegateFunc(i,delegateQuery)}}
return}
this._unbindDelegateFunc(evt,delegateQuery)};proto._unbindDelegateFunc=function(evt,delegateQuery){var binding,preRemoveLen,i=0;while(this._delegateFuncs[delegateQuery][evt]&&this._delegateFuncs[delegateQuery][evt][i]){binding=this._delegateFuncs[delegateQuery][evt][i];preRemoveLen=this._delegateFuncs[delegateQuery][evt][i].length;this._off({events:evt,delegateQuery:delegateQuery,callback:binding.func,context:binding.context});if(this._delegateFuncs[delegateQuery][evt]&&preRemoveLen===this._delegateFuncs[delegateQuery][evt].length){i++}}
binding=preRemoveLen=null};proto._unregisterDelegateFuncsByEvent=function(evt){var i;for(i in this._delegateFuncs){if(this._delegateFuncs.hasOwnProperty(i)){this._unregisterDelegateFuncs(evt,i)}}};proto._delegateFunc=function(evt,delegateQuery,callback,context,e){if(this._targetHasDelegateAncestor(e.target,delegateQuery)){var args=Array.prototype.slice.call(arguments,0),unboundArgs=args.slice(4,args.length);context=context||window;if(typeof e.detail==='object'){unboundArgs[0]=e.detail}
callback.apply(context,unboundArgs)}};proto._targetHasDelegateAncestor=function(target,delegateQuery){var ancestor=target;while(ancestor&&ancestor!==this.el&&ancestor!==document.documentElement){if(ac_dom_traversal.matchesSelector(ancestor,delegateQuery)){return!0}
ancestor=ancestor.parentNode}
return!1};proto._on=function(binding){var evts=binding.events,callback=binding.callback,delegateQuery=binding.delegateQuery,context=binding.context,unboundCallback=binding.unboundCallback||callback;evts=this._parseEventNames(evts);evts.forEach(function(callback,unboundCallback,context,delegateQuery,evt){if(!this.has(evt)){this._setListener(evt)}
if(typeof delegateQuery==='string'){callback=this._registerDelegateFunc(evt,delegateQuery,callback,unboundCallback,context)}
this._triggerInternalEvent('willon',{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});this._eventEmitter.on(evt,callback,context);this._triggerInternalEvent('didon',{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery})}.bind(this,callback,unboundCallback,context,delegateQuery));evts=callback=unboundCallback=delegateQuery=context=null};proto._off=function(binding){var evts=binding.events,callback=binding.callback,delegateQuery=binding.delegateQuery,context=binding.context,unboundCallback=binding.unboundCallback||callback;if(typeof evts==='undefined'){this._eventEmitter.off();var i;for(i in this._bindings){if(this._bindings.hasOwnProperty(i)){this._removeListener(i)}}
for(i in this._delegateFuncs){if(this._delegateFuncs.hasOwnProperty(i)){this._delegateFuncs[i]=null}}
return}
evts=this._parseEventNames(evts);evts.forEach(function(callback,unboundCallback,context,delegateQuery,evt){if(typeof delegateQuery==='string'&&typeof unboundCallback==='function'){callback=this._unregisterDelegateFunc(evt,delegateQuery,unboundCallback,context);if(!callback){return}}
if(typeof delegateQuery==='string'&&typeof callback==='undefined'){this._unregisterDelegateFuncs(evt,delegateQuery);return}
if(typeof evt==='string'&&typeof callback==='undefined'){this._unregisterDelegateFuncsByEvent(evt);if(typeof delegateQuery==='string'){return}}
this._triggerInternalEvent('willoff',{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});this._eventEmitter.off(evt,callback,context);this._triggerInternalEvent('didoff',{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});if(!this.has(evt)){this._removeListener(evt)}}.bind(this,callback,unboundCallback,context,delegateQuery));evts=callback=unboundCallback=delegateQuery=context=null};proto._once=function(binding){var evts=binding.events,callback=binding.callback,delegateQuery=binding.delegateQuery,context=binding.context;evts=this._parseEventNames(evts);evts.forEach(function(callback,context,delegateQuery,evt){if(typeof delegateQuery==='string'){return this._handleDelegateOnce(evt,callback,context,delegateQuery)}
if(!this.has(evt)){this._setListener(evt)}
this._triggerInternalEvent('willonce',{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});this._eventEmitter.once.call(this,evt,callback,context);this._triggerInternalEvent('didonce',{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery})}.bind(this,callback,context,delegateQuery));evts=callback=delegateQuery=context=null};proto._handleDelegateOnce=function(evt,callback,context,delegateQuery){this._triggerInternalEvent('willonce',{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});this._on({events:evt,context:context,delegateQuery:delegateQuery,callback:this._getDelegateOnceCallback.bind(this,evt,callback,context,delegateQuery),unboundCallback:callback});this._triggerInternalEvent('didonce',{evt:evt,callback:callback,context:context,delegateQuery:delegateQuery});return this};proto._getDelegateOnceCallback=function(evt,callback,context,delegateQuery){var args=Array.prototype.slice.call(arguments,0),passedArgs=args.slice(4,args.length);callback.apply(context,passedArgs);this._off({events:evt,delegateQuery:delegateQuery,callback:callback,context:context})};proto._getDelegateFuncBindingIdx=function(evt,delegateQuery,unboundCallback,context,ignoreFuncMatch){var idx=-1;if(this._delegateFuncs[delegateQuery]&&this._delegateFuncs[delegateQuery][evt]){var i,bindingObj,len=this._delegateFuncs[delegateQuery][evt].length;for(i=0;i<len;i++){bindingObj=this._delegateFuncs[delegateQuery][evt][i];if(ignoreFuncMatch&&typeof unboundCallback==='undefined'){unboundCallback=bindingObj.func}
if(bindingObj.func===unboundCallback&&bindingObj.context===context){idx=i;break}}}
return idx};proto._triggerDOMEvents=function(evt,data,delegateQuery){var targets=[this.el];if(delegateQuery){targets=ac_dom_traversal.querySelectorAll(delegateQuery,this.el)}
var i,target,len=targets.length;for(i=0;i<len;i++){ac_dom_events.dispatchEvent(targets[i],evt,{bubbles:!0,cancelable:!0,detail:data})}};module.exports=DOMEmitter},{"./DOMEmitterEvent":54,"@marcom/ac-dom-events/addEventListener":55,"@marcom/ac-dom-events/dispatchEvent":56,"@marcom/ac-dom-events/removeEventListener":59,"@marcom/ac-dom-traversal/matchesSelector":82,"@marcom/ac-dom-traversal/querySelectorAll":83,"ac-event-emitter":309}],54:[function(require,module,exports){'use strict';var ac_dom_events={preventDefault:require('@marcom/ac-dom-events/preventDefault'),stopPropagation:require('@marcom/ac-dom-events/stopPropagation'),target:require('@marcom/ac-dom-events/target')}
var proto;var DOMEmitterEvent=function(eventData,domEmitter){this._domEmitter=domEmitter;this.originalEvent=eventData||{};this._originalTarget=ac_dom_events.target(this.originalEvent);this.target=this._originalTarget||this._domEmitter.el;this.currentTarget=this._domEmitter.el;this.timeStamp=this.originalEvent.timeStamp||Date.now();if(this._isDOMEvent(this.originalEvent)){if(typeof this.originalEvent.detail==='object'){this.data=this.originalEvent.detail}}else if(eventData){this.data=this.originalEvent;this.originalEvent={}}};proto=DOMEmitterEvent.prototype;proto.preventDefault=function(){ac_dom_events.preventDefault(this.originalEvent)};proto.stopPropagation=function(){ac_dom_events.stopPropagation(this.originalEvent)};proto.stopImmediatePropagation=function(){if(this.originalEvent.stopImmediatePropagation){this.originalEvent.stopImmediatePropagation()}
this._domEmitter.stopImmediatePropagation()};proto._isDOMEvent=function(e){if(this._originalTarget||(document.createEvent!=='undefined'&&typeof CustomEvent!=='undefined'&&e instanceof CustomEvent)){return!0}
return!1};module.exports=DOMEmitterEvent},{"@marcom/ac-dom-events/preventDefault":58,"@marcom/ac-dom-events/stopPropagation":62,"@marcom/ac-dom-events/target":63}],55:[function(require,module,exports){'use strict';var addEventListenerUtil=require('./utils/addEventListener');var getEventType=require('./shared/getEventType');module.exports=function addEventListener(target,type,listener,useCapture){type=getEventType(target,type);return addEventListenerUtil(target,type,listener,useCapture)}},{"./shared/getEventType":60,"./utils/addEventListener":64}],56:[function(require,module,exports){'use strict';var dispatchEventUtil=require('./utils/dispatchEvent');var getEventType=require('./shared/getEventType');module.exports=function dispatchEvent(target,type,options){type=getEventType(target,type);return dispatchEventUtil(target,type,options)}},{"./shared/getEventType":60,"./utils/dispatchEvent":65}],57:[function(require,module,exports){'use strict';module.exports={addEventListener:require('./addEventListener'),dispatchEvent:require('./dispatchEvent'),preventDefault:require('./preventDefault'),removeEventListener:require('./removeEventListener'),stop:require('./stop'),stopPropagation:require('./stopPropagation'),target:require('./target')}},{"./addEventListener":55,"./dispatchEvent":56,"./preventDefault":58,"./removeEventListener":59,"./stop":61,"./stopPropagation":62,"./target":63}],58:[function(require,module,exports){'use strict';module.exports=function preventDefault(evt){evt=evt||window.event;if(evt.preventDefault){evt.preventDefault()}else{evt.returnValue=!1}}},{}],59:[function(require,module,exports){'use strict';var removeEventListenerUtil=require('./utils/removeEventListener');var getEventType=require('./shared/getEventType');module.exports=function removeEventListener(target,type,listener,useCapture){type=getEventType(target,type);return removeEventListenerUtil(target,type,listener,useCapture)}},{"./shared/getEventType":60,"./utils/removeEventListener":66}],60:[function(require,module,exports){'use strict';var getPrefixedEventType=require('@marcom/ac-prefixer/getEventType');module.exports=function getEventType(target,type){var tagName;var prefixed;if('tagName' in target){tagName=target.tagName}else if(target===window){tagName='window'}else{tagName='document'}
prefixed=getPrefixedEventType(type,tagName);if(prefixed){return prefixed}
return type}},{"@marcom/ac-prefixer/getEventType":141}],61:[function(require,module,exports){'use strict';var stopPropagation=require('./stopPropagation');var preventDefault=require('./preventDefault');module.exports=function stop(evt){evt=evt||window.event;stopPropagation(evt);preventDefault(evt);evt.stopped=!0;evt.returnValue=!1}},{"./preventDefault":58,"./stopPropagation":62}],62:[function(require,module,exports){'use strict';module.exports=function stopPropagation(evt){evt=evt||window.event;if(evt.stopPropagation){evt.stopPropagation()}else{evt.cancelBubble=!0}}},{}],63:[function(require,module,exports){'use strict';module.exports=function target(evt){evt=evt||window.event;return(typeof evt.target!=='undefined')?evt.target:evt.srcElement}},{}],64:[function(require,module,exports){'use strict';module.exports=function addEventListener(target,type,listener,useCapture){if(target.addEventListener){target.addEventListener(type,listener,!!useCapture)}else{target.attachEvent('on'+type,listener)}
return target}},{}],65:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/CustomEvent');module.exports=function dispatchEvent(target,type,options){var evt;if(target.dispatchEvent){if(options){evt=new CustomEvent(type,options)}else{evt=new CustomEvent(type)}
target.dispatchEvent(evt)}else{evt=document.createEventObject();if(options&&'detail' in options){evt.detail=options.detail}
target.fireEvent('on'+type,evt)}
return target}},{"@marcom/ac-polyfills/CustomEvent":137}],66:[function(require,module,exports){'use strict';module.exports=function removeEventListener(target,type,listener,useCapture){if(target.removeEventListener){target.removeEventListener(type,listener,!!useCapture)}else{target.detachEvent('on'+type,listener)}
return target}},{}],67:[function(require,module,exports){'use strict';module.exports=function getScrollX(el){var offset;el=el||window;if(el===window){offset=window.pageXOffset;if(!offset){el=document.documentElement||document.body.parentNode||document.body}else{return offset}}
return el.scrollLeft}},{}],68:[function(require,module,exports){'use strict';module.exports=function getScrollY(el){var offset;el=el||window;if(el===window){offset=window.pageYOffset;if(!offset){el=document.documentElement||document.body.parentNode||document.body}else{return offset}}
return el.scrollTop}},{}],69:[function(require,module,exports){'use strict';module.exports=8},{}],70:[function(require,module,exports){'use strict';module.exports=11},{}],71:[function(require,module,exports){'use strict';module.exports=9},{}],72:[function(require,module,exports){'use strict';module.exports=1},{}],73:[function(require,module,exports){'use strict';module.exports=3},{}],74:[function(require,module,exports){'use strict';var isNode=require('../isNode');module.exports=function isNodeType(node,nodeType){if(!isNode(node)){return!1}
if(typeof nodeType==='number'){return(node.nodeType===nodeType)}
return(nodeType.indexOf(node.nodeType)!==-1)}},{"../isNode":78}],75:[function(require,module,exports){'use strict';var isNodeType=require('./isNodeType');var COMMENT_NODE=require('../COMMENT_NODE');var DOCUMENT_FRAGMENT_NODE=require('../DOCUMENT_FRAGMENT_NODE');var ELEMENT_NODE=require('../ELEMENT_NODE');var TEXT_NODE=require('../TEXT_NODE');var VALID_INSERT_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_INSERT_NODE=' must be an Element, TextNode, Comment, or Document Fragment';var VALID_CHILD_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE];var ERR_INVALID_CHILD_NODE=' must be an Element, TextNode, or Comment';var VALID_PARENT_NODE=[ELEMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_PARENT_NODE=' must be an Element, or Document Fragment';var ERR_NO_PARENT_NODE=' must have a parentNode';module.exports={parentNode:function(node,required,funcName,paramName){paramName=paramName||'target';if((node||required)&&!isNodeType(node,VALID_PARENT_NODE)){throw new TypeError(funcName+': '+paramName+ERR_INVALID_PARENT_NODE)}},childNode:function(node,required,funcName,paramName){paramName=paramName||'target';if(!node&&!required){return}
if(!isNodeType(node,VALID_CHILD_NODE)){throw new TypeError(funcName+': '+paramName+ERR_INVALID_CHILD_NODE)}},insertNode:function(node,required,funcName,paramName){paramName=paramName||'node';if(!node&&!required){return}
if(!isNodeType(node,VALID_INSERT_NODE)){throw new TypeError(funcName+': '+paramName+ERR_INVALID_INSERT_NODE)}},hasParentNode:function(node,funcName,paramName){paramName=paramName||'target';if(!node.parentNode){throw new TypeError(funcName+': '+paramName+ERR_NO_PARENT_NODE)}}}},{"../COMMENT_NODE":69,"../DOCUMENT_FRAGMENT_NODE":70,"../ELEMENT_NODE":72,"../TEXT_NODE":73,"./isNodeType":74}],76:[function(require,module,exports){'use strict';var isNodeType=require('./internal/isNodeType');var DOCUMENT_FRAGMENT_NODE=require('./DOCUMENT_FRAGMENT_NODE');module.exports=function isDocumentFragment(obj){return isNodeType(obj,DOCUMENT_FRAGMENT_NODE)}},{"./DOCUMENT_FRAGMENT_NODE":70,"./internal/isNodeType":74}],77:[function(require,module,exports){'use strict';var isNodeType=require('./internal/isNodeType');var ELEMENT_NODE=require('./ELEMENT_NODE');module.exports=function isElement(obj){return isNodeType(obj,ELEMENT_NODE)}},{"./ELEMENT_NODE":72,"./internal/isNodeType":74}],78:[function(require,module,exports){'use strict';module.exports=function isNode(obj){return!!(obj&&obj.nodeType)}},{}],79:[function(require,module,exports){'use strict';var validate=require('./internal/validate');module.exports=function remove(node){validate.childNode(node,!0,'remove');if(!node.parentNode){return node}
return node.parentNode.removeChild(node)}},{"./internal/validate":75}],80:[function(require,module,exports){'use strict';module.exports=window.Element?(function(proto){return proto.matches||proto.matchesSelector||proto.webkitMatchesSelector||proto.mozMatchesSelector||proto.msMatchesSelector||proto.oMatchesSelector}(Element.prototype)):null},{}],81:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/Array/prototype.indexOf');var isNode=require('@marcom/ac-dom-nodes/isNode');var COMMENT_NODE=require('@marcom/ac-dom-nodes/COMMENT_NODE');var DOCUMENT_FRAGMENT_NODE=require('@marcom/ac-dom-nodes/DOCUMENT_FRAGMENT_NODE');var DOCUMENT_NODE=require('@marcom/ac-dom-nodes/DOCUMENT_NODE');var ELEMENT_NODE=require('@marcom/ac-dom-nodes/ELEMENT_NODE');var TEXT_NODE=require('@marcom/ac-dom-nodes/TEXT_NODE');var isNodeType=function(node,nodeType){if(!isNode(node)){return!1}
if(typeof nodeType==='number'){return(node.nodeType===nodeType)}
return(nodeType.indexOf(node.nodeType)!==-1)};var VALID_PARENT_NODE=[ELEMENT_NODE,DOCUMENT_NODE,DOCUMENT_FRAGMENT_NODE];var ERR_INVALID_PARENT_NODE=' must be an Element, Document, or Document Fragment';var VALID_CHILD_NODE=[ELEMENT_NODE,TEXT_NODE,COMMENT_NODE];var ERR_INVALID_CHILD_NODE=' must be an Element, TextNode, or Comment';var ERR_INVALID_SELECTOR=' must be a string';module.exports={parentNode:function(node,required,funcName,paramName){paramName=paramName||'node';if((node||required)&&!isNodeType(node,VALID_PARENT_NODE)){throw new TypeError(funcName+': '+paramName+ERR_INVALID_PARENT_NODE)}},childNode:function(node,required,funcName,paramName){paramName=paramName||'node';if(!node&&!required){return}
if(!isNodeType(node,VALID_CHILD_NODE)){throw new TypeError(funcName+': '+paramName+ERR_INVALID_CHILD_NODE)}},selector:function(selector,required,funcName,paramName){paramName=paramName||'selector';if((selector||required)&&typeof selector!=='string'){throw new TypeError(funcName+': '+paramName+ERR_INVALID_SELECTOR)}}}},{"@marcom/ac-dom-nodes/COMMENT_NODE":69,"@marcom/ac-dom-nodes/DOCUMENT_FRAGMENT_NODE":70,"@marcom/ac-dom-nodes/DOCUMENT_NODE":71,"@marcom/ac-dom-nodes/ELEMENT_NODE":72,"@marcom/ac-dom-nodes/TEXT_NODE":73,"@marcom/ac-dom-nodes/isNode":78,"@marcom/ac-polyfills/Array/prototype.indexOf":135}],82:[function(require,module,exports){'use strict';var isElement=require('@marcom/ac-dom-nodes/isElement');var validate=require('./internal/validate');var nativeMatches=require('./internal/nativeMatches');var matchesSelectorShim=require('./shims/matchesSelector');module.exports=function matchesSelector(node,selector){validate.selector(selector,!0,'matchesSelector');if(!isElement(node)){return!1}
if(!nativeMatches){return matchesSelectorShim(node,selector)}
return nativeMatches.call(node,selector)}},{"./internal/nativeMatches":80,"./internal/validate":81,"./shims/matchesSelector":84,"@marcom/ac-dom-nodes/isElement":77}],83:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/Array/prototype.slice');var validate=require('./internal/validate');var querySelectorAllShim=require('./shims/querySelectorAll');var querySelectorAllAvailable=('querySelectorAll' in document);module.exports=function querySelectorAll(selector,context){context=context||document;validate.parentNode(context,!0,'querySelectorAll','context');validate.selector(selector,!0,'querySelectorAll');if(!querySelectorAllAvailable){return querySelectorAllShim(selector,context)}
return Array.prototype.slice.call(context.querySelectorAll(selector))}},{"./internal/validate":81,"./shims/querySelectorAll":85,"@marcom/ac-polyfills/Array/prototype.slice":136}],84:[function(require,module,exports){'use strict';var querySelectorAll=require('../querySelectorAll');module.exports=function matchesSelector(node,selector){var context=node.parentNode||document;var nodes=querySelectorAll(selector,context);var i;for(i=0;i<nodes.length;i++){if(nodes[i]===node){return!0}}
return!1}},{"../querySelectorAll":83}],85:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/Array/prototype.indexOf');var isElement=require('@marcom/ac-dom-nodes/isElement');var isDocumentFragment=require('@marcom/ac-dom-nodes/isDocumentFragment');var removeElement=require('@marcom/ac-dom-nodes/remove');var COLLECTION_PREFIX='_ac_qsa_';var isElementInContext=function(el,context){var parent;if(context===document){return!0}
parent=el;while((parent=parent.parentNode)&&isElement(parent)){if(parent===context){return!0}}
return!1};var recalcStyles=function(context){if('recalc' in context){context.recalc(!1)}else{document.recalc(!1)}
window.scrollBy(0,0)};module.exports=function querySelectorAll(selector,context){var style=document.createElement('style');var id=COLLECTION_PREFIX+(Math.random()+'').slice(-6);var els=[];var el;context=context||document;document[id]=[];if(isDocumentFragment(context)){context.appendChild(style)}else{document.documentElement.firstChild.appendChild(style)}
style.styleSheet.cssText='*{display:recalc;}'+selector+'{ac-qsa:expression(document["'+id+'"] && document["'+id+'"].push(this));}';recalcStyles(context);while(document[id].length){el=document[id].shift();el.style.removeAttribute('ac-qsa');if(els.indexOf(el)===-1&&isElementInContext(el,context)){els.push(el)}}
document[id]=null;removeElement(style);recalcStyles(context);return els}},{"@marcom/ac-dom-nodes/isDocumentFragment":76,"@marcom/ac-dom-nodes/isElement":77,"@marcom/ac-dom-nodes/remove":79,"@marcom/ac-polyfills/Array/prototype.indexOf":135}],86:[function(require,module,exports){'use strict';var ERR_FUNCTION_REQUIRE='Ease expects an easing function.';function Ease(func,cssString){if(typeof func!=='function'){throw new TypeError(ERR_FUNCTION_REQUIRE)}
this.easingFunction=func;this.cssString=cssString||null}
var proto=Ease.prototype;proto.getValue=function(value){return this.easingFunction(value,0,1,1)};module.exports=Ease},{}],87:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/Array/prototype.every');var Ease=require('./Ease');var KeySpline=require('./helpers/KeySpline');var ERR_BEZIER_VALUES='Bezier curve expects exactly four (4) numbers. Given: ';module.exports=function createBezier(x1,y1,x2,y2){var pts=Array.prototype.slice.call(arguments);var allNums=pts.every(function(pt){return(typeof pt==='number')});if(pts.length!==4||!allNums){throw new TypeError(ERR_BEZIER_VALUES+pts)}
var keySpline=new KeySpline(x1,y1,x2,y2);var easingFn=function(time,begin,change,duration){return keySpline.get(time/duration)*change+begin};var cssString='cubic-bezier('+pts.join(', ')+')';return new Ease(easingFn,cssString)}},{"./Ease":86,"./helpers/KeySpline":88,"@marcom/ac-polyfills/Array/prototype.every":133}],88:[function(require,module,exports){function KeySpline(mX1,mY1,mX2,mY2){this.get=function(aX){if(mX1===mY1&&mX2===mY2){return aX}
return CalcBezier(GetTForX(aX),mY1,mY2)};function A(aA1,aA2){return 1.0-3.0*aA2+3.0*aA1}
function B(aA1,aA2){return 3.0*aA2-6.0*aA1}
function C(aA1){return 3.0*aA1}
function CalcBezier(aT,aA1,aA2){return((A(aA1,aA2)*aT+B(aA1,aA2))*aT+C(aA1))*aT}
function GetSlope(aT,aA1,aA2){return 3.0*A(aA1,aA2)*aT*aT+2.0*B(aA1,aA2)*aT+C(aA1)}
function GetTForX(aX){var aGuessT=aX;for(var i=0;i<4;++i){var currentSlope=GetSlope(aGuessT,mX1,mX2);if(currentSlope===0.0){return aGuessT}
var currentX=CalcBezier(aGuessT,mX1,mX2)-aX;aGuessT-=currentX/currentSlope}
return aGuessT}}
module.exports=KeySpline},{}],89:[function(require,module,exports){'use strict';module.exports={EventEmitterMicro:require('./ac-event-emitter-micro/EventEmitterMicro')}},{"./ac-event-emitter-micro/EventEmitterMicro":90}],90:[function(require,module,exports){'use strict';function EventEmitterMicro(){this._events={}}
var proto=EventEmitterMicro.prototype;proto.on=function(eventName,callback){this._events[eventName]=this._events[eventName]||[];this._events[eventName].unshift(callback)};proto.once=function(eventName,callback){var that=this;function fn(data){that.off(eventName,fn);if(data!==undefined)callback(data);else callback()}
this.on(eventName,fn)};proto.off=function(eventName,callback){if(!this.has(eventName))return;if(arguments.length===1){this._events[eventName]=null;delete this._events[eventName];return}
var index=this._events[eventName].indexOf(callback);if(index===-1)return;this._events[eventName].splice(index,1)};proto.trigger=function(eventName,data){if(!this.has(eventName))return;for(var i=this._events[eventName].length-1;i>=0;i--){if(data!==undefined)this._events[eventName][i](data);else this._events[eventName][i]()}};proto.has=function(eventName){if(eventName in this._events===!1||this._events[eventName].length===0){return!1}
return!0};proto.destroy=function(){for(var eventName in this._events){this._events[eventName]=null}
this._events=null};module.exports=EventEmitterMicro},{}],91:[function(require,module,exports){module.exports.EventEmitter=require('./ac-event-emitter/EventEmitter')},{"./ac-event-emitter/EventEmitter":92}],92:[function(require,module,exports){'use strict';var propagationName='EventEmitter:propagation';var EventEmitter=function(context){if(context){this.context=context}};var proto=EventEmitter.prototype;var getEvents=function(){if(!this.hasOwnProperty('_events')&&typeof this._events!=='object'){this._events={}}
return this._events};var parseEvents=function(args,register){var event=args[0];var callback=args[1];var context=args[2];if((typeof event!=='string'&&typeof event!=='object')||event===null||Array.isArray(event)){throw new TypeError('Expecting event name to be a string or object.')}
if((typeof event==='string')&&!callback){throw new Error('Expecting a callback function to be provided.')}
if(callback&&(typeof callback!=='function')){if(typeof event==='object'&&typeof callback==='object'){context=callback}
else{throw new TypeError('Expecting callback to be a function.')}}
if(typeof event==='object'){for(var evt in event){register.call(this,evt,event[evt],context)}}
if(typeof event==='string'){event=event.split(' ');event.forEach(function(evt){register.call(this,evt,callback,context)},this)}};var each=function(event,callback){var eventsArray;var i;var length;eventsArray=getEvents.call(this)[event];if(!eventsArray||eventsArray.length===0){return}
eventsArray=eventsArray.slice();this._stoppedImmediatePropagation=!1;for(i=0,length=eventsArray.length;i<length;i++){if(this._stoppedImmediatePropagation||callback(eventsArray[i],i)){break}}};var removeSpecificCallback=function(events,event,callback){var i=-1;each.call(this,event,function(callbackObject,index){if(callbackObject.callback===callback){i=index;return!0}});if(i===-1){return}
events[event].splice(i,1)};proto.on=function(){var events=getEvents.call(this);parseEvents.call(this,arguments,function(event,callback,context){events[event]=events[event]||(events[event]=[]);events[event].push({callback:callback,context:context})});return this};proto.once=function(){parseEvents.call(this,arguments,function(event,callback,context){var wrapper=function(data){callback.call(context||this,data);this.off(event,wrapper)};this.on(event,wrapper,this)});return this};proto.off=function(event,callback){var events=getEvents.call(this);if(arguments.length===0){this._events={}}
else if(!event||(typeof event!=='string'&&typeof event!=='object')||Array.isArray(event)){throw new TypeError('Expecting event name to be a string or object.')}
if(typeof event==='object'){for(var e in event){removeSpecificCallback.call(this,events,e,event[e])}}
if(typeof event==='string'){var split=event.split(' ');if(split.length===1){if(callback){removeSpecificCallback.call(this,events,event,callback)}
else{events[event]=[]}}
else{split.forEach(function(event){events[event]=[]})}}
return this};proto.trigger=function(event,data,doNotPropagate){if(!event){throw new Error('trigger method requires an event name')}
if(typeof event!=='string'){throw new TypeError('Expecting event names to be a string.')}
if(doNotPropagate&&typeof doNotPropagate!=='boolean'){throw new TypeError('Expecting doNotPropagate to be a boolean.')}
event=event.split(' ');event.forEach(function(evt){each.call(this,evt,function(callbackObject){callbackObject.callback.call(callbackObject.context||this.context||this,data)}.bind(this));if(!doNotPropagate){each.call(this,propagationName,function(propagation){var eventName=evt;if(propagation.prefix){eventName=propagation.prefix+eventName}
propagation.emitter.trigger(eventName,data)})}},this);return this};proto.propagateTo=function(eventEmitter,prefix){var events=getEvents.call(this);if(!events[propagationName]){this._events[propagationName]=[]}
events[propagationName].push({emitter:eventEmitter,prefix:prefix})};proto.stopPropagatingTo=function(eventEmitter){var events=getEvents.call(this);if(!eventEmitter){events[propagationName]=[];return}
var propagationTargets=events[propagationName];var length=propagationTargets.length;var i;for(i=0;i<length;i++){if(propagationTargets[i].emitter===eventEmitter){propagationTargets.splice(i,1);break}}};proto.stopImmediatePropagation=function(){this._stoppedImmediatePropagation=!0};proto.has=function(evt,callback,context){var events=getEvents.call(this);var eventsArray=events[evt];if(arguments.length===0){return Object.keys(events)}
if(!eventsArray){return!1}
if(!callback){return(eventsArray.length>0)?!0:!1}
for(var i=0,length=eventsArray.length;i<length;i++){var callbackContainer=eventsArray[i];if(context&&callback&&callbackContainer.context===context&&callbackContainer.callback===callback){return!0}
else if(callback&&!context&&callbackContainer.callback===callback){return!0}}
return!1};module.exports=EventEmitter},{}],93:[function(require,module,exports){'use strict';module.exports={getWindow:function(){return window},getDocument:function(){return document},getNavigator:function(){return navigator}}},{}],94:[function(require,module,exports){'use strict';var os=require('@marcom/useragent-detect').os;var touchAvailable=require('./touchAvailable').original;var globalsHelper=require('./helpers/globals');var once=require('@marcom/ac-function/once');function isDesktop(){var windowObj=globalsHelper.getWindow();return((!touchAvailable()&&!windowObj.orientation)||os.windows)}
module.exports=once(isDesktop);module.exports.original=isDesktop},{"./helpers/globals":93,"./touchAvailable":98,"@marcom/ac-function/once":107,"@marcom/useragent-detect":308}],95:[function(require,module,exports){'use strict';var isDesktop=require('./isDesktop').original;var isTablet=require('./isTablet').original;var once=require('@marcom/ac-function/once');function isHandheld(){return(!isDesktop()&&!isTablet())}
module.exports=once(isHandheld);module.exports.original=isHandheld},{"./isDesktop":94,"./isTablet":97,"@marcom/ac-function/once":107}],96:[function(require,module,exports){'use strict';var globalsHelper=require('./helpers/globals');module.exports=function isRetina(){var windowObj=globalsHelper.getWindow();return('devicePixelRatio' in windowObj&&windowObj.devicePixelRatio>=1.5)}},{"./helpers/globals":93}],97:[function(require,module,exports){'use strict';var isDesktop=require('./isDesktop').original;var globalsHelper=require('./helpers/globals');var once=require('@marcom/ac-function/once');var MIN_TABLET_WIDTH=600;function isTablet(){var windowObj=globalsHelper.getWindow();var width=windowObj.screen.width;if(windowObj.orientation&&windowObj.screen.height<width){width=windowObj.screen.height}
return(!isDesktop()&&width>=MIN_TABLET_WIDTH)}
module.exports=once(isTablet);module.exports.original=isTablet},{"./helpers/globals":93,"./isDesktop":94,"@marcom/ac-function/once":107}],98:[function(require,module,exports){'use strict';var globalsHelper=require('./helpers/globals');var once=require('@marcom/ac-function/once');function touchAvailable(){var windowObj=globalsHelper.getWindow();var documentObj=globalsHelper.getDocument();var navigatorObj=globalsHelper.getNavigator();return!!(('ontouchstart' in windowObj)||(windowObj.DocumentTouch&&documentObj instanceof windowObj.DocumentTouch)||(navigatorObj.maxTouchPoints>0)||(navigatorObj.msMaxTouchPoints>0))}
module.exports=once(touchAvailable);module.exports.original=touchAvailable},{"./helpers/globals":93,"@marcom/ac-function/once":107}],99:[function(require,module,exports){'use strict';var globalsHelper=require('./helpers/globals');var once=require('@marcom/ac-function/once');function webGLAvailable(){var documentObj=globalsHelper.getDocument();var canvas=documentObj.createElement('canvas');if(typeof canvas.getContext==='function'){return!!(canvas.getContext('webgl')||canvas.getContext('experimental-webgl'))}
return!1}
module.exports=once(webGLAvailable);module.exports.original=webGLAvailable},{"./helpers/globals":93,"@marcom/ac-function/once":107}],100:[function(require,module,exports){'use strict';module.exports=require('./fullscreen')},{"./fullscreen":106}],101:[function(require,module,exports){module.exports={STANDARD:'standard',IOS:'ios'}},{}],102:[function(require,module,exports){'use strict';var addEventListener=require('@marcom/ac-dom-events/addEventListener');var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var eventTypes=require('./../events/types');var modes=require('./../consts/modes');var desktopFullscreenDelegate=new EventEmitterMicro();function onEnterFullscreen(e){desktopFullscreenDelegate.trigger(eventTypes.ENTERFULLSCREEN,e)};function onExitFullscreen(e){desktopFullscreenDelegate.trigger(eventTypes.EXITFULLSCREEN,e)};function onFullscreenchange(e){if(desktopFullscreenDelegate.fullscreenElement()){onEnterFullscreen(e)}else{onExitFullscreen(e)}};function bindFullscreenEvent(){addEventListener(document,'fullscreenchange',onFullscreenchange)};bindFullscreenEvent();desktopFullscreenDelegate.fullscreenEnabled=function(el){var fullscreenEnabled=document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled;return!!(fullscreenEnabled)};desktopFullscreenDelegate.fullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement};desktopFullscreenDelegate.exitFullscreen=function(el){var method;if(el&&typeof el.webkitExitFullscreen==='function'){el.webkitExitFullscreen()}else if(typeof document.exitFullscreen==='function'){method='exitFullscreen'}else if(typeof document.webkitExitFullscreen==='function'){method='webkitExitFullscreen'}else if(typeof document.webkitCancelFullScreen==='function'){method='webkitCancelFullScreen'}else if(typeof document.mozCancelFullScreen==='function'){method='mozCancelFullScreen'}else if(typeof document.msExitFullscreen==='function'){method='msExitFullscreen'}
if(typeof document[method]==='function'){document[method].call(document)}};desktopFullscreenDelegate.requestFullscreen=function(el){var method;if(typeof el.requestFullscreen==='function'){method='requestFullscreen'}else if(typeof el.webkitRequestFullscreen==='function'){method='webkitRequestFullscreen'}else if(typeof el.webkitRequestFullScreen==='function'){method='webkitRequestFullScreen'}else if(typeof el.mozRequestFullScreen==='function'){method='mozRequestFullScreen'}else if(typeof el.msRequestFullscreen==='function'){method='msRequestFullscreen'}
if(typeof el[method]==='function'){el[method].call(el)}};desktopFullscreenDelegate.mode=modes.STANDARD;module.exports=desktopFullscreenDelegate},{"./../consts/modes":101,"./../events/types":105,"@marcom/ac-dom-events/addEventListener":55,"@marcom/ac-event-emitter-micro":89}],103:[function(require,module,exports){'use strict';var iosFullscreenDelegate=require('./ios');var desktopFullscreenDelegate=require('./desktop');module.exports={create:function(){var delegate=desktopFullscreenDelegate;if('webkitEnterFullscreen' in document.createElement('video')&&!('webkitRequestFullScreen' in document.createElement('div'))){delegate=iosFullscreenDelegate}
return delegate}}},{"./desktop":102,"./ios":104}],104:[function(require,module,exports){'use strict';var addEventListener=require('@marcom/ac-dom-events/addEventListener');var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var eventTypes=require('./../events/types');var modes=require('./../consts/modes');var fullscreenElement;bindIOSFullscreenEvents();function bindIOSFullscreenEvents(){addEventListener(document,'webkitbeginfullscreen',onIOSEnterFullscreen,!0);addEventListener(document,'webkitendfullscreen',onIOSExitFullscreen,!0)};function onIOSEnterFullscreen(e){iosFullscreenDelegate.trigger(eventTypes.ENTERFULLSCREEN,e)}
function onIOSExitFullscreen(e){fullscreenElement=undefined;iosFullscreenDelegate.trigger(eventTypes.EXITFULLSCREEN,e)}
var iosFullscreenDelegate=new EventEmitterMicro();iosFullscreenDelegate.fullscreenEnabled=function(el){return!!(el.webkitSupportsFullscreen)};iosFullscreenDelegate.fullscreenElement=function(){return fullscreenElement};iosFullscreenDelegate.exitFullscreen=function(el){if(el&&typeof el.webkitExitFullscreen==='function'){el.webkitExitFullscreen()}};iosFullscreenDelegate.requestFullscreen=function(el){if(typeof el.webkitEnterFullscreen==='function'){el.webkitEnterFullscreen()}};iosFullscreenDelegate.mode=modes.IOS;module.exports=iosFullscreenDelegate},{"./../consts/modes":101,"./../events/types":105,"@marcom/ac-dom-events/addEventListener":55,"@marcom/ac-event-emitter-micro":89}],105:[function(require,module,exports){module.exports={ENTERFULLSCREEN:'enterfullscreen',EXITFULLSCREEN:'exitfullscreen'}},{}],106:[function(require,module,exports){'use strict';var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var delegateFactory=require('./delegate/factory');var MISSING_ELEMENT_ERR='Error: Element missing. ac-fullscreen requires an element to be specified';var delegate=delegateFactory.create();function throwMissingElementErr(){throw new Error(MISSING_ELEMENT_ERR)}
var fullscreen={};fullscreen.requestFullscreen=function(el){if(!el){throwMissingElementErr()}
return delegate.requestFullscreen(el)};fullscreen.fullscreenEnabled=function(el){if(!el){throwMissingElementErr()}
return delegate.fullscreenEnabled(el)};fullscreen.fullscreenElement=function(){return delegate.fullscreenElement()};fullscreen.exitFullscreen=function(el){if(!el){throwMissingElementErr()}
return delegate.exitFullscreen(el)};fullscreen.getMode=function(){return delegate.mode};fullscreen.on=function(){return delegate.on.apply(delegate,arguments)};fullscreen.off=function(){return delegate.off.apply(delegate,arguments)};fullscreen.once=function(){return delegate.once.apply(delegate,arguments)};module.exports=fullscreen},{"./delegate/factory":103,"@marcom/ac-event-emitter-micro":89}],107:[function(require,module,exports){'use strict';module.exports=function once(func){var result;return function(){if(typeof result==='undefined'){result=func.apply(this,arguments)}
return result}}},{}],108:[function(require,module,exports){'use strict';module.exports=function throttle(func,wait){var timeout=null;return function(){if(timeout===null){func.apply(this,arguments);timeout=setTimeout(function(){timeout=null},wait)}}}},{}],109:[function(require,module,exports){'use strict';var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var ac_addEventListener=require('@marcom/ac-dom-events/utils/addEventListener');var ac_removeEventListener=require('@marcom/ac-dom-events/utils/removeEventListener');var create=require('@marcom/ac-object/create');var KeyEvent=require('./internal/KeyEvent');var KEYDOWN='keydown';var KEYUP='keyup';function Keyboard(contextElement){this._keysDown={};this._DOMKeyDown=this._DOMKeyDown.bind(this);this._DOMKeyUp=this._DOMKeyUp.bind(this);this._context=contextElement||document;ac_addEventListener(this._context,KEYDOWN,this._DOMKeyDown,!0);ac_addEventListener(this._context,KEYUP,this._DOMKeyUp,!0);EventEmitterMicro.call(this)}
var proto=Keyboard.prototype=create(EventEmitterMicro.prototype);proto.onDown=function(keyCode,callback){return this.on(KEYDOWN+':'+keyCode,callback)};proto.onceDown=function(keyCode,callback){return this.once(KEYDOWN+':'+keyCode,callback)};proto.offDown=function(keyCode,callback){return this.off(KEYDOWN+':'+keyCode,callback)};proto.onUp=function(keyCode,callback){return this.on(KEYUP+':'+keyCode,callback)};proto.onceUp=function(keyCode,callback){return this.once(KEYUP+':'+keyCode,callback)};proto.offUp=function(keyCode,callback){return this.off(KEYUP+':'+keyCode,callback)};proto.isDown=function(keyCode){keyCode+='';return this._keysDown[keyCode]||!1};proto.isUp=function(keyCode){return!this.isDown(keyCode)};proto.destroy=function(){ac_removeEventListener(this._context,KEYDOWN,this._DOMKeyDown,!0);ac_removeEventListener(this._context,KEYUP,this._DOMKeyUp,!0);this._keysDown=null;this._context=null;EventEmitterMicro.prototype.destroy.call(this);return this};proto._DOMKeyDown=function(keyboardEvent){var evt=this._normalizeKeyboardEvent(keyboardEvent);var keyCode=evt.keyCode+='';this._trackKeyDown(keyCode);this.trigger(KEYDOWN+':'+keyCode,evt)};proto._DOMKeyUp=function(keyboardEvent){var evt=this._normalizeKeyboardEvent(keyboardEvent);var keyCode=evt.keyCode+='';this._trackKeyUp(keyCode);this.trigger(KEYUP+':'+keyCode,evt)};proto._normalizeKeyboardEvent=function(keyboardEvent){return new KeyEvent(keyboardEvent)};proto._trackKeyUp=function(keyCode){if(this._keysDown[keyCode]){this._keysDown[keyCode]=!1}};proto._trackKeyDown=function(keyCode){if(!this._keysDown[keyCode]){this._keysDown[keyCode]=!0}};module.exports=Keyboard},{"./internal/KeyEvent":111,"@marcom/ac-dom-events/utils/addEventListener":64,"@marcom/ac-dom-events/utils/removeEventListener":66,"@marcom/ac-event-emitter-micro":89,"@marcom/ac-object/create":124}],110:[function(require,module,exports){'use strict';var Keyboard=require('./Keyboard');module.exports=new Keyboard()},{"./Keyboard":109}],111:[function(require,module,exports){'use strict';var blackList=['keyLocation'];function KeyEvent(originalEvt){this.originalEvent=originalEvt;var prop;for(prop in originalEvt){if(blackList.indexOf(prop)===-1&&typeof originalEvt[prop]!=='function'){this[prop]=originalEvt[prop]}}
this.location=(this.originalEvent.location!==undefined)?this.originalEvent.location:this.originalEvent.keyLocation}
KeyEvent.prototype={preventDefault:function(){if(typeof this.originalEvent.preventDefault!=='function'){this.originalEvent.returnValue=!1;return}
return this.originalEvent.preventDefault()},stopPropagation:function(){return this.originalEvent.stopPropagation()}};module.exports=KeyEvent},{}],112:[function(require,module,exports){'use strict';module.exports={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CONTROL:17,ALT:18,COMMAND:91,CAPSLOCK:20,ESCAPE:27,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,ARROW_LEFT:37,ARROW_UP:38,ARROW_RIGHT:39,ARROW_DOWN:40,DELETE:46,ZERO:48,ONE:49,TWO:50,THREE:51,FOUR:52,FIVE:53,SIX:54,SEVEN:55,EIGHT:56,NINE:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,NUMPAD_ZERO:96,NUMPAD_ONE:97,NUMPAD_TWO:98,NUMPAD_THREE:99,NUMPAD_FOUR:100,NUMPAD_FIVE:101,NUMPAD_SIX:102,NUMPAD_SEVEN:103,NUMPAD_EIGHT:104,NUMPAD_NINE:105,NUMPAD_ASTERISK:106,NUMPAD_PLUS:107,NUMPAD_DASH:109,NUMPAD_DOT:110,NUMPAD_SLASH:111,NUMPAD_EQUALS:187,TICK:192,LEFT_BRACKET:219,RIGHT_BRACKET:221,BACKSLASH:220,SEMICOLON:186,APOSTRAPHE:222,APOSTROPHE:222,SPACEBAR:32,CLEAR:12,COMMA:188,DOT:190,SLASH:191}},{}],113:[function(require,module,exports){'use strict';module.exports={Modal:require('./ac-modal-basic/Modal'),Renderer:require('./ac-modal-basic/Renderer'),classNames:require('./ac-modal-basic/classNames'),dataAttributes:require('./ac-modal-basic/dataAttributes')}},{"./ac-modal-basic/Modal":114,"./ac-modal-basic/Renderer":115,"./ac-modal-basic/classNames":116,"./ac-modal-basic/dataAttributes":117}],114:[function(require,module,exports){'use strict';var ac_DomEvents={addEventListener:require('@marcom/ac-dom-events/addEventListener'),removeEventListener:require('@marcom/ac-dom-events/removeEventListener'),target:require('@marcom/ac-dom-events/target')};var ac_DomMetrics={getScrollX:require('@marcom/ac-dom-metrics/getScrollX'),getScrollY:require('@marcom/ac-dom-metrics/getScrollY')};var ac_Object={create:require('@marcom/ac-object/create'),defaults:require('@marcom/ac-object/defaults')};var ac_Keyboard=require('@marcom/ac-keyboard');var keys=require('@marcom/ac-keyboard/keyMap');var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var Renderer=require('./Renderer');var modalDefaults={retainScrollPosition:!1};function Modal(modalOptions,renderOptions){EventEmitterMicro.call(this);this.options=ac_Object.defaults(modalDefaults,modalOptions);this.renderer=new Renderer(renderOptions);this.opened=!1;this._keysToClose=[keys.ESCAPE];this._attachedKeysToClose=[];this.close=this.close.bind(this)}
var proto=Modal.prototype=ac_Object.create(EventEmitterMicro.prototype);proto.open=function(){if(this.options.retainScrollPosition){this._saveScrollPosition()}
if(!this.opened){this._attachEvents();this.trigger('willopen');this.renderer.open();this.opened=!0;this.trigger('open')}};proto.close=function(evt){var target;var closeAttribute;if(this.opened){if(evt&&evt.type==='click'){target=ac_DomEvents.target(evt);closeAttribute=this.renderer.options.dataAttributes.close;if(!target.hasAttribute(closeAttribute)){return}}
this.trigger('willclose');this._removeEvents();this.renderer.close();if(this.options.retainScrollPosition){this._restoreScrollPosition()}
this.opened=!1;this.trigger('close')}};proto.render=function(){this.renderer.render()};proto.appendContent=function(el,target){this.renderer.appendContent(el,target)};proto.removeContent=function(el){this.renderer.removeContent(el)};proto.destroy=function(){this._removeEvents();this.renderer.destroy();for(var prop in this){if(this.hasOwnProperty(prop)){this[prop]=null}}};proto.addKeyToClose=function(key){var index=this._keysToClose.indexOf(key);if(index===-1){this._keysToClose.push(key);this._bindKeyToClose(key)}};proto.removeKeyToClose=function(key){var index=this._keysToClose.indexOf(key);if(index!==-1){this._keysToClose.splice(index,1)}
this._releaseKeyToClose(key)};proto._bindKeyToClose=function(key){var index=this._attachedKeysToClose.indexOf(key);if(index===-1){ac_Keyboard.onUp(key,this.close);this._attachedKeysToClose.push(key)}};proto._releaseKeyToClose=function(key){var index=this._attachedKeysToClose.indexOf(key);if(index!==-1){ac_Keyboard.offUp(key,this.close);this._attachedKeysToClose.splice(index,1)}};proto._removeEvents=function(){if(this.renderer.modalElement){ac_DomEvents.removeEventListener(this.renderer.modalElement,'click',this.close)}
this._keysToClose.forEach(this._releaseKeyToClose,this)};proto._attachEvents=function(){if(this.renderer.modalElement){ac_DomEvents.addEventListener(this.renderer.modalElement,'click',this.close)}
this._keysToClose.forEach(this._bindKeyToClose,this)};proto._restoreScrollPosition=function(){window.scrollTo(this._scrollX||0,this._scrollY||0)};proto._saveScrollPosition=function(){this._scrollX=ac_DomMetrics.getScrollX();this._scrollY=ac_DomMetrics.getScrollY()};module.exports=Modal},{"./Renderer":115,"@marcom/ac-dom-events/addEventListener":55,"@marcom/ac-dom-events/removeEventListener":59,"@marcom/ac-dom-events/target":63,"@marcom/ac-dom-metrics/getScrollX":67,"@marcom/ac-dom-metrics/getScrollY":68,"@marcom/ac-event-emitter-micro":89,"@marcom/ac-keyboard":110,"@marcom/ac-keyboard/keyMap":112,"@marcom/ac-object/create":124,"@marcom/ac-object/defaults":125}],115:[function(require,module,exports){'use strict';var ac_Classlist={add:require('@marcom/ac-classlist/add'),remove:require('@marcom/ac-classlist/remove')};var ac_Object={defaults:require('@marcom/ac-object/defaults')};var ac_DomNodes={remove:require('@marcom/ac-dom-nodes/remove'),isElement:require('@marcom/ac-dom-nodes/isElement')};var modalClassNames=require('./classNames');var modalDataAttributes=require('./dataAttributes');var defaults={modalElement:null,contentElement:null,closeButton:null,classNames:modalClassNames,dataAttributes:modalDataAttributes};var Renderer=function(options){options=options||{};this.options=ac_Object.defaults(defaults,options);this.options.classNames=ac_Object.defaults(defaults.classNames,options.classNames);this.options.dataAttributes=ac_Object.defaults(defaults.dataAttributes,options.dataAttributes);this.modalElement=this.options.modalElement;this.contentElement=this.options.contentElement;this.closeButton=this.options.closeButton};var proto=Renderer.prototype;proto.render=function(){if(!ac_DomNodes.isElement(this.modalElement)){this.modalElement=this.renderModalElement(this.options.classNames.modalElement)}
if(!ac_DomNodes.isElement(this.contentElement)){this.contentElement=this.renderContentElement(this.options.classNames.contentElement)}
if(this.closeButton!==!1){if(!ac_DomNodes.isElement(this.closeButton)){this.closeButton=this.renderCloseButton(this.options.classNames.closeButton)}
this.modalElement.appendChild(this.closeButton)}
this.modalElement.appendChild(this.contentElement);document.body.appendChild(this.modalElement);return this.modalElement};proto.renderCloseButton=function(classNames){var closeButton;classNames=classNames||this.options.classNames.closeButton;closeButton=this._renderElement('button',classNames);closeButton.setAttribute(this.options.dataAttributes.close,'');return closeButton};proto.renderModalElement=function(classNames){classNames=classNames||this.options.classNames.modalElement;return this._renderElement('div',classNames)};proto.renderContentElement=function(classNames){classNames=classNames||this.options.classNames.contentElement;return this._renderElement('div',classNames)};proto.appendContent=function(el,target){if(!ac_DomNodes.isElement(el)){return}
if(arguments[1]===undefined){this.contentElement.appendChild(el)}else if(ac_DomNodes.isElement(target)){target.appendChild(el)}};proto.removeContent=function(el){if(el){if(this.modalElement.contains(el)){ac_DomNodes.remove(el)}}else{this._emptyContent()}};proto.open=function(){var docElArgs=[document.documentElement].concat(this.options.classNames.documentElement);var modalElArgs=[this.modalElement].concat(this.options.classNames.modalOpen);ac_Classlist.add.apply(null,docElArgs);ac_Classlist.add.apply(null,modalElArgs)};proto.close=function(){var docElArgs=[document.documentElement].concat(this.options.classNames.documentElement);var modalElArgs=[this.modalElement].concat(this.options.classNames.modalOpen);ac_Classlist.remove.apply(null,docElArgs);ac_Classlist.remove.apply(null,modalElArgs)};proto.destroy=function(){var docElArgs=[document.documentElement].concat(this.options.classNames.documentElement);if(this.modalElement&&document.body.contains(this.modalElement)){this.close();document.body.removeChild(this.modalElement)}
ac_Classlist.remove.apply(null,docElArgs);for(var prop in this){if(this.hasOwnProperty(prop)){this[prop]=null}}};proto._renderElement=function(type,classNames){var el=document.createElement(type);var args=[el];if(classNames){args=args.concat(classNames)}
ac_Classlist.add.apply(null,args);return el};proto._emptyContent=function(){this.contentElement.innerHTML=''};module.exports=Renderer},{"./classNames":116,"./dataAttributes":117,"@marcom/ac-classlist/add":42,"@marcom/ac-classlist/remove":47,"@marcom/ac-dom-nodes/isElement":77,"@marcom/ac-dom-nodes/remove":79,"@marcom/ac-object/defaults":125}],116:[function(require,module,exports){'use strict';module.exports={modalElement:'modal',modalOpen:'modal-open',documentElement:'has-modal',contentElement:'modal-content',closeButton:'modal-close'}},{}],117:[function(require,module,exports){'use strict';module.exports={close:'data-modal-close'}},{}],118:[function(require,module,exports){'use strict';module.exports={Modal:require('./ac-modal/Modal'),createStandardModal:require('./ac-modal/factory/createStandardModal'),createFullViewportModal:require('./ac-modal/factory/createFullViewportModal')}},{"./ac-modal/Modal":119,"./ac-modal/factory/createFullViewportModal":120,"./ac-modal/factory/createStandardModal":121}],119:[function(require,module,exports){'use strict';var ac_ModalBasic=require('@marcom/ac-modal-basic').Modal;var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var CircularTab=require('@marcom/ac-accessibility/CircularTab');function Modal(options){EventEmitterMicro.call(this);this.options=options||{};this._modal=new ac_ModalBasic(options,this.options.renderer);this.opened=!1;this._render();this.closeButton=this._modal.renderer.closeButton;this.modalElement=this._modal.renderer.modalElement;this.contentElement=this._modal.renderer.contentElement;this.modalElement.setAttribute('role','dialog');this.modalElement.setAttribute('aria-label','Modal');this.modalElement.setAttribute('aria-modal','true');this.modalElement.setAttribute('tabindex','-1');this.closeButton.setAttribute('aria-label','Close');this._circularTab=new CircularTab(this.modalElement);this._onWillOpen=this._onWillOpen.bind(this);this._onOpen=this._onOpen.bind(this);this._onWillClose=this._onWillClose.bind(this);this._onClose=this._onClose.bind(this);this._bindEvents()}
var proto=Modal.prototype=Object.create(EventEmitterMicro.prototype);proto.open=function(){this._modal.open();this.opened=this._modal.opened};proto.close=function(){this._modal.close()};proto.appendContent=function(el){this._modal.appendContent(el)};proto.removeContent=function(el){this._modal.removeContent(el)};proto.destroy=function(){this._releaseEvents();this._modal.destroy();this._removeModalFocus();this._circularTab.destroy();this._focusObj=null;for(var prop in this){if(this.hasOwnProperty(prop)){this[prop]=null}}};proto.addKeyToClose=function(key){this._modal.addKeyToClose(key)};proto.removeKeyToClose=function(key){this._modal.removeKeyToClose(key)};proto._render=function(){this._modal.render();this._modal.renderer.modalElement.setAttribute('aria-hidden','true')};proto._bindEvents=function(){this._modal.on('willopen',this._onWillOpen);this._modal.on('open',this._onOpen);this._modal.on('willclose',this._onWillClose);this._modal.on('close',this._onClose)};proto._releaseEvents=function(){this._modal.off('willopen',this._onWillOpen);this._modal.off('open',this._onOpen);this._modal.off('willclose',this._onWillClose);this._modal.off('close',this._onClose)};proto._onWillOpen=function(){this.trigger('willopen')};proto._onOpen=function(){this.opened=this._modal.opened;this._giveModalFocus();this.trigger('open')};proto._onWillClose=function(){this.trigger('willclose');this._removeModalFocus()};proto._onClose=function(){this.opened=this._modal.opened;this.trigger('close')};proto._giveModalFocus=function(){this.modalElement.removeAttribute('aria-hidden');this._activeElement=document.activeElement;setTimeout(function(){this.modalElement.focus()}.bind(this),300);this._circularTab.start()};proto._removeModalFocus=function(){this._circularTab.stop();this.modalElement.setAttribute('aria-hidden','true');if(this._activeElement){this._activeElement.focus();this._activeElement=null}};module.exports=Modal},{"@marcom/ac-accessibility/CircularTab":24,"@marcom/ac-event-emitter-micro":89,"@marcom/ac-modal-basic":113}],120:[function(require,module,exports){'use strict';var Modal=require('../Modal');var modalBasicClassNames=require('@marcom/ac-modal-basic').classNames;var options={retainScrollPosition:!0,renderer:{classNames:{documentElement:[modalBasicClassNames.documentElement].concat('has-modal-full-viewport'),modalElement:[modalBasicClassNames.modalElement].concat('modal-full-viewport')}}};function createFullViewportModal(contentElement,settings){var modal=new Modal(options);var fullViewportModalSettings=settings||{};if(contentElement){modal.appendContent(contentElement)}
if(fullViewportModalSettings.removeContainerPadding){modal.modalElement.classList.add('remove-container-padding')}
return modal}
module.exports=createFullViewportModal},{"../Modal":119,"@marcom/ac-modal-basic":113}],121:[function(require,module,exports){'use strict';var Modal=require('../Modal');var modalBasicClassNames=require('@marcom/ac-modal-basic').classNames;var modalBasicDataAttributes=require('@marcom/ac-modal-basic').dataAttributes;var ac_Classlist={add:require('@marcom/ac-classlist/add')};var options={renderer:{classNames:{documentElement:[modalBasicClassNames.documentElement].concat('has-modal-standard'),modalElement:[modalBasicClassNames.modalElement].concat('modal-standard')}}};function createStandardModal(contentElement){var modal=new Modal(options);if(contentElement){modal.appendContent(contentElement)}
var contentTable=document.createElement('div');var contentCell=document.createElement('div');var contentWrapper=document.createElement('div');var contentPadding=document.createElement('div');ac_Classlist.add(contentTable,'content-table');ac_Classlist.add(contentCell,'content-cell');ac_Classlist.add(contentWrapper,'content-wrapper');ac_Classlist.add(contentPadding,'content-padding','large-8','medium-10');modal.modalElement.setAttribute(modalBasicDataAttributes.close,'');contentWrapper.setAttribute(modalBasicDataAttributes.close,'');contentCell.setAttribute(modalBasicDataAttributes.close,'');contentTable.appendChild(contentCell);contentCell.appendChild(contentWrapper);contentWrapper.appendChild(contentPadding);modal.modalElement.appendChild(contentTable);contentPadding.appendChild(modal.contentElement);contentPadding.appendChild(modal.closeButton);return modal}
module.exports=createStandardModal},{"../Modal":119,"@marcom/ac-classlist/add":42,"@marcom/ac-modal-basic":113}],122:[function(require,module,exports){'use strict';module.exports={clone:require('./clone'),create:require('./create'),defaults:require('./defaults'),extend:require('./extend'),getPrototypeOf:require('./getPrototypeOf'),isDate:require('./isDate'),isEmpty:require('./isEmpty'),isRegExp:require('./isRegExp'),toQueryParameters:require('./toQueryParameters')}},{"./clone":123,"./create":124,"./defaults":125,"./extend":126,"./getPrototypeOf":127,"./isDate":128,"./isEmpty":129,"./isRegExp":130,"./toQueryParameters":131}],123:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/Array/isArray');var extend=require('./extend');var hasOwnProp=Object.prototype.hasOwnProperty;var deepClone=function(dest,source){var prop;for(prop in source){if(hasOwnProp.call(source,prop)){if(source[prop]===null){dest[prop]=null}
else if(typeof source[prop]==='object'){dest[prop]=Array.isArray(source[prop])?[]:{};deepClone(dest[prop],source[prop])}
else{dest[prop]=source[prop]}}}
return dest};module.exports=function clone(object,deep){if(deep){return deepClone({},object)}
return extend({},object)}},{"./extend":126,"@marcom/ac-polyfills/Array/isArray":132}],124:[function(require,module,exports){'use strict';var F=function(){};module.exports=function create(proto){if(arguments.length>1){throw new Error('Second argument not supported')}
if(proto===null||typeof proto!=='object'){throw new TypeError('Object prototype may only be an Object.')}
if(typeof Object.create==='function'){return Object.create(proto)}else{F.prototype=proto;return new F()}}},{}],125:[function(require,module,exports){'use strict';var extend=require('./extend');module.exports=function defaults(defaultsObj,options){if(typeof defaultsObj!=='object'){throw new TypeError('defaults: must provide a defaults object')}
options=options||{};if(typeof options!=='object'){throw new TypeError('defaults: options must be a typeof object')}
return extend({},defaultsObj,options)}},{"./extend":126}],126:[function(require,module,exports){'use strict';require('@marcom/ac-polyfills/Array/prototype.forEach');var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function extend(){var args;var dest;if(arguments.length<2){args=[{},arguments[0]]}else{args=[].slice.call(arguments)}
dest=args.shift();args.forEach(function(source){if(source!=null){for(var property in source){if(hasOwnProp.call(source,property)){dest[property]=source[property]}}}});return dest}},{"@marcom/ac-polyfills/Array/prototype.forEach":134}],127:[function(require,module,exports){'use strict';var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function getPrototypeOf(obj){if(Object.getPrototypeOf){return Object.getPrototypeOf(obj)}
else{if(typeof obj!=='object'){throw new Error('Requested prototype of a value that is not an object.')}
else if(typeof this.__proto__==='object'){return obj.__proto__}
else{var constructor=obj.constructor;var oldConstructor;if(hasOwnProp.call(obj,'constructor')){oldConstructor=constructor;if(!(delete obj.constructor)){return null}
constructor=obj.constructor;obj.constructor=oldConstructor}
return constructor?constructor.prototype:null}}}},{}],128:[function(require,module,exports){'use strict';module.exports=function isDate(date){return Object.prototype.toString.call(date)==='[object Date]'}},{}],129:[function(require,module,exports){'use strict';var hasOwnProp=Object.prototype.hasOwnProperty;module.exports=function isEmpty(object){var prop;if(typeof object!=='object'){throw new TypeError('ac-base.Object.isEmpty : Invalid parameter - expected object')}
for(prop in object){if(hasOwnProp.call(object,prop)){return!1}}
return!0}},{}],130:[function(require,module,exports){'use strict';module.exports=function isRegExp(obj){return window.RegExp?obj instanceof RegExp:!1}},{}],131:[function(require,module,exports){'use strict';var joinSearchParams=require('@marcom/ac-url/joinSearchParams');module.exports=function toQueryParameters(object){if(typeof object!=='object'){throw new TypeError('toQueryParameters error: argument is not an object')}
return joinSearchParams(object,!1)}},{"@marcom/ac-url/joinSearchParams":194}],132:[function(require,module,exports){if(!Array.isArray){Array.isArray=function(arg){return Object.prototype.toString.call(arg)==='[object Array]'}}},{}],133:[function(require,module,exports){if(!Array.prototype.every){Array.prototype.every=function every(callback,thisObj){var arrayObject=Object(this);var len=arrayObject.length>>>0;var i;if(typeof callback!=='function'){throw new TypeError(callback+' is not a function')}
for(i=0;i<len;i+=1){if(i in arrayObject&&!callback.call(thisObj,arrayObject[i],i,arrayObject)){return!1}}
return!0}}},{}],134:[function(require,module,exports){if(!Array.prototype.forEach){Array.prototype.forEach=function forEach(callback,thisObj){var arrayObject=Object(this);var i;var currentValue;if(typeof callback!=='function'){throw new TypeError('No function object passed to forEach.')}
var length=this.length
for(i=0;i<length;i+=1){currentValue=arrayObject[i];callback.call(thisObj,currentValue,i,arrayObject)}}}},{}],135:[function(require,module,exports){if(!Array.prototype.indexOf){Array.prototype.indexOf=function indexOf(searchElement,fromIndex){var startIndex=fromIndex||0;var currentIndex=0;if(startIndex<0){startIndex=this.length+fromIndex-1;if(startIndex<0){throw 'Wrapped past beginning of array while looking up a negative start index.'}}
for(currentIndex=0;currentIndex<this.length;currentIndex++){if(this[currentIndex]===searchElement){return currentIndex}}
return(-1)}}},{}],136:[function(require,module,exports){(function(){'use strict';var _slice=Array.prototype.slice;try{_slice.call(document.documentElement)}catch(e){Array.prototype.slice=function(begin,end){end=(typeof end!=='undefined')?end:this.length;if(Object.prototype.toString.call(this)==='[object Array]'){return _slice.call(this,begin,end)}
var i,cloned=[],size,len=this.length;var start=begin||0;start=(start>=0)?start:len+start;var upTo=(end)?end:len;if(end<0){upTo=len+end}
size=upTo-start;if(size>0){cloned=new Array(size);if(this.charAt){for(i=0;i<size;i++){cloned[i]=this.charAt(start+i)}}else{for(i=0;i<size;i++){cloned[i]=this[start+i]}}}
return cloned}}}())},{}],137:[function(require,module,exports){if(document.createEvent){try{new window.CustomEvent('click')}catch(err){window.CustomEvent=(function(){function CustomEvent(event,params){params=params||{bubbles:!1,cancelable:!1,detail:undefined};var evt=document.createEvent('CustomEvent');evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt}
CustomEvent.prototype=window.Event.prototype;return CustomEvent}())}}},{}],138:[function(require,module,exports){if(!Date.now){Date.now=function now(){return new Date().getTime()}}},{}],139:[function(require,module,exports){if("document" in self){if(!("classList" in document.createElement("_"))){(function(view){"use strict";if(!('Element' in view))return;var classListProp="classList",protoProp="prototype",elemCtrProto=view.Element[protoProp],objCtr=Object,strTrim=String[protoProp].trim||function(){return this.replace(/^\s+|\s+$/g,"")},arrIndexOf=Array[protoProp].indexOf||function(item){var
i=0,len=this.length;for(;i<len;i++){if(i in this&&this[i]===item){return i}}
return-1},DOMEx=function(type,message){this.name=type;this.code=DOMException[type];this.message=message},checkTokenAndGetIndex=function(classList,token){if(token===""){throw new DOMEx("SYNTAX_ERR","An invalid or illegal string was specified")}
if(/\s/.test(token)){throw new DOMEx("INVALID_CHARACTER_ERR","String contains an invalid character")}
return arrIndexOf.call(classList,token)},ClassList=function(elem){var
trimmedClasses=strTrim.call(elem.getAttribute("class")||""),classes=trimmedClasses?trimmedClasses.split(/\s+/):[],i=0,len=classes.length;for(;i<len;i++){this.push(classes[i])}
this._updateClassName=function(){elem.setAttribute("class",this.toString())}},classListProto=ClassList[protoProp]=[],classListGetter=function(){return new ClassList(this)};DOMEx[protoProp]=Error[protoProp];classListProto.item=function(i){return this[i]||null};classListProto.contains=function(token){token+="";return checkTokenAndGetIndex(this,token)!==-1};classListProto.add=function(){var
tokens=arguments,i=0,l=tokens.length,token,updated=!1;do{token=tokens[i]+"";if(checkTokenAndGetIndex(this,token)===-1){this.push(token);updated=!0}}
while(++i<l);if(updated){this._updateClassName()}};classListProto.remove=function(){var
tokens=arguments,i=0,l=tokens.length,token,updated=!1,index;do{token=tokens[i]+"";index=checkTokenAndGetIndex(this,token);while(index!==-1){this.splice(index,1);updated=!0;index=checkTokenAndGetIndex(this,token)}}
while(++i<l);if(updated){this._updateClassName()}};classListProto.toggle=function(token,force){token+="";var result=this.contains(token),method=result?force!==!0&&"remove":force!==!1&&"add";if(method){this[method](token)}
if(force===!0||force===!1){return force}else{return!result}};classListProto.toString=function(){return this.join(" ")};if(objCtr.defineProperty){var classListPropDesc={get:classListGetter,enumerable:!0,configurable:!0};try{objCtr.defineProperty(elemCtrProto,classListProp,classListPropDesc)}catch(ex){if(ex.number===-0x7FF5EC54){classListPropDesc.enumerable=!1;objCtr.defineProperty(elemCtrProto,classListProp,classListPropDesc)}}}else if(objCtr[protoProp].__defineGetter__){elemCtrProto.__defineGetter__(classListProp,classListGetter)}}(self))}else{(function(){"use strict";var testElement=document.createElement("_");testElement.classList.add("c1","c2");if(!testElement.classList.contains("c2")){var createMethod=function(method){var original=DOMTokenList.prototype[method];DOMTokenList.prototype[method]=function(token){var i,len=arguments.length;for(i=0;i<len;i++){token=arguments[i];original.call(this,token)}}};createMethod('add');createMethod('remove')}
testElement.classList.toggle("c3",!1);if(testElement.classList.contains("c3")){var _toggle=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(token,force){if(1 in arguments&&!this.contains(token)===!force){return force}else{return _toggle.call(this,token)}}}
testElement=null}())}}},{}],140:[function(require,module,exports){require('../Date/now');(function(){if("performance" in window==!1){window.performance={}}
if("now" in window.performance==!1){var nowOffset=Date.now();if(performance.timing&&performance.timing.navigationStart){nowOffset=performance.timing.navigationStart}
window.performance.now=function now(){return Date.now()-nowOffset}}})()},{"../Date/now":138}],141:[function(require,module,exports){'use strict';var eventTypeAvailable=require('./utils/eventTypeAvailable');var camelCasedEventTypes=require('./shared/camelCasedEventTypes');var windowFallbackEventTypes=require('./shared/windowFallbackEventTypes');var prefixHelper=require('./shared/prefixHelper');var cache={};module.exports=function getEventType(type,tagName){var prefixedType;var tagNameCache;var i;tagName=tagName||'div';type=type.toLowerCase();if(!(tagName in cache)){cache[tagName]={}}
tagNameCache=cache[tagName];if(type in tagNameCache){return tagNameCache[type]}
if(eventTypeAvailable(type,tagName)){return tagNameCache[type]=type}
if(type in camelCasedEventTypes){for(i=0;i<camelCasedEventTypes[type].length;i++){prefixedType=camelCasedEventTypes[type][i];if(eventTypeAvailable(prefixedType.toLowerCase(),tagName)){return tagNameCache[type]=prefixedType}}}
for(i=0;i<prefixHelper.evt.length;i++){prefixedType=prefixHelper.evt[i]+type;if(eventTypeAvailable(prefixedType,tagName)){prefixHelper.reduce(i);return tagNameCache[type]=prefixedType}}
if(tagName!=='window'&&windowFallbackEventTypes.indexOf(type)){return tagNameCache[type]=getEventType(type,'window')}
return tagNameCache[type]=!1}},{"./shared/camelCasedEventTypes":142,"./shared/prefixHelper":143,"./shared/windowFallbackEventTypes":144,"./utils/eventTypeAvailable":145}],142:[function(require,module,exports){'use strict';module.exports={transitionend:['webkitTransitionEnd','MSTransitionEnd'],animationstart:['webkitAnimationStart','MSAnimationStart'],animationend:['webkitAnimationEnd','MSAnimationEnd'],animationiteration:['webkitAnimationIteration','MSAnimationIteration'],fullscreenchange:['MSFullscreenChange'],fullscreenerror:['MSFullscreenError']}},{}],143:[function(require,module,exports){'use strict';var CSS_PREFIXES=['-webkit-','-moz-','-ms-'];var DOM_PREFIXES=['Webkit','Moz','ms'];var EVT_PREFIXES=['webkit','moz','ms'];var PrefixeHelper=function(){this.initialize()};var proto=PrefixeHelper.prototype;proto.initialize=function(){this.reduced=!1;this.css=CSS_PREFIXES;this.dom=DOM_PREFIXES;this.evt=EVT_PREFIXES};proto.reduce=function(index){if(!this.reduced){this.reduced=!0;this.css=[this.css[index]];this.dom=[this.dom[index]];this.evt=[this.evt[index]]}};module.exports=new PrefixeHelper()},{}],144:[function(require,module,exports){'use strict';module.exports=['transitionend','animationstart','animationend','animationiteration',]},{}],145:[function(require,module,exports){'use strict';var testElements={'window':window,'document':document};module.exports=function eventTypeAvailable(type,tagName){var el;type='on'+type;if(!(tagName in testElements)){testElements[tagName]=document.createElement(tagName)}
el=testElements[tagName];if(type in el){return!0}
if('setAttribute' in el){el.setAttribute(type,'return;');return(typeof el[type]==='function')}
return!1}},{}],146:[function(require,module,exports){'use strict';var SharedInstance=require('@marcom/ac-shared-instance').SharedInstance;var sharedInstanceName='ac-raf-emitter-id-generator:sharedRAFEmitterIDGeneratorInstance',sharedInstanceVersion='1.0.3';var RAFEmitterIDGenerator=function(){this._currentID=0}
RAFEmitterIDGenerator.prototype.getNewID=function(){this._currentID++;return'raf:'+this._currentID};module.exports=SharedInstance.share(sharedInstanceName,sharedInstanceVersion,RAFEmitterIDGenerator)},{"@marcom/ac-shared-instance":163}],147:[function(require,module,exports){"use strict";var proto;var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var sharedRAFExecutorInstance=require('@marcom/ac-raf-executor/sharedRAFExecutorInstance');var sharedRAFEmitterIDGeneratorInstance=require('@marcom/ac-raf-emitter-id-generator/sharedRAFEmitterIDGeneratorInstance');function RAFEmitter(options){options=options||{};EventEmitterMicro.call(this);this.id=sharedRAFEmitterIDGeneratorInstance.getNewID();this.executor=options.executor||sharedRAFExecutorInstance;this._reset();this._willRun=!1;this._didDestroy=!1}
proto=RAFEmitter.prototype=Object.create(EventEmitterMicro.prototype);proto.run=function(){if(!this._willRun){this._willRun=!0}
return this._subscribe()};proto.cancel=function(){this._unsubscribe();if(this._willRun){this._willRun=!1}
this._reset()};proto.destroy=function(){var didCancel=this.willRun();this.cancel();this.executor=null;EventEmitterMicro.prototype.destroy.call(this);this._didDestroy=!0;return didCancel};proto.willRun=function(){return this._willRun};proto.isRunning=function(){return this._isRunning};proto._subscribe=function(){return this.executor.subscribe(this)};proto._unsubscribe=function(){return this.executor.unsubscribe(this)};proto._onAnimationFrameStart=function(data){this._isRunning=!0;this._willRun=!1;if(!this._didEmitFrameData){this._didEmitFrameData=!0;this.trigger('start',data)}};proto._onAnimationFrameEnd=function(data){if(!this._willRun){this.trigger('stop',data);this._reset()}};proto._reset=function(){this._didEmitFrameData=!1;this._isRunning=!1};module.exports=RAFEmitter},{"@marcom/ac-event-emitter-micro":89,"@marcom/ac-raf-emitter-id-generator/sharedRAFEmitterIDGeneratorInstance":146,"@marcom/ac-raf-executor/sharedRAFExecutorInstance":156}],148:[function(require,module,exports){'use strict';var SingleCallRAFEmitter=require('./SingleCallRAFEmitter');var RAFInterface=function(evt){this.rafEmitter=new SingleCallRAFEmitter();this.rafEmitter.on(evt,this._onRAFExecuted.bind(this));this.requestAnimationFrame=this.requestAnimationFrame.bind(this);this.cancelAnimationFrame=this.cancelAnimationFrame.bind(this);this._frameCallbacks=[];this._nextFrameCallbacks=[];this._currentFrameID=-1;this._cancelFrameIdx=-1;this._frameCallbackLength=0;this._nextFrameCallbacksLength=0;this._frameCallbackIteration=0};var proto=RAFInterface.prototype;proto.requestAnimationFrame=function(rafCallback){this._currentFrameID=this.rafEmitter.run();this._nextFrameCallbacks.push(this._currentFrameID,rafCallback);this._nextFrameCallbacksLength+=2;return this._currentFrameID};proto.cancelAnimationFrame=function(id){this._cancelFrameIdx=this._nextFrameCallbacks.indexOf(id);if(this._cancelFrameIdx===-1){return}
this._nextFrameCallbacks.splice(this._cancelFrameIdx,2);this._nextFrameCallbacksLength-=2;if(this._nextFrameCallbacksLength===0){this.rafEmitter.cancel()}};proto._onRAFExecuted=function(e){this._frameCallbacks=this._nextFrameCallbacks;this._frameCallbackLength=this._nextFrameCallbacksLength;this._nextFrameCallbacks=[];this._nextFrameCallbacksLength=0;for(this._frameCallbackIteration=0;this._frameCallbackIteration<this._frameCallbackLength;this._frameCallbackIteration+=2){this._frameCallbacks[this._frameCallbackIteration+1](e.time,e)}};module.exports=RAFInterface},{"./SingleCallRAFEmitter":150}],149:[function(require,module,exports){'use strict';var RAFInterface=require('./RAFInterface');var RAFInterfaceController=function(){this.events={}};var proto=RAFInterfaceController.prototype;proto.requestAnimationFrame=function(evt){if(!this.events[evt]){this.events[evt]=new RAFInterface(evt)}
return this.events[evt].requestAnimationFrame};proto.cancelAnimationFrame=function(evt){if(!this.events[evt]){this.events[evt]=new RAFInterface(evt)}
return this.events[evt].cancelAnimationFrame};module.exports=new RAFInterfaceController()},{"./RAFInterface":148}],150:[function(require,module,exports){'use strict';var RAFEmitter=require('./RAFEmitter');var SingleCallRAFEmitter=function(options){RAFEmitter.call(this,options)};var proto=SingleCallRAFEmitter.prototype=Object.create(RAFEmitter.prototype);proto._subscribe=function(){return this.executor.subscribe(this,!0)};module.exports=SingleCallRAFEmitter},{"./RAFEmitter":147}],151:[function(require,module,exports){'use strict';var RAFInterfaceController=require('./RAFInterfaceController');module.exports=RAFInterfaceController.cancelAnimationFrame('draw')},{"./RAFInterfaceController":149}],152:[function(require,module,exports){'use strict';var RAFInterfaceController=require('./RAFInterfaceController');module.exports=RAFInterfaceController.cancelAnimationFrame('update')},{"./RAFInterfaceController":149}],153:[function(require,module,exports){'use strict';var RAFInterfaceController=require('./RAFInterfaceController');module.exports=RAFInterfaceController.requestAnimationFrame('draw')},{"./RAFInterfaceController":149}],154:[function(require,module,exports){'use strict';var RAFInterfaceController=require('./RAFInterfaceController');module.exports=RAFInterfaceController.requestAnimationFrame('update')},{"./RAFInterfaceController":149}],155:[function(require,module,exports){"use strict";require('@marcom/ac-polyfills/performance/now');var proto;function RAFExecutor(options){options=options||{};this._reset();this._willRun=!1;this._totalSubscribeCount=-1;this._requestAnimationFrame=window.requestAnimationFrame;this._cancelAnimationFrame=window.cancelAnimationFrame;this._boundOnAnimationFrame=this._onAnimationFrame.bind(this);this._boundOnExternalAnimationFrame=this._onExternalAnimationFrame.bind(this)}
proto=RAFExecutor.prototype;proto.subscribe=function(rafEmitter,shouldPrepend){this._totalSubscribeCount++;if(!this._nextFrameSubscribers[rafEmitter.id]){if(shouldPrepend){this._nextFrameSubscribersOrder.unshift(rafEmitter.id)}else{this._nextFrameSubscribersOrder.push(rafEmitter.id)}
this._nextFrameSubscribers[rafEmitter.id]=rafEmitter;this._nextFrameSubscriberArrayLength++;this._nextFrameSubscriberCount++;this._run()}
return this._totalSubscribeCount};proto.unsubscribe=function(rafEmitter){if(!this._nextFrameSubscribers[rafEmitter.id]){return!1}
this._nextFrameSubscribers[rafEmitter.id]=null;this._nextFrameSubscriberCount--;if(this._nextFrameSubscriberCount===0){this._cancel()}
return!0};proto.trigger=function(evtName,data){var i;for(i=0;i<this._subscriberArrayLength;i++){if(this._subscribers[this._subscribersOrder[i]]!==null&&this._subscribers[this._subscribersOrder[i]]._didDestroy===!1){this._subscribers[this._subscribersOrder[i]].trigger(evtName,data)}}};proto.destroy=function(){var didCancel=this._cancel();this._subscribers=null;this._subscribersOrder=null;this._nextFrameSubscribers=null;this._nextFrameSubscribersOrder=null;this._rafData=null;this._boundOnAnimationFrame=null;this._onExternalAnimationFrame=null;return didCancel};proto.useExternalAnimationFrame=function(shouldUseExternalAnimationFrame){if(typeof shouldUseExternalAnimationFrame!=='boolean'){return}
var wasUsingExternalAnimationFrame=this._isUsingExternalAnimationFrame;if(shouldUseExternalAnimationFrame&&this._animationFrame){this._cancelAnimationFrame.call(window,this._animationFrame);this._animationFrame=null}
if(this._willRun&&!shouldUseExternalAnimationFrame&&!this._animationFrame){this._animationFrame=this._requestAnimationFrame.call(window,this._boundOnAnimationFrame)}
this._isUsingExternalAnimationFrame=shouldUseExternalAnimationFrame;if(shouldUseExternalAnimationFrame){return this._boundOnExternalAnimationFrame}
return wasUsingExternalAnimationFrame||!1};proto._run=function(){if(!this._willRun){this._willRun=!0;if(this.lastFrameTime===0){this.lastFrameTime=performance.now()}
this._animationFrameActive=!0;if(!this._isUsingExternalAnimationFrame){this._animationFrame=this._requestAnimationFrame.call(window,this._boundOnAnimationFrame)}
return!0}};proto._cancel=function(){var result=!1;if(this._animationFrameActive){if(this._animationFrame){this._cancelAnimationFrame.call(window,this._animationFrame);this._animationFrame=null}
this._animationFrameActive=!1;this._willRun=!1;result=!0}
if(!this._isRunning){this._reset()}
return result};proto._onSubscribersAnimationFrameStart=function(data){var i;for(i=0;i<this._subscriberArrayLength;i++){if(this._subscribers[this._subscribersOrder[i]]!==null&&this._subscribers[this._subscribersOrder[i]]._didDestroy===!1){this._subscribers[this._subscribersOrder[i]]._onAnimationFrameStart(data)}}};proto._onSubscribersAnimationFrameEnd=function(data){var i;for(i=0;i<this._subscriberArrayLength;i++){if(this._subscribers[this._subscribersOrder[i]]!==null&&this._subscribers[this._subscribersOrder[i]]._didDestroy===!1){this._subscribers[this._subscribersOrder[i]]._onAnimationFrameEnd(data)}}};proto._onAnimationFrame=function(time){this._subscribers=this._nextFrameSubscribers;this._subscribersOrder=this._nextFrameSubscribersOrder;this._subscriberArrayLength=this._nextFrameSubscriberArrayLength;this._subscriberCount=this._nextFrameSubscriberCount;this._nextFrameSubscribers={};this._nextFrameSubscribersOrder=[];this._nextFrameSubscriberArrayLength=0;this._nextFrameSubscriberCount=0;this._isRunning=!0;this._willRun=!1;this._didRequestNextRAF=!1;this._rafData.delta=time-this.lastFrameTime;this.lastFrameTime=time;this._rafData.fps=0;if(this._rafData.delta>=1000){this._rafData.delta=0}
if(this._rafData.delta!==0){this._rafData.fps=1000/this._rafData.delta}
this._rafData.time=time;this._rafData.naturalFps=this._rafData.fps;this._rafData.timeNow=Date.now();this._onSubscribersAnimationFrameStart(this._rafData);this.trigger('update',this._rafData);this.trigger('external',this._rafData);this.trigger('draw',this._rafData);this._onSubscribersAnimationFrameEnd(this._rafData);if(!this._willRun){this._reset()}};proto._onExternalAnimationFrame=function(time){if(!this._isUsingExternalAnimationFrame){return}
this._onAnimationFrame(time)};proto._reset=function(){this._rafData={time:0,delta:0,fps:0,naturalFps:0,timeNow:0};this._subscribers={};this._subscribersOrder=[];this._subscriberArrayLength=0;this._subscriberCount=0;this._nextFrameSubscribers={};this._nextFrameSubscribersOrder=[];this._nextFrameSubscriberArrayLength=0;this._nextFrameSubscriberCount=0;this._didEmitFrameData=!1;this._animationFrame=null;this._animationFrameActive=!1;this._isRunning=!1;this._shouldReset=!1;this.lastFrameTime=0};module.exports=RAFExecutor},{"@marcom/ac-polyfills/performance/now":140}],156:[function(require,module,exports){'use strict';var SharedInstance=require('@marcom/ac-shared-instance').SharedInstance;var sharedInstanceName='ac-raf-executor:sharedRAFExecutorInstance',sharedInstanceVersion='2.0.1';var RAFExecutor=require('./RAFExecutor');module.exports=SharedInstance.share(sharedInstanceName,sharedInstanceVersion,RAFExecutor)},{"./RAFExecutor":155,"@marcom/ac-shared-instance":163}],157:[function(require,module,exports){'use strict';module.exports={Router:require('./ac-router/Router'),History:require('./ac-router/History'),Routes:require('@marcom/ac-routes').Routes,Route:require('@marcom/ac-routes').Route}},{"./ac-router/History":158,"./ac-router/Router":159,"@marcom/ac-routes":160}],158:[function(require,module,exports){'use strict';var create=require('@marcom/ac-object').create;var DomEvents=require('@marcom/ac-dom-events');var EventEmitter=require('@marcom/ac-event-emitter').EventEmitter;function History(options){options=options||{};this.history=window.history;this.rootStripper=/^\/+|\/+$/g;this.root=options.root||'/';this.root=('/'+this.root+'/').replace(this.rootStripper,'https://www.apple.com/');var resolveInitialHash=typeof options.resolveInitialHash!=='boolean'?!0:options.resolveInitialHash;this._pushState=typeof options.pushState!=='boolean'?!0:options.pushState;this._hashChange=options.hashChange||!1;this._setUpdateVars(resolveInitialHash);if(options.autoStart){this.start()}}
var proto=History.prototype=create(EventEmitter.prototype);proto._isRoot=function(fragment){return('/'+fragment+'/').replace(this.rootStripper,'https://www.apple.com/')===this.root};proto._isPushStateSupported=function(){return(this.history&&this.history.pushState)};proto._isHashChangeSupported=function(){return('onhashchange' in window)};proto._setUpdateVars=function(resolveInitialHash){if(this._pushState&&this._isPushStateSupported()){if(resolveInitialHash&&this._hashChange&&window.location.href.indexOf('#')!==-1){this.history.pushState({},document.title,window.location.href.replace('#',''))}
this._hashChange=!1}
else{if(resolveInitialHash&&this._pushState&&this._hashChange&&window.location.href.indexOf('#')<0){if(!window.location.origin){window.location.origin=window.location.protocol+"//"+window.location.hostname;window.location.origin+=(window.location.port?':'+window.location.port:'')}
var fragment=window.location.href.substr(window.location.origin.length+this.root.length);if(fragment.length){window.location=window.location.origin+this.root+'#'+fragment;return}}
if(this._hashChange&&!this._isHashChangeSupported()){this._interval=50;this._iframe=document.createElement('<iframe src="javascript:0" tabindex="-1" style="display:none;">');this._iframe=document.body.appendChild(this._iframe).contentWindow;this._iframe.document.open().close()}
this._pushState=!1}};proto._checkUrl=function(){var iframeHash=this._iframe.location.hash.substr(1);if(iframeHash.length===0){iframeHash='/'}
if(this.fragment()!==iframeHash){window.location.hash='#'+iframeHash;this._ignoreHashChange=!1;this._handleHashChange()}};proto._handlePopState=function(evt){this.trigger('popstate',{fragment:this.fragment()})};proto._handleHashChange=function(evt){if(this._ignoreHashChange){this._ignoreHashChange=!1;return}
this.trigger('popstate',{fragment:this.fragment()})};proto.canUpdate=function(){return this._pushState||this._hashChange};proto.start=function(){if(!this.started&&(this._pushState||this._hashChange)){this.started=!0;if(this._pushState){this._handlePopState=this._handlePopState.bind(this);DomEvents.addEventListener(window,'popstate',this._handlePopState)}
else if(this._hashChange){if(this._isHashChangeSupported()){this._handleHashChange=this._handleHashChange.bind(this);DomEvents.addEventListener(window,'hashchange',this._handleHashChange)}
else{this._iframe.location.hash=this.fragment();this._checkUrl=this._checkUrl.bind(this);this._checkUrlInterval=setInterval(this._checkUrl,this._interval)}}}
return this.started||!1};proto.stop=function(){if(this.started){this.started=!1;if(this._pushState){DomEvents.removeEventListener(window,'popstate',this._handlePopState)}
else if(this._hashChange){if(this._isHashChangeSupported()){DomEvents.removeEventListener(window,'hashchange',this._handleHashChange)}
else if(this._checkUrlInterval){clearInterval(this._checkUrlInterval);this._checkUrlInterval=null}}}};proto.navigate=function(fragment,options){if(!this.started||!this.canUpdate()){return!1}
options=options||{};var url=((this._isRoot(fragment)?'':this.root)+fragment).replace(/([^:])(\/\/)/g,'https://www.apple.com/jobs/us/$1/');if(this._pushState){this.history.pushState(options,document.title,url)}
else if(this._hashChange){this._ignoreHashChange=!0;window.location.hash='#'+fragment;if(!this._isHashChangeSupported()){this._iframe.document.open().close();this._iframe.location.hash='#'+fragment}}
return!0};proto.fragment=function(){var fragment='';if(this._pushState){fragment=(window.location.pathname).substr(this.root.length)}
else if(this._hashChange){fragment=window.location.hash.substr(1)}
return fragment===''?'/':fragment};module.exports=History},{"@marcom/ac-dom-events":57,"@marcom/ac-event-emitter":91,"@marcom/ac-object":122}],159:[function(require,module,exports){'use strict';var create=require('@marcom/ac-object').create;var DOMEmitter=require('@marcom/ac-dom-emitter').DOMEmitter;var History=require('./History');var Route=require('@marcom/ac-routes').Route;var Routes=require('@marcom/ac-routes').Routes;function Router(options){options=options||{};this._intercept=options.intercept||'[data-route]';this._interceptAttribute=options.attribute||'href';this._handleTrigger=this._handleTrigger.bind(this);this.intercept(this._intercept);this.history=options.history||new History({root:options.root,autoStart:options.autoStart,pushState:options.pushState,hashChange:options.hashChange,resolveInitialHash:options.resolveInitialHash});Routes.call(this,options.routes);if(options.autoStart){if(!this.history.started){this.history.start()}
this.start()}}
var proto=Router.prototype=create(Routes.prototype);proto._handleTrigger=function(evt){if(!this.started){return}
var destination=evt.target.getAttribute(this._interceptAttribute);if(destination){if(/^(http|https):\/\/+/.exec(destination)&&this._interceptAttribute==='href'){destination=destination.substr(destination.indexOf(this.history.root)+this.history.root.length)||'/'}
if(this.navigate(destination)){evt.preventDefault()}}};proto._handlePopstate=function(evt){this.navigate(evt.fragment,!0)};proto.start=function(){if(!this.started){this.started=!0;this.history.start();this._handlePopstate=this._handlePopstate.bind(this);this.history.on('popstate',this._handlePopstate);this.navigate(this.history.fragment(),!0)}};proto.stop=function(){if(this.started){this.started=!1;this.history.stop();this.history.off('popstate',this._handlePopstate)}};proto.navigate=function(path,silent){if(this.history.fragment()===path&&!silent){return this.history.canUpdate()}
if(path&&!silent){if(!this.history.navigate(path)){return!1}}
this.match(path);return!0};proto.intercept=function(elementSelector,containerElement){var domEmitter=new DOMEmitter(containerElement||document.body);domEmitter.on('click',elementSelector,this._handleTrigger)};module.exports=Router},{"./History":158,"@marcom/ac-dom-emitter":52,"@marcom/ac-object":122,"@marcom/ac-routes":160}],160:[function(require,module,exports){'use strict';module.exports={Routes:require('./ac-routes/Routes'),Route:require('./ac-routes/Route')}},{"./ac-routes/Route":161,"./ac-routes/Routes":162}],161:[function(require,module,exports){'use strict';function Route(path,callback,context,greedy,priority){this.path=path;this.callback=callback;this.context=context;this.greedy=greedy||!1;this.priority=priority||0;if(typeof this.priority!=='number'){throw new Error('Priority must be a Number.')}
this.identifierPattern='([a-zA-Z0-9\\-\\_]+)';this.tokensRe=new RegExp(':'+this.identifierPattern,'g');this.matcher=this._createRouteMatcher(path)}
var proto=Route.prototype;proto._createRouteMatcher=function(path){if(path&&path.exec){return{pattern:path}}
else if(path==='https://www.apple.com/'){return{pattern:/^\/$/}}
else if(typeof path!=='string'){throw new Error('path must be either a string or regex')}
var routeTokens=this._extractRouteTokens(path);var paramReString=path.replace(this.tokensRe,this.identifierPattern);var paramRe=new RegExp(paramReString,'g');return{pattern:paramRe,routeTokens:routeTokens}};proto._extractRouteTokens=function(routePattern){var routeTokenPattern=routePattern.replace(this.tokensRe,':'+this.identifierPattern);var routeTokenRe=new RegExp(routeTokenPattern,'g');var routeTokens=routeTokenRe.exec(routePattern);if(routeTokens&&routeTokens.length>1){routeTokens=routeTokens.slice(1)}else{routeTokens=null}
return routeTokens};proto.match=function(path){this.matcher.pattern.lastIndex=0;var matches=this.matcher.pattern.exec(path);if(matches){var params=(matches.length)?matches.slice(1):[];var callback=this.callback;if(callback&&typeof callback==='function'){callback.apply(this.context||this,params);return!0}}
return!1};module.exports=Route},{}],162:[function(require,module,exports){'use strict';var Route=require('./Route');function Routes(routes){this._routes={};if(routes){this.addRoutes(routes)}}
var proto=Routes.prototype;proto._getIndex=function(path,callback,context){if(this._routes[path]!==undefined){var i=this._routes[path].length;while(--i>-1){if(this._routes[path][i].callback===callback&&this._routes[path][i].context===context){return i}}}
return-1};proto.match=function(path){var routeString,i;for(routeString in this._routes){i=this._routes[routeString].length;while(--i>-1){if(this._routes[routeString][i].match(path)&&this._routes[routeString][i].greedy){break}}}};proto.add=function(route){if(this._routes[route.path]===undefined){this._routes[route.path]=[route]}
else if(!this.get(route.path,route.callback,route.context)){var i,len=this._routes[route.path].length;if(len>0){for(i=0;i<len;++i){if(this._routes[route.path][i].priority>route.priority){this._routes[route.path].splice(i,0,route);return route}}}
this._routes[route.path].push(route)}
return route};proto.remove=function(route){var i=this._getIndex(route.path,route.callback,route.context);if(i>-1){this._routes[route.path].splice(i,1);return route}
return!1};proto.get=function(path,callback,context){var i=this._getIndex(path,callback,context);if(i>-1){return this._routes[path][i]}
return!1};proto.createRoute=function(path,callback,context,greedy,priority){var route=new Route(path,callback,context,greedy,priority);this.add(route);return route};proto.addRoutes=function(routes){if(routes instanceof Array){var i,route,len=routes.length;for(i=0;i<len;++i){route=routes[i];if(route&&typeof route==='object'){this.add(route)}}}
else{throw new Error('routes must be an Array.')}};proto.removeRoutes=function(routes){if(routes instanceof Array){var i,route,len=routes.length;for(i=0;i<len;++i){route=routes[i];if(route&&typeof route==='object'){this.remove(route)}}}
else{throw new Error('routes must be an Array.')}};proto.getRoutes=function(path){if(this._routes[path]===undefined){return[]}
return this._routes[path]};module.exports=Routes},{"./Route":161}],163:[function(require,module,exports){'use strict';module.exports={SharedInstance:require('./ac-shared-instance/SharedInstance')}},{"./ac-shared-instance/SharedInstance":164}],164:[function(require,module,exports){'use strict';var instanceScope=window,instanceSharedInstanceNamespace='AC',instanceExportKey='SharedInstance',instanceTarget=instanceScope[instanceSharedInstanceNamespace];var SharedInstance=(function(){var registry={};return{get:function(name,version){var module=null;if(registry[name]&&registry[name][version]){module=registry[name][version]}
return module},set:function(name,version,Module){if(!registry[name]){registry[name]={}}
if(typeof Module==='function'){registry[name][version]=new Module()}else{registry[name][version]=Module}
return registry[name][version]},share:function(name,version,Module){var module=this.get(name,version);if(!module){module=this.set(name,version,Module)}
return module},remove:function(name,version){var versionType=typeof version;if(versionType==='string'||versionType==='number'){if(!registry[name]||!registry[name][version]){return}
registry[name][version]=null;return}
if(registry[name]){registry[name]=null}}}}());if(!instanceTarget){instanceTarget=instanceScope[instanceSharedInstanceNamespace]={}}
if(!instanceTarget[instanceExportKey]){instanceTarget[instanceExportKey]=SharedInstance}
module.exports=instanceTarget[instanceExportKey]},{}],165:[function(require,module,exports){'use strict';const EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;const domMetrics=require('@marcom/dom-metrics');const Keyboard=require('@marcom/ac-keyboard/Keyboard');const TEMPLATE=require('https://www.apple.com/jobs/us/templates/slider.html');const ARROW_LEFT={num:37,string:'ArrowLeft'};const ARROW_UP={num:38,string:'ArrowUp'};const ARROW_RIGHT={num:39,string:'ArrowRight'};const ARROW_DOWN={num:40,string:'ArrowDown'};const ARROW_KEYS=[ARROW_LEFT,ARROW_RIGHT,ARROW_DOWN,ARROW_RIGHT];const keyCodeFromEvent=function(evt){if(evt.which){return evt.which}
var string=(evt.key)?evt.key:evt.code;var i=0;var len=ARROW_KEYS.length;for(;i<len;i++){if(ARROW_KEYS[i].string===string){return ARROW_KEYS[i].num}}
return-1};const DEFAULT_OPTIONS={min:0,max:1,step:1,value:0,orientation:'horizontal',renderedPosition:!1,template:TEMPLATE,keyboardMaxStepPercentage:0.05,keyboardStepMultiplier:1.25,containerClass:'ac-slider-container',grabbedClass:'ac-slider-grabbed'};const VALID_KEYS=Object.keys(DEFAULT_OPTIONS);const SliderView=function(el,options){this.options=Object.assign({},DEFAULT_OPTIONS,options);this.model=Object.create(this.options);this.el=el;var keyboardContext=(this.options.keyboardContext!==undefined)?this.options.keyboardContext:this.el;if(keyboardContext!==null){this._keyboard=new Keyboard(keyboardContext);this._keyDown={}}
el.classList.add(this.model.containerClass);el.innerHTML=this.model.template;EventEmitterMicro.call(this);this._initialize()};SliderView.prototype=Object.create(EventEmitterMicro.prototype);const proto=SliderView.prototype;proto._addGrabClass=function(){this.el.classList.add(this.model.grabbedClass)};proto._removeGrabClass=function(){this.el.classList.remove(this.model.grabbedClass)};proto._addEventListeners=function(){this._addEventListener(this.el,'mousedown',this._onMouseDown);this._addEventListener(this.el,'touchstart',this._onTouchStart);this._addEventListener(this.el,'mouseover',this._onMouseOver);this._addEventListener(this.el,'mouseleave',this._onMouseLeave);if(this._keyboard){if(this.model.orientation==='horizontal'){this._keyboard.onDown(ARROW_RIGHT.num,this.stepUp);this._keyboard.onDown(ARROW_LEFT.num,this.stepDown)}else{this._keyboard.onDown(ARROW_DOWN.num,this.stepDown);this._keyboard.onDown(ARROW_UP.num,this.stepUp)}}};proto._addEventListener=function(el,evtName,callback,opts){el.addEventListener(evtName,callback,opts)};proto._bindMethods=function(){this._addGrabClass=this._addGrabClass.bind(this);this._removeGrabClass=this._removeGrabClass.bind(this);this.stepDown=this.stepDown.bind(this);this.stepUp=this.stepUp.bind(this);this._triggerRelease=this._triggerRelease.bind(this);this._preventDefault=this._preventDefault.bind(this);this._onMouseDown=this._bindMethod(this._onMouseDown,this);this._onTouchStart=this._bindMethod(this._onTouchStart,this);this._onMouseOver=this._bindMethod(this._onMouseOver,this);this._onMouseLeave=this._bindMethod(this._onMouseLeave,this);this._onTouchEnd=this._bindMethod(this._onTouchEnd,this);this._onMouseUp=this._bindMethod(this._onMouseUp,this);this._onMouseMove=this._bindMethod(this._onMouseMove,this);this._onTouchMove=this._bindMethod(this._onTouchMove,this)};proto._bindMethod=function(method,context){return method.bind(context)};proto._correctValueMinMax=function(value,min,max){if(value>max){value=max}
if(value<min){value=min}
return value};proto._calculateStepsToValue=function(value,min){return Math.abs(value-min)};proto._calculateMaxSteps=function(min,max){return Math.abs(max-min)};proto._calculateStepsEqualToPercentage=function(percentage,numberOfSteps){return(percentage/100)*numberOfSteps};proto._calculateNextStepInRange=function(value,min,max,step){var stepsInRange=this._calculateMaxSteps(min,max);var stepsToValue=this._calculateStepsToValue(value,min);var stepToGreaterValue=min+(Math.floor(stepsInRange/step)*step);value=Math.min(stepToGreaterValue,min+Math.round(stepsToValue/step)*step);return value};proto._dispatchEvent=function(el,evtName){el.dispatchEvent(new CustomEvent(evtName))};proto.disableUserControls=function(){this._removeEventListeners()};proto.enableUserControls=function(){this._addEventListeners()};proto._getNextValue=function(value,min,max,step){value=this._correctValueMinMax(value,min,max);if(step!=='auto'){value=this._calculateNextStepInRange(value,min,max,step)}
return value};proto.getOrientation=function(){return this.model.orientation};proto.getValue=function(){return this.model.value};proto.getMin=function(){return this.model.min};proto.getMax=function(){return this.model.max};proto.getStep=function(){return this.model.step};proto.getClientXValue=function(e,offsetEl){var clientX=this._getClientXFromEvent(e);var thumbDimensions=(offsetEl!==null)?domMetrics.getDimensions(offsetEl||this.thumbElement):{width:0,height:0};var trackDimensions=domMetrics.getDimensions(this.runnableTrackElement);var left=clientX-this.runnableTrackElement.getBoundingClientRect().left-Math.round(thumbDimensions.width/2);var usableTrack=trackDimensions.width-thumbDimensions.width;var offsetPercentage=left/(usableTrack)*100;var maxSteps=this._calculateMaxSteps(this.getMin(),this.getMax());var stepsEqualToPercentage=this._calculateStepsEqualToPercentage(offsetPercentage,maxSteps);return this.getMin()+stepsEqualToPercentage};proto.getClientYValue=function(e){var clientY=this._getClientYFromEvent(e);var thumbDimensions=domMetrics.getDimensions(this.thumbElement);var trackDimensions=domMetrics.getDimensions(this.runnableTrackElement);var trackPosition=domMetrics.getViewportPosition(this.runnableTrackElement,this.model.renderedPosition);var usableTrack=trackDimensions.height-thumbDimensions.height;var top=usableTrack-(clientY-trackPosition.top-(thumbDimensions.height/2));var offsetPercentage=top/(trackDimensions.height-thumbDimensions.height)*100;var maxSteps=this._calculateMaxSteps(this.model.min,this.model.max);var stepsEqualToPercentage=this._calculateStepsEqualToPercentage(offsetPercentage,maxSteps);return this.model.min+stepsEqualToPercentage};proto.getClientValue=function(e){e=e.originalEvent||e;var offsetValue;if(this.model.orientation==='horizontal'){offsetValue=this.getClientXValue(e)}else{offsetValue=this.getClientYValue(e)}
return offsetValue};proto._getClientXFromEvent=function(e){return e.touches?e.touches[0].clientX:e.clientX};proto._getClientYFromEvent=function(e){return e.touches?e.touches[0].clientY:e.clientY};proto._initialize=function(){this._setNodeReferences();this.setValue(this.model.value);this._bindMethods();this._addEventListeners()};proto._onMouseLeave=function(){this._preventDocumentMouseUpDispatch=!1};proto._onMouseDown=function(e){this._addGrabClass();this._addEventListener(document,'mouseup',this._onMouseUp);this._addEventListener(document,'mousemove',this._onMouseMove);var clientValue=this.getClientValue(e);this.trigger('grab',this.getValue());this.setValue(clientValue)};proto._onMouseUp=function(){this._removeGrabClass();this._removeEventListener(document,'mouseup',this._onMouseUp);this._removeEventListener(document,'mousemove',this._onMouseMove);this.trigger('release',this.getValue());if(!this._preventDocumentMouseUpDispatch){this._dispatchEvent(this.el,'mouseup')}};proto._onMouseOver=function(){this._preventDocumentMouseUpDispatch=!0};proto._onTouchEnd=function(){this._removeGrabClass();this._removeEventListener(document,'touchend',this._onTouchEnd);this._removeEventListener(document,'touchmove',this._onTouchMove);this.trigger('release',this.getValue());if(!this._preventDocumentMouseUpDispatch){this._dispatchEvent(this.el,'touchend')}};proto._onTouchStart=function(e){this._addGrabClass();var clientValue=this.getClientValue(e);this._addEventListener(document,'touchend',this._onTouchEnd);this._addEventListener(document,'touchmove',this._onTouchMove,{passive:!1});this.trigger('grab',this.getValue());this.setValue(clientValue)};proto._onMouseMove=function(e){var clientValue=this.getClientValue(e);this.setValue(clientValue)};proto._onTouchMove=function(e){if(e.preventDefault){e.preventDefault()}
var clientValue=this.getClientValue(e);this.setValue(clientValue)};proto._getElementOrientationOffsetValue=function(el,orientation){if(orientation==='horizontal'){return domMetrics.getDimensions(el).width}
return domMetrics.getDimensions(el).height};proto._getAvailableRunnableTrack=function(runnableTrackOffsetValue,orientation){var thumbOffsetValue=this._getElementOrientationOffsetValue(this.thumbElement,orientation);return runnableTrackOffsetValue-thumbOffsetValue};proto._getPercentageByValue=function(value,valueToFindPercentageOf){value=this._calculateStepsToValue(value,this.getMin());valueToFindPercentageOf=this._calculateMaxSteps(this.getMin(),this.getMax());return(value/valueToFindPercentageOf)*100};proto._getPercentageOfRunnableTrack=function(value){var orientation=this.getOrientation();var runnableTrackOffsetValue=this._getElementOrientationOffsetValue(this.runnableTrackElement,orientation);var usableTrackOffsetValue=this._getAvailableRunnableTrack(runnableTrackOffsetValue,orientation);var percentageOfMax=this._getPercentageByValue(value,this.getMax());var valueInPx=(percentageOfMax/100)*usableTrackOffsetValue;return(valueInPx/runnableTrackOffsetValue)*100};proto._onChange=function(value){var valueInPercent=this._getPercentageOfRunnableTrack(value);if(isNaN(valueInPercent)){return}
if(this.getOrientation()==='horizontal'){this.thumbElement.style.left=valueInPercent+'%'}else{this.thumbElement.style.bottom=valueInPercent+'%'}
this.trigger('change',this.getValue())};proto._removeEventListeners=function(){this._removeEventListener(this.el,'mousedown',this._onMouseDown);this._removeEventListener(this.el,'touchstart',this._onTouchStart);this._removeEventListener(this.el,'mouseover',this._onMouseOver);this._removeEventListener(this.el,'mouseleave',this._onMouseLeave);this._removeEventListener(document,'touchend',this._onMouseUp)};proto._removeEventListener=function(el,evtName,callback){el.removeEventListener(evtName,callback)};proto._setNodeReferences=function(){this.runnableTrackElement=this.el.querySelector('.ac-slider-runnable-track');this.thumbElement=this.el.querySelector('.ac-slider-thumb')};proto.setOrientation=function(orientation){this._set('orientation',orientation)};proto._triggerRelease=function(evt){this._preventDefault(evt);this.trigger('release',this.getValue());this._keyDown[keyCodeFromEvent(evt)]=0};proto._preventDefault=function(evt){evt.preventDefault();evt.stopPropagation()};proto._step=function(evt,up){this._preventDefault(evt);this.el.focus();var currentStep=this._keyDown[keyCodeFromEvent(evt)]||0;if(!currentStep){this.trigger('grab',this.getValue());currentStep=this.getStep();currentStep=(currentStep!=='auto')?currentStep:this._cachedMaxStep;if(!up){currentStep*=-1}
this._keyboard.onceUp(keyCodeFromEvent(evt),this._triggerRelease)}else if(Math.abs(this._keyDown[keyCodeFromEvent(evt)])<(Math.abs(this.model.max*this.model.keyboardMaxStepPercentage))){currentStep*=this.model.keyboardStepMultiplier}
this._keyDown[keyCodeFromEvent(evt)]=currentStep;this.setValue(this.getValue()+currentStep)};proto.stepUp=function(evt){this._step(evt,!0)};proto.stepDown=function(evt){this._step(evt,!1)};proto.setValue=function(value){value=this._getNextValue(value,this.getMin(),this.getMax(),this.getStep());this._set('value',value);this.el.setAttribute('aria-valuenow',value);this._onChange(value)};proto.setMin=function(min){this._set('min',min);this.el.setAttribute('aria-valuemin',min)};proto.setMax=function(max){this._set('max',max);this.el.setAttribute('aria-valuemax',max);this._cachedMaxStep=max/100};proto.setStep=function(step){this._set('step',step)};proto._set=function(key,value){if(VALID_KEYS.indexOf(key)>-1&&this.model[key]!==value){var previous=this.model[key];this.model[key]=value;this.trigger('change:model:'+key,{previous:previous,current:value})}};proto._removeEventListeners=function(){this._removeEventListener(this.el,'mousedown',this._onMouseDown);this._removeEventListener(this.el,'touchstart',this._onTouchStart);this._removeEventListener(this.el,'mouseover',this._onMouseOver);this._removeEventListener(this.el,'mouseleave',this._onMouseLeave);this._removeEventListener(this.el,'touchend',this._onTouchEnd);this._removeEventListener(document,'touchend',this._onMouseUp);if(this.model.orientation==='horizontal'){this._keyboard.offDown(ARROW_RIGHT.num,this.stepUp);this._keyboard.offDown(ARROW_LEFT.num,this.stepDown);this._keyboard.offUp(ARROW_LEFT.num,this._triggerRelease);this._keyboard.offUp(ARROW_RIGHT.num,this._triggerRelease)}else{this._keyboard.offDown(ARROW_DOWN.num,this.stepDown);this._keyboard.offDown(ARROW_UP.num,this.stepUp);this._keyboard.offUp(ARROW_DOWN.num,this._triggerRelease);this._keyboard.offUp(ARROW_UP.num,this._triggerRelease)}};proto.destroy=function(){this._removeEventListeners();if(this._keyboard){this._keyboard.destroy()}
EventEmitterMicro.prototype.destroy.call(this)};module.exports=SliderView},{"./templates/slider.html":167,"@marcom/ac-event-emitter-micro":89,"@marcom/ac-keyboard/Keyboard":109,"@marcom/dom-metrics":286}],166:[function(require,module,exports){'use strict';module.exports.Slider=require('./Slider')},{"./Slider":165}],167:[function(require,module,exports){module.exports=`<div class="ac-slider-runnable-track">
	<div class="ac-slider-thumb"></div>
</div>`},{}],168:[function(require,module,exports){module.exports=require('https://www.apple.com/jobs/us/lib/')},{"./lib/":169}],169:[function(require,module,exports){var Stringify=require('./stringify');var Parse=require('./parse');var internals={};module.exports={stringify:Stringify,parse:Parse}},{"./parse":170,"./stringify":171}],170:[function(require,module,exports){var Utils=require('./utils');var internals={delimiter:'&',depth:5,arrayLimit:20,parameterLimit:1000};internals.parseValues=function(str,options){var obj={};var parts=str.split(options.delimiter,options.parameterLimit===Infinity?undefined:options.parameterLimit);for(var i=0,il=parts.length;i<il;++i){var part=parts[i];var pos=part.indexOf(']=')===-1?part.indexOf('='):part.indexOf(']=')+1;if(pos===-1){obj[Utils.decode(part)]=''}
else{var key=Utils.decode(part.slice(0,pos));var val=Utils.decode(part.slice(pos+1));if(!obj.hasOwnProperty(key)){obj[key]=val}
else{obj[key]=[].concat(obj[key]).concat(val)}}}
return obj};internals.parseObject=function(chain,val,options){if(!chain.length){return val}
var root=chain.shift();var obj={};if(root==='[]'){obj=[];obj=obj.concat(internals.parseObject(chain,val,options))}
else{var cleanRoot=root[0]==='['&&root[root.length-1]===']'?root.slice(1,root.length-1):root;var index=parseInt(cleanRoot,10);var indexString=''+index;if(!isNaN(index)&&root!==cleanRoot&&indexString===cleanRoot&&index>=0&&index<=options.arrayLimit){obj=[];obj[index]=internals.parseObject(chain,val,options)}
else{obj[cleanRoot]=internals.parseObject(chain,val,options)}}
return obj};internals.parseKeys=function(key,val,options){if(!key){return}
var parent=/^([^\[\]]*)/;var child=/(\[[^\[\]]*\])/g;var segment=parent.exec(key);if(Object.prototype.hasOwnProperty(segment[1])){return}
var keys=[];if(segment[1]){keys.push(segment[1])}
var i=0;while((segment=child.exec(key))!==null&&i<options.depth){++i;if(!Object.prototype.hasOwnProperty(segment[1].replace(/\[|\]/g,''))){keys.push(segment[1])}}
if(segment){keys.push('['+key.slice(segment.index)+']')}
return internals.parseObject(keys,val,options)};module.exports=function(str,options){if(str===''||str===null||typeof str==='undefined'){return{}}
options=options||{};options.delimiter=typeof options.delimiter==='string'||Utils.isRegExp(options.delimiter)?options.delimiter:internals.delimiter;options.depth=typeof options.depth==='number'?options.depth:internals.depth;options.arrayLimit=typeof options.arrayLimit==='number'?options.arrayLimit:internals.arrayLimit;options.parameterLimit=typeof options.parameterLimit==='number'?options.parameterLimit:internals.parameterLimit;var tempObj=typeof str==='string'?internals.parseValues(str,options):str;var obj={};var keys=Object.keys(tempObj);for(var i=0,il=keys.length;i<il;++i){var key=keys[i];var newObj=internals.parseKeys(key,tempObj[key],options);obj=Utils.merge(obj,newObj)}
return Utils.compact(obj)}},{"./utils":172}],171:[function(require,module,exports){var Utils=require('./utils');var internals={delimiter:'&',indices:!0};internals.stringify=function(obj,prefix,options){if(Utils.isBuffer(obj)){obj=obj.toString()}
else if(obj instanceof Date){obj=obj.toISOString()}
else if(obj===null){obj=''}
if(typeof obj==='string'||typeof obj==='number'||typeof obj==='boolean'){return[encodeURIComponent(prefix)+'='+encodeURIComponent(obj)]}
var values=[];if(typeof obj==='undefined'){return values}
var objKeys=Object.keys(obj);for(var i=0,il=objKeys.length;i<il;++i){var key=objKeys[i];if(!options.indices&&Array.isArray(obj)){values=values.concat(internals.stringify(obj[key],prefix,options))}
else{values=values.concat(internals.stringify(obj[key],prefix+'['+key+']',options))}}
return values};module.exports=function(obj,options){options=options||{};var delimiter=typeof options.delimiter==='undefined'?internals.delimiter:options.delimiter;options.indices=typeof options.indices==='boolean'?options.indices:internals.indices;var keys=[];if(typeof obj!=='object'||obj===null){return''}
var objKeys=Object.keys(obj);for(var i=0,il=objKeys.length;i<il;++i){var key=objKeys[i];keys=keys.concat(internals.stringify(obj[key],key,options))}
return keys.join(delimiter)}},{"./utils":172}],172:[function(require,module,exports){var internals={};exports.arrayToObject=function(source){var obj={};for(var i=0,il=source.length;i<il;++i){if(typeof source[i]!=='undefined'){obj[i]=source[i]}}
return obj};exports.merge=function(target,source){if(!source){return target}
if(typeof source!=='object'){if(Array.isArray(target)){target.push(source)}
else{target[source]=!0}
return target}
if(typeof target!=='object'){target=[target].concat(source);return target}
if(Array.isArray(target)&&!Array.isArray(source)){target=exports.arrayToObject(target)}
var keys=Object.keys(source);for(var k=0,kl=keys.length;k<kl;++k){var key=keys[k];var value=source[key];if(!target[key]){target[key]=value}
else{target[key]=exports.merge(target[key],value)}}
return target};exports.decode=function(str){try{return decodeURIComponent(str.replace(/\+/g,' '))}catch(e){return str}};exports.compact=function(obj,refs){if(typeof obj!=='object'||obj===null){return obj}
refs=refs||[];var lookup=refs.indexOf(obj);if(lookup!==-1){return refs[lookup]}
refs.push(obj);if(Array.isArray(obj)){var compacted=[];for(var i=0,il=obj.length;i<il;++i){if(typeof obj[i]!=='undefined'){compacted.push(obj[i])}}
return compacted}
var keys=Object.keys(obj);for(i=0,il=keys.length;i<il;++i){var key=keys[i];obj[key]=exports.compact(obj[key],refs)}
return obj};exports.isRegExp=function(obj){return Object.prototype.toString.call(obj)==='[object RegExp]'};exports.isBuffer=function(obj){if(obj===null||typeof obj==='undefined'){return!1}
return!!(obj.constructor&&obj.constructor.isBuffer&&obj.constructor.isBuffer(obj))}},{}],173:[function(require,module,exports){'use strict';module.exports={Link:require('./ac-social/Link'),Dialog:require('./ac-social/Dialog'),Focus:require('./ac-social/Focus'),Debug:require('./ac-social/Debug')}},{"./ac-social/Debug":174,"./ac-social/Dialog":175,"./ac-social/Focus":176,"./ac-social/Link":177}],174:[function(require,module,exports){'use strict';var NetworkActions=require('./NetworkActions');function Debug(){this.types={};var i;for(i in NetworkActions){if(NetworkActions.hasOwnProperty(i)){proto[i]=i;this.addType(i,NetworkActions[i].getDialogDebugData.bind(NetworkActions[i]))}}}
var proto=Debug.prototype;proto.create=function(type,data){data=data||{};var func=this.types[type];if(!func){return}
return func(data)};proto.addType=function(name,func){this.types[name]=func;return this};proto.removeType=function(){this.types[name]=null;return this};module.exports=new Debug()},{"./NetworkActions":178}],175:[function(require,module,exports){'use strict';var NetworkActions=require('./NetworkActions');function Dialog(){this.types={};var i;for(i in NetworkActions){if(NetworkActions.hasOwnProperty(i)){proto[i]=i;this.addType(i,NetworkActions[i].generateDialog.bind(NetworkActions[i]))}}}
var proto=Dialog.prototype;proto.create=function(type,data){data=data||{};var func=this.types[type];if(!func){return}
return func(data)};proto.addType=function(name,func){this.types[name]=func;return this};proto.removeType=function(){this.types[name]=null;return this};module.exports=new Dialog()},{"./NetworkActions":178}],176:[function(require,module,exports){'use strict';module.exports=function(el){if(window.getSelection){var selection=window.getSelection();var range=document.createRange();range.selectNodeContents(el);selection.removeAllRanges();selection.addRange(range)}else if(el.setSelectionRange){el.setSelectionRange(0,el.value.length)}else if(document.body.createTextRange){var range=document.body.createTextRange();range.moveToElementText(el);range.select()}}},{}],177:[function(require,module,exports){'use strict';var NetworkActions=require('./NetworkActions'),DefaultNetworkAction=require('./network-actions/DefaultNetworkAction');function Link(){this.types={};var i;for(i in NetworkActions){if(NetworkActions.hasOwnProperty(i)){proto[i]=i;this.addType(i,NetworkActions[i].generateLink.bind(NetworkActions[i]))}}}
var proto=Link.prototype;proto.create=function(type,data,el){data=data||{};var func=this.types[type];if(!func){return}
return func(data,el)};proto.createFromAnchor=function(el){var elNetworkAction=el.getAttribute('data-network-action');var i;for(i in NetworkActions){if(NetworkActions.hasOwnProperty(i)){if(elNetworkAction===NetworkActions[i].id){NetworkActions[i].enhanceLinkEngagement(el);return}}}
DefaultNetworkAction.enhanceLinkEngagement(el)};proto.addType=function(name,func){this.types[name]=func;return this};proto.removeType=function(){this.types[name]=null;return this};module.exports=new Link()},{"./NetworkActions":178,"./network-actions/DefaultNetworkAction":179}],178:[function(require,module,exports){'use strict';var FacebookShare=require('./network-actions/FacebookShare'),PinterestShare=require('./network-actions/PinterestShare'),TumblrShare=require('./network-actions/TumblrShare'),TwitterFavorite=require('./network-actions/TwitterFavorite'),TwitterReply=require('./network-actions/TwitterReply'),TwitterRetweet=require('./network-actions/TwitterRetweet'),TwitterTweet=require('./network-actions/TwitterTweet'),WeiboShare=require('./network-actions/WeiboShare'),QQWeiboShare=require('./network-actions/QQWeiboShare'),QZoneShare=require('./network-actions/QZoneShare'),RenrenShare=require('./network-actions/RenrenShare'),EMailShare=require('./network-actions/EMailShare');module.exports={'FACEBOOK_SHARE':FacebookShare,'PINTEREST_SHARE':PinterestShare,'TUMBLR_SHARE':TumblrShare,'TWITTER_FAVORITE':TwitterFavorite,'TWITTER_REPLY':TwitterReply,'TWITTER_RETWEET':TwitterRetweet,'TWITTER_TWEET':TwitterTweet,'WEIBO_SHARE':WeiboShare,'QQWEIBO_SHARE':QQWeiboShare,'QZONE_SHARE':QZoneShare,'RENREN_SHARE':RenrenShare,'EMAIL_SHARE':EMailShare}},{"./network-actions/EMailShare":180,"./network-actions/FacebookShare":181,"./network-actions/PinterestShare":183,"./network-actions/QQWeiboShare":184,"./network-actions/QZoneShare":185,"./network-actions/RenrenShare":186,"./network-actions/TumblrShare":187,"./network-actions/TwitterFavorite":188,"./network-actions/TwitterReply":189,"./network-actions/TwitterRetweet":190,"./network-actions/TwitterTweet":191,"./network-actions/WeiboShare":192}],179:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){return rawData};module.exports=new NetworkAction(normalizeData,{baseLinkPath:''})},{"./NetworkAction":182}],180:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){var data={url:rawData.url};if(rawData.title){data.subject=rawData.title}
if(rawData.description){data.body=rawData.description+'\r\n\r\n'+rawData.url}else{data.body=rawData.url}
return data};module.exports=new NetworkAction(normalizeData,{id:'email-share',baseLinkPath:'mailto:',preventDialog:!0})},{"./NetworkAction":182}],181:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){return{u:rawData.url}};module.exports=new NetworkAction(normalizeData,{id:'facebook-share',baseLinkPath:'https://www.facebook.com/sharer/sharer.php',dialogDimensions:{width:555,height:368}})},{"./NetworkAction":182}],182:[function(require,module,exports){'use strict';var qs=require('qs');var proto;var NetworkAction=function(normalizeDataFunc,options){options=options||{};this.baseLinkPath=options.baseLinkPath;if(options.dialogDimensions){this.dialogDimensions=options.dialogDimensions}
if(options.id){this.id=options.id}
if(options.preventDialog){this.preventDialog=options.preventDialog}
this.normalizeData=normalizeDataFunc};proto=NetworkAction.prototype;proto.dataAttributeName='network-action';proto.id='network-action';proto.normalizeData=function(rawData){return rawData};proto.dialogDimensions={width:500,height:500};proto.generateLinkURL=function(rawData){var normalizedData=this.normalizeData(rawData),queryString=qs.stringify(normalizedData),linkPath=this.baseLinkPath;if(queryString.length>0){linkPath=linkPath+'?'+queryString}
return linkPath};proto.generateLink=function(rawData,el){var url=this.generateLinkURL(rawData);el=el||document.createElement('A');el.setAttribute('href',url);el.setAttribute('target','_blank');el.setAttribute('data-'+this.dataAttributeName,this.id);this.enhanceLinkEngagement(el,url);return el};proto.generateDialog=function(rawData){var linkPath=this.generateLinkURL(rawData);this._triggerDialog(linkPath)};proto.enhanceLinkEngagement=function(el,url){var scope=this||proto;url=url||el.getAttribute('href');el.addEventListener('click',this._onLinkEngaged.bind(this,url))};proto.getDialogOptions=function(){var i,optionsStr='status=1',options={width:this.dialogDimensions.width,height:this.dialogDimensions.height};options.top=(window.screen.availHeight-options.height)/2;options.left=(window.screen.availWidth-options.width)/2;for(i in options){if(options.hasOwnProperty(i)){optionsStr+=', '+i+'='+options[i]}}
return optionsStr};proto.getDialogDebugData=function(rawData){return{data:this.normalizeData(rawData),dialogUrl:this.generateLinkURL(rawData)}};proto._triggerDialog=function(url){if(this.preventDialog){window.location.href=url;return}
window.open(url,'_blank',this.getDialogOptions())};proto._onLinkEngaged=function(url,e){e.preventDefault();this._triggerDialog(url)};module.exports=NetworkAction},{"qs":168}],183:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){var data={url:rawData.url,description:rawData.description};if(rawData.media){data.media=rawData.media}
return data};module.exports=new NetworkAction(normalizeData,{id:'pinterest-share',baseLinkPath:'http://www.pinterest.com/pin/create/button',dialogDimensions:{width:750,height:450}})},{"./NetworkAction":182}],184:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){return{url:rawData.url,title:rawData.title,pic:rawData.media}};module.exports=new NetworkAction(normalizeData,{id:'qq-weibo-share',baseLinkPath:'http://v.t.qq.com/share/share.php',dialogDimensions:{width:658,height:506}})},{"./NetworkAction":182}],185:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){return{url:rawData.url,title:rawData.title,pics:rawData.media,summary:rawData.description}};module.exports=new NetworkAction(normalizeData,{id:'qzone-share',baseLinkPath:'http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey',dialogDimensions:{width:620,height:645}})},{"./NetworkAction":182}],186:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){return{url:rawData.url,title:rawData.title}};module.exports=new NetworkAction(normalizeData,{id:'renren-share',baseLinkPath:'http://www.connect.renren.com/share/sharer',dialogDimensions:{width:500,height:315}})},{"./NetworkAction":182}],187:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){var data={clickthru:rawData.url,caption:rawData.description};if(rawData.media){data.source=rawData.media}
return data};module.exports=new NetworkAction(normalizeData,{id:'tumblr-share',baseLinkPath:'http://www.tumblr.com/share/photo',dialogDimensions:{width:450,height:432}})},{"./NetworkAction":182}],188:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){var data={tweet_id:rawData.messageId};return data};module.exports=new NetworkAction(normalizeData,{id:'twitter-favorite',baseLinkPath:'https://twitter.com/intent/favorite',dialogDimensions:{width:550,height:420}})},{"./NetworkAction":182}],189:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){var data={in_reply_to:rawData.messageId};if(rawData.hashtags){data.hashtags=rawData.hashtags}
return data};module.exports=new NetworkAction(normalizeData,{id:'twitter-reply',baseLinkPath:'https://twitter.com/intent/tweet',dialogDimensions:{width:550,height:420}})},{"./NetworkAction":182}],190:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){var data={tweet_id:rawData.messageId};return data};module.exports=new NetworkAction(normalizeData,{id:'twitter-retweet',baseLinkPath:'https://twitter.com/intent/retweet',dialogDimensions:{width:550,height:420}})},{"./NetworkAction":182}],191:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){var data={url:rawData.url,text:rawData.description};if(rawData.hashtags){data.hashtags=rawData.hashtags}
return data};module.exports=new NetworkAction(normalizeData,{id:'twitter-tweet',baseLinkPath:'https://twitter.com/intent/tweet',dialogDimensions:{width:550,height:420}})},{"./NetworkAction":182}],192:[function(require,module,exports){'use strict';var NetworkAction=require('./NetworkAction');var normalizeData=function(rawData){return{url:rawData.url,title:rawData.title,pic:rawData.media}};module.exports=new NetworkAction(normalizeData,{id:'weibo-share',baseLinkPath:'http://service.weibo.com/share/share.php',dialogDimensions:{width:650,height:426}})},{"./NetworkAction":182}],193:[function(require,module,exports){'use strict';module.exports=function supplant(str,obj,pattern){if(!obj){return str}
pattern=pattern||/{([^{}]*)}/g;return str.replace(pattern,function(a,b){var r=obj[b];return(typeof r==='string'||typeof r==='number'||typeof r==='boolean')?r:a})}},{}],194:[function(require,module,exports){'use strict';module.exports=function joinSearchParams(obj,questionMark){var sep='&';var str='';if(obj){var keysArr=Object.keys(obj);var lastIndex=keysArr.length-1;keysArr.forEach(function(key,index){var value=obj[key];key=key.trim();value=value&&typeof value==='string'?value.trim():value;value=value===null?'':'='+value;var param=key+value+(index===lastIndex?'':sep);str=str?str.concat(param):param})}
return(str&&questionMark!==!1)?'?'+str:str}},{}],195:[function(require,module,exports){'use strict';var navigatorObj={ua:window.navigator.userAgent,platform:window.navigator.platform,vendor:window.navigator.vendor};module.exports=require('./parseUserAgent')(navigatorObj)},{"./parseUserAgent":198}],196:[function(require,module,exports){'use strict';module.exports={browser:{safari:!1,chrome:!1,firefox:!1,ie:!1,opera:!1,android:!1,edge:!1,version:{name:'',major:0,minor:0,patch:0,documentMode:!1}},os:{osx:!1,ios:!1,android:!1,windows:!1,linux:!1,fireos:!1,chromeos:!1,version:{name:'',major:0,minor:0,patch:0}}}},{}],197:[function(require,module,exports){'use strict';module.exports={browser:[{name:'edge',userAgent:'Edge',version:['rv','Edge'],test:function(navigatorObj){return(navigatorObj.ua.indexOf('Edge')>-1||navigatorObj.ua==='Mozilla/5.0 (Windows NT 10.0; Win64; x64)')}},{name:'chrome',userAgent:'Chrome'},{name:'firefox',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Firefox')>-1&&navigatorObj.ua.indexOf('Opera')===-1)},version:'Firefox'},{name:'android',userAgent:'Android'},{name:'safari',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Safari')>-1&&navigatorObj.vendor.indexOf('Apple')>-1)},version:'Version'},{name:'ie',test:function(navigatorObj){return(navigatorObj.ua.indexOf('IE')>-1||navigatorObj.ua.indexOf('Trident')>-1)},version:['MSIE','rv'],parseDocumentMode:function(){var documentModeForIE=!1;if(document.documentMode){documentModeForIE=parseInt(document.documentMode,10)}
return documentModeForIE}},{name:'opera',userAgent:'Opera',version:['Version','Opera']}],os:[{name:'windows',test:function(navigatorObj){return(navigatorObj.platform.indexOf('Win')>-1)},version:'Windows NT'},{name:'osx',userAgent:'Mac',test:function(navigatorObj){return(navigatorObj.platform.indexOf('Mac')>-1)}},{name:'ios',test:function(navigatorObj){return(navigatorObj.ua.indexOf('iPhone')>-1||navigatorObj.ua.indexOf('iPad')>-1)},version:['iPhone OS','CPU OS']},{name:'linux',userAgent:'Linux',test:function(navigatorObj){return(navigatorObj.platform.indexOf('Linux')>-1&&navigatorObj.ua.indexOf('Android')===-1)}},{name:'fireos',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Firefox')>-1&&navigatorObj.ua.indexOf('Mobile')>-1)},version:'rv'},{name:'android',userAgent:'Android'},{name:'chromeos',userAgent:'CrOS'}]}},{}],198:[function(require,module,exports){'use strict';var defaults=require('./defaults');var dictionary=require('./dictionary');function _matchVersionStrRegExp(str){return new RegExp(str+'[a-zA-Z\\s\/\:]+([0-9_\.]+)','i')}
function _parseVersion(data,ua){if(typeof data.parseVersion==='function'){return data.parseVersion(ua)}else{var versionSearchStr=data.version||data.userAgent;if(typeof versionSearchStr==='string'){versionSearchStr=[versionSearchStr]}
var versionSearchStrLength=versionSearchStr.length;var match;for(var i=0;i<versionSearchStrLength;i++){match=ua.match(_matchVersionStrRegExp(versionSearchStr[i]));if(match&&match.length>1){return match[1].replace(/_/g,'.')}}}}
function _parseUserAgent(dictionaryData,defaultObj,navigatorObj){var dictionaryDataLength=dictionaryData.length;var current;var currentVersion;for(var i=0;i<dictionaryDataLength;i++){if(typeof dictionaryData[i].test==='function'){if(dictionaryData[i].test(navigatorObj)===!0){current=dictionaryData[i].name}}else{if(navigatorObj.ua.indexOf(dictionaryData[i].userAgent)>-1){current=dictionaryData[i].name}}
if(current){defaultObj[current]=!0;currentVersion=_parseVersion(dictionaryData[i],navigatorObj.ua);if(typeof currentVersion==='string'){var versionBreakdown=currentVersion.split('.');defaultObj.version.name=currentVersion;if(versionBreakdown&&versionBreakdown.length>0){defaultObj.version.major=parseInt(versionBreakdown[0]||0);defaultObj.version.minor=parseInt(versionBreakdown[1]||0);defaultObj.version.patch=parseInt(versionBreakdown[2]||0)}}else if(current==='edge'){defaultObj.version.name='12.0.0';defaultObj.version.major='12';defaultObj.version.minor='0';defaultObj.version.patch='0'}
if(typeof dictionaryData[i].parseDocumentMode==='function'){defaultObj.version.documentMode=dictionaryData[i].parseDocumentMode()}
return defaultObj}}
return defaultObj}
function parseUserAgent(navigatorObj){var userAgent={};userAgent.browser=_parseUserAgent(dictionary.browser,defaults.browser,navigatorObj);userAgent.os=_parseUserAgent(dictionary.os,defaults.os,navigatorObj);return userAgent}
module.exports=parseUserAgent},{"./defaults":196,"./dictionary":197}],199:[function(require,module,exports){module.exports={major:4,minor:3,patch:1,prerelease:null,toString:function(){return'4.3.1 (a66bfd1)'},toArray:function(){return[4,3,1]}}},{}],200:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var CHANGE='change';var ChapterEmitter=function(_EventEmitterMicro){_inherits(ChapterEmitter,_EventEmitterMicro);function ChapterEmitter(options){_classCallCheck(this,ChapterEmitter);var _this=_possibleConstructorReturn(this,(ChapterEmitter.__proto__||Object.getPrototypeOf(ChapterEmitter)).call(this));_this._chapters=Array.from(options.chapters||[]);return _this}
_createClass(ChapterEmitter,[{key:'addChapter',value:function addChapter(chapter){this._chapters.push(chapter);this._onChange()}},{key:'removeChapter',value:function removeChapter(chapterIndex){var idx=-1;for(var i=0;i<this._chapters.length;i++){if(this._chapters[i].chapter===chapterIndex){idx=i;break}}
if(idx>=0){this._chapters.splice(idx,1)}
this._onChange()}},{key:'_onChange',value:function _onChange(){this.trigger(CHANGE)}},{key:'getChapterForTime',value:function getChapterForTime(time){var fudgeFactor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;for(var i=0;i<this._chapters.length;i++){var curr=this._chapters[i];var start=curr['start-time'];if(!curr.duration||isNaN(curr.duration)){if(this._chapters.length>i+1){var next=this._chapters[i+1];if(time>=start-fudgeFactor&&time<next['start-time']-fudgeFactor){return curr}}else if(time>=start){return curr}}else if(start-fudgeFactor<=time&&time<start+curr.duration-fudgeFactor){return curr}}
return null}},{key:'clearChapters',value:function clearChapters(){this._chapters=[];this._onChange()}},{key:'chapters',set:function set(chapters){this._chapters=chapters;this._onChange()},get:function get(){return this._chapters}}]);return ChapterEmitter}(EventEmitterMicro);module.exports=ChapterEmitter},{"@marcom/ac-event-emitter-micro":89}],201:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var DOMEmitterMicro=function(){function DOMEmitterMicro(element){_classCallCheck(this,DOMEmitterMicro);this._listeners={};this.el=element}
_createClass(DOMEmitterMicro,[{key:"on",value:function on(type,callback){if(!this._listeners[type]){this._listeners[type]=[]}
var obj={originalCb:callback,args:[type,function(evt){callback(evt)}].concat(Array.from(arguments).slice(2))};this._listeners[type].push(obj);this.el.addEventListener.apply(this.el,obj.args)}},{key:"off",value:function off(type,callback){var listeners=this._listeners[type];var index=-1;var listener=listeners.find(function(obj){index++;return obj.originalCb===callback});if(listener){var obj=listeners[index];this.el.removeEventListener.apply(this.el,obj.args);listeners.splice(index,1)}}},{key:"replaceElement",value:function replaceElement(newElement){var _this=this;var keys=Object.keys(this._listeners);keys.forEach(function(key){var arr=_this._listeners[key];arr.forEach(function(item){_this.el.removeEventListener.apply(_this.el,item.args);newElement.addEventListener.apply(newElement,item.args)})});this.el=newElement}},{key:"once",value:function once(type,cb){var _this2=this;var onceCallback=function onceCallback(){cb();_this2.off(type,onceCallback)};this.on(type,onceCallback)}},{key:"trigger",value:function trigger(eventName,data){var evt=new CustomEvent(eventName,{detail:data});this.el.dispatchEvent(evt)}}]);return DOMEmitterMicro}();module.exports=DOMEmitterMicro},{}],202:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var EventEmitterShim=function(_EventEmitterMicro){_inherits(EventEmitterShim,_EventEmitterMicro);function EventEmitterShim(){_classCallCheck(this,EventEmitterShim);return _possibleConstructorReturn(this,(EventEmitterShim.__proto__||Object.getPrototypeOf(EventEmitterShim)).call(this))}
_createClass(EventEmitterShim,[{key:'once',value:function once(eventName,callback,context){if(context){var cb=function cb(){callback.apply(context,arguments)};_get(EventEmitterShim.prototype.__proto__||Object.getPrototypeOf(EventEmitterShim.prototype),'once',this).apply(this,[eventName,cb])}else{_get(EventEmitterShim.prototype.__proto__||Object.getPrototypeOf(EventEmitterShim.prototype),'once',this).apply(this,arguments)}}},{key:'on',value:function on(eventType,callback,context){if(arguments.length>2){if(!this._boundListeners){this._boundListeners={}}
if(!this._boundListeners[eventType]){this._boundListeners[eventType]=[]}
var bound=callback.bind(context);this._boundListeners[eventType].push([callback,context,bound]);return _get(EventEmitterShim.prototype.__proto__||Object.getPrototypeOf(EventEmitterShim.prototype),'on',this).call(this,eventType,bound)}else{return _get(EventEmitterShim.prototype.__proto__||Object.getPrototypeOf(EventEmitterShim.prototype),'on',this).apply(this,arguments)}}},{key:'off',value:function off(eventType,callback,context){if(arguments.length>2){try{var boundListeners=this._boundListeners[eventType];var len=boundListeners.length;var i=0;for(;i<len;i++){if(boundListeners[i][0]===callback&&boundListeners[i][1]===context){var bound=boundListeners.splice(i,1)[0];return _get(EventEmitterShim.prototype.__proto__||Object.getPrototypeOf(EventEmitterShim.prototype),'off',this).call(this,eventType,bound[2])}}}catch(e){}}
return _get(EventEmitterShim.prototype.__proto__||Object.getPrototypeOf(EventEmitterShim.prototype),'off',this).apply(this,arguments)}},{key:'destroy',value:function destroy(){this._boundListeners=undefined;_get(EventEmitterShim.prototype.__proto__||Object.getPrototypeOf(EventEmitterShim.prototype),'destroy',this).call(this)}}]);return EventEmitterShim}(EventEmitterMicro);module.exports=EventEmitterShim},{"@marcom/ac-event-emitter-micro":89}],203:[function(require,module,exports){'use strict';module.exports=require('./utils/urlOptimizer/OptimizeVideoUrl')},{"./utils/urlOptimizer/OptimizeVideoUrl":281}],204:[function(require,module,exports){'use strict';var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var EventEmitter=require('../event-emitter-shim/EventEmitterShim');var DOMEmitterMicro=require('../dom-emitter/DOMEmitterMicro');var ChapterEmitter=require('../chapters/ChapterEmitter');var createVideo=require('../video/VideoFactory').create;var userAgent=require('@marcom/useragent-detect');var acFullscreen=require('@marcom/ac-fullscreen');var createPoster=require('../posterframe/PosterFrameFactory');var Localization=require('../ui/localization/Localization');var ErrorView=require('../ui/error/ErrorView');var update=require('@marcom/ac-raf-emitter/update');var cancelUpdate=require('@marcom/ac-raf-emitter/cancelUpdate');var IS_RETINA=require('@marcom/ac-feature/isRetina')();var IS_DESKTOP=require('@marcom/ac-feature/isDesktop')()&&!require('@marcom/ac-feature/touchAvailable')();var IS_HANDHELD=require('@marcom/ac-feature/isHandheld')();var IS_SAFARI_IOS=userAgent.browser.safari&&userAgent.os.ios;var IS_CHROME=userAgent.browser.chrome;var USER_HOVER_CLASS='user-hover';var MOUSE_LEAVE_CLASS='mouse-leave';var MOBILE_CONTROLS_CLASS='mobile';var INITIAL_PLAY_CLASS='initial-play';var LIVE_MODE_CLASS='ac-video-live';var LONGFORM_CLASS='longform';var DEFAULT_BREAKPOINTS=require('../ui/DefaultBreakpoints');var log=require('@marcom/ac-console/log');var EventsToForward=require('./event/EventsToForward');var ReadyStateChangeEvents=require('./event/ReadyStateChangeEvents');var BreakpointDetect=require('../utils/BreakpointDetect');var createKeyboardControl=require('../ui/keyboard-control/createKeyboardControl');var createControlsInteraction=require('../ui/controls-interaction/createControlsInteraction');var disableFocus=require('@marcom/ac-accessibility/helpers/hide');var enableFocus=require('@marcom/ac-accessibility/helpers/show');var VERSION=require('../utils/getVersion');log('@marcom/ac-video version: '+VERSION.toString());var Player=function(_EventEmitter){_inherits(Player,_EventEmitter);function Player(options){_classCallCheck(this,Player);var _this=_possibleConstructorReturn(this,(Player.__proto__||Object.getPrototypeOf(Player)).call(this,options));options=options||{};_this.el=options.el||document.createElement('div');_this._elementEmitter=new DOMEmitterMicro(_this.el);_this.VERSION=VERSION;_this.options=options;_this._controlsFactory=options.controlsFactory;_this._urlOptimizer=options.urlOptimizer;try{var rootWindow=window.top;_this._maxWidth=options.maxWidth||Math.min(window.innerWidth,1280)||Math.min(rootWindow.innerWidth,1280)}catch(e){_this._maxWidth=options.maxWidth||Math.min(window.innerWidth,1280)}
_this._lastResize=0;_this._lastMouseCoords={};_this.el.classList.add('ac-video-player');_this.el.classList.add('idle-state');_this._isLive=options.live;if(_this._isLive){_this._useLiveMode()}
_this._videoImpl=createVideo(options,_this.el);_this._isResponsive=options.responsive;if(_this._isResponsive){_this._breakpointDetect=new BreakpointDetect({el:_this.el,player:_this,breakpoints:DEFAULT_BREAKPOINTS,addClass:!0})}
if(_this._isLive){_this._useLiveMode()}
_this._videoImpl=createVideo(options,_this.el);_this._supportsInlineVideo=IS_DESKTOP||!(IS_HANDHELD&&IS_SAFARI_IOS);_this._cachedPiPMode=_this.isPictureInPicture();_this._cachedReadyState=_this.getReadyState();_this._cachedVisibleTracksLength=0;_this.el.appendChild(_this._videoImpl.getRenderElement());if(options.poster||typeof options.poster==='undefined'){_this._initPoster(options.poster);if(!options.autoplay&&typeof options.preload!=='undefined'&&(options.preload==='none'||options.preload==='metadata'||options.preload===!1)){_this._poster.show()}}
_this._bindMethods();_this._addEventListeners();if(IS_DESKTOP){_this._keyboardControl=createKeyboardControl({player:_this,threesixty:options.threesixty,keyboardTarget:options.keyboardTarget})}
if(options.controls){_this._initUIComponents()}
_this._initErrorView();if(options.parentElement){options.parentElement.appendChild(_this.el)}
_this._chapterEmitter=new ChapterEmitter(options);_this.refreshSize=_this.refreshSize.bind(_this);_this._refreshSizeTimeout=setTimeout(_this.refreshSize,0);window.addEventListener('DOMContentLoaded',_this.refreshSize);return _this}
_createClass(Player,[{key:'_bindMethods',value:function _bindMethods(){this._onStart=this._onStart.bind(this);this._onEnded=this._onEnded.bind(this);this._onTimeUpdate=this._onTimeUpdate.bind(this);this._onCaptionsChanged=this._onCaptionsChanged.bind(this);this._onPlay=this._onPlay.bind(this);this._onFullscreenChange=this._onFullscreenChange.bind(this);this._onError=this._onError.bind(this);this._forwardEvent=this._forwardEvent.bind(this);this._onPresentationModeChanged=this._onPresentationModeChanged.bind(this);this._forwardFullScreenChangeEvent=this._forwardNamedEvent.bind(this,'fullscreen:change');this._forwardEnterFullScreenEvent=this._forwardNamedEvent.bind(this,'enterfullscreen');this._forwardExitFullScreenEvent=this._forwardNamedEvent.bind(this,'exitfullscreen');this._onDurationChange=this._onDurationChange.bind(this);this._forwardReadyStateChange=this._forwardReadyStateChange.bind(this);this._showControls=this._showControls.bind(this);this._hideControls=this._hideControls.bind(this);this._raiseControls=this._raiseControls.bind(this);this._lowerControls=this._lowerControls.bind(this);this._onPlayPromiseError=this._onPlayPromiseError.bind(this);this._onPlayPromiseResolved=this._onPlayPromiseResolved.bind(this);this._onChapterChange=this._onChapterChange.bind(this);this.refreshSize=this.refreshSize.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){var i=0;var len=EventsToForward.length;for(;i<len;i++){this._videoImpl.on(EventsToForward[i],this._forwardEvent)}
i=0;len=ReadyStateChangeEvents.length;for(;i<len;i++){this._videoImpl.on(ReadyStateChangeEvents[i],this._forwardReadyStateChange)}
this._videoImpl.on('timeupdate',this._onTimeUpdate);this._videoImpl.on('webkitpresentationmodechanged',this._onPresentationModeChanged);this._videoImpl.on('durationchange',this._onDurationChange);this._videoImpl.on('addtrack',this._forwardEvent);this._videoImpl.on('change',this._forwardEvent);this._videoImpl.on('change',this._onCaptionsChanged);this._videoImpl.on('removetrack',this._forwardEvent);this._videoImpl.on('loadedmetadata',this.refreshSize);this._videoImpl.on('loadeddata',this.refreshSize);this._videoImpl.on('play',this._onPlay);if(IS_DESKTOP){acFullscreen.on('enterfullscreen',this._forwardEnterFullScreenEvent);acFullscreen.on('exitfullscreen',this._forwardExitFullScreenEvent);acFullscreen.on('enterfullscreen',this._forwardFullScreenChangeEvent);acFullscreen.on('exitfullscreen',this._forwardFullScreenChangeEvent);this.on('fullscreen:change',this._onFullscreenChange)}else if(IS_SAFARI_IOS){this._videoImpl.on('webkitbeginfullscreen',this._forwardEnterFullScreenEvent);this._videoImpl.on('webkitendfullscreen',this._forwardExitFullScreenEvent);this._videoImpl.on('webkitbeginfullscreen',this._forwardFullScreenChangeEvent);this._videoImpl.on('webkitendfullscreen',this._forwardFullScreenChangeEvent);if(IS_HANDHELD){this.on('fullscreen:change',this._onFullscreenChange)}}
if(this._chapterEmitter){this._chapterEmitter.on('change',this._onChapterChange)}
this._videoImpl.on('PlayPromiseError',this._onPlayPromiseError);this._videoImpl.on('PlayPromiseResolved',this._onPlayPromiseResolved);this._videoImpl.on('error',this._onError)}},{key:'_onPlayPromiseResolved',value:function _onPlayPromiseResolved(){this.trigger('PlayPromiseResolved')}},{key:'_removeEventListeners',value:function _removeEventListeners(){var i=0;var len=EventsToForward.length;for(;i<len;i++){this._videoImpl.off(EventsToForward[i],this._forwardEvent)}
i=0;len=ReadyStateChangeEvents.length;for(;i<len;i++){this._videoImpl.off(ReadyStateChangeEvents[i],this._forwardReadyStateChange)}
this._videoImpl.off('timeupdate',this._onTimeUpdate);this._videoImpl.off('webkitpresentationmodechanged',this._onPresentationModeChanged);this._videoImpl.off('durationchange',this._onDurationChange);if(IS_DESKTOP){acFullscreen.off('enterfullscreen',this._forwardEnterFullScreenEvent);acFullscreen.off('exitfullscreen',this._forwardExitFullScreenEvent);acFullscreen.off('enterfullscreen',this._forwardFullScreenChangeEvent);acFullscreen.off('exitfullscreen',this._forwardFullScreenChangeEvent)}else if(userAgent.os.ios){this._videoImpl.off('webkitbeginfullscreen',this._forwardEnterFullScreenEvent);this._videoImpl.off('webkitendfullscreen',this._forwardExitFullScreenEvent);this._videoImpl.off('webkitbeginfullscreen',this._forwardFullScreenChangeEvent);this._videoImpl.off('webkitendfullscreen',this._forwardFullScreenChangeEvent)}
if(this._chapterEmitter){this._chapterEmitter.off('change',this._onChapterChange)}
this._videoImpl.off('PlayPromiseError',this._onPlayPromiseError);this._videoImpl.off('loadedmetadata',this.refreshSize);this._videoImpl.off('loadeddata',this.refreshSize);window.removeEventListener('DOMContentLoaded',this.refreshSize)}},{key:'_forwardReadyStateChange',value:function _forwardReadyStateChange(){var readyState=this.getReadyState();if(readyState>this._cachedReadyState||readyState===0){this._cachedReadyState=readyState;this.trigger('readystatechange',{readyState:readyState})}}},{key:'_forwardEvent',value:function _forwardEvent(evt){log(evt.type+' time:'+this.getCurrentTime());this.trigger(evt.type)}},{key:'_forwardNamedEvent',value:function _forwardNamedEvent(name){log(name+' time:'+this.getCurrentTime());this.trigger(name)}},{key:'_onPlayPromiseError',value:function _onPlayPromiseError(){log('play() Promise rejected, probably because the browser is blocking autoplay');this.el.classList.add(INITIAL_PLAY_CLASS);this._showStartState();this._poster.show();this.once('play',this._onPlay)}},{key:'_onCaptionsChanged',value:function _onCaptionsChanged(evt){var visibleTracksLength=this.getVisibleTextTracks().length;if(visibleTracksLength>0&&this._cachedVisibleTracksLength===0){this.trigger('texttrackshow')}else if(visibleTracksLength===0&&this._cachedVisibleTracksLength>0){this.trigger('texttrackhide')}
this._cachedVisibleTracksLength=visibleTracksLength}},{key:'_onTimeUpdate',value:function _onTimeUpdate(){this.trigger('timeupdate',{currentTime:this.getCurrentTime()})}},{key:'load',value:function load(sourceUrls,textTrackUrls,startTime,metadata){this._setError(!1);this.refreshSize();this._started=!1;if(!Array.isArray(sourceUrls)){sourceUrls=[sourceUrls]}
if(textTrackUrls&&!Array.isArray(textTrackUrls)){textTrackUrls=[{src:textTrackUrls}]}
this._cachedReadyState=0;if(!metadata){metadata=this.options}
if(this._urlOptimizer){if(!textTrackUrls){textTrackUrls=sourceUrls.map(this._urlOptimizer.getCaptionsSource).filter(function(val){return!!val})}
var visibleTracks=this.getVisibleTextTracks();if(visibleTracks&&visibleTracks.length&&textTrackUrls&&textTrackUrls.length){textTrackUrls[0].mode='showing'}
var calculatedMaxWidth=metadata.maxWidth||this._calcMaxWidth();sourceUrls=sourceUrls.map(function(url){return this._urlOptimizer.getVideoSource(url,calculatedMaxWidth,null,{maxWidth:this._maxWidth})}.bind(this))}
var thumbnails=metadata&&metadata.thumbnails||this._urlOptimizer&&this._urlOptimizer.getThumbnailImageSource(sourceUrls[0]);this.once('play',this._onPlay);if(this.options.autoplay&&IS_DESKTOP||this.getEnded()){this.once('loadstart',function(){this.play()}.bind(this))}
if(!metadata){metadata=this.options}
if(metadata&&this._poster){this.setPoster(metadata.poster)}
if(this._poster){this._poster.show()}
if(this.controls&&this.controls.sharingModule){if(metadata.sharing){this.controls.sharingModule.setData(metadata.sharing)}else{this.controls.sharingModule.setData(null)}}
if(metadata.live!==undefined){this._isLive=metadata.live;this._useLiveMode()}
this._hideEndState();this._videoImpl.load(sourceUrls,textTrackUrls,startTime);if(this.controls&&this.controls.overlays){this.controls.overlays.setData(thumbnails)}else if(this.controls){this.once('controlsready',function(){this.controls.overlays&&this.controls.overlays.setData(thumbnails)}.bind(this))}
if(this.controls&&this.controls.endState){this.controls.endState.setData(metadata.endState)}else if(this.controls){this.once('controlsready',function(){this.controls.endState&&this.controls.endState.setData(metadata.endState)}.bind(this))}}},{key:'_calcMaxWidth',value:function _calcMaxWidth(){if(this.el.parentElement){return this.el.parentElement.clientWidth}else{return this._maxWidth}}},{key:'_isActiveArea',value:function _isActiveArea(el){while(el!==this.el){if(el.hasAttribute('data-acv-active-area')){return!0}
el=el.parentNode}
return!1}},{key:'_onPresentationModeChanged',value:function _onPresentationModeChanged(evt){this._forwardEvent(evt);var isPiP=this.isPictureInPicture();if(this._cachedPiPMode!==isPiP){this._cachedPiPMode=isPiP;log('pictureinpicture:change to '+isPiP);this.trigger('pictureinpicture:change')}}},{key:'_onDurationChange',value:function _onDurationChange(evt){if(this.getDuration()>3600){this.el.classList.add(LONGFORM_CLASS)}
this.refreshSize()}},{key:'appendTo',value:function appendTo(el){el.appendChild(this.el);this.refreshSize()}},{key:'getTextTracks',value:function getTextTracks(){return Array.prototype.slice.call(this._videoImpl.getTextTracks())}},{key:'getVisibleTextTracks',value:function getVisibleTextTracks(){var tracks=Array.prototype.slice.call(this._videoImpl.getTextTracks());if(tracks&&tracks.length){tracks=tracks.filter(function(t){return t.mode==='showing'})}
return tracks}},{key:'getFullScreenElement',value:function getFullScreenElement(){if(!IS_DESKTOP){return this.getMediaElement()}else{return this.el}}},{key:'getFullScreenEnabled',value:function getFullScreenEnabled(){return acFullscreen.fullscreenEnabled(this.getFullScreenElement())}},{key:'isFullscreen',value:function isFullscreen(){if(IS_DESKTOP){return acFullscreen.fullscreenElement()===this.getFullScreenElement()}else{return this._videoImpl.isFullscreen()}}},{key:'requestFullscreen',value:function requestFullscreen(){if(!this.isFullscreen()){if(this.controls){this.controls.el.display='none';this._hideControls()}
this.trigger('fullscreen:willenter',{type:'enter'});this._lastResize=Date.now();cancelUpdate(this._updateFullscreenId);var self=this;var updateFn=function updateFn(){self.refreshSize();self._updateFullscreenId=update(updateFn)};this._updateFullscreenId=update(updateFn);if(IS_CHROME){setTimeout(function(){this._lastResize=Date.now();acFullscreen.requestFullscreen(this.getFullScreenElement())}.bind(this),300)}else{acFullscreen.requestFullscreen(this.getFullScreenElement())}}}},{key:'exitFullscreen',value:function exitFullscreen(){if(this.isFullscreen()){if(this.controls){this.controls.el.display='none';this._hideControls()}
this.trigger('fullscreen:willexit',{type:'exit'});if(IS_CHROME){setTimeout(function(){acFullscreen.exitFullscreen(this.getFullScreenElement())}.bind(this),300)}else{acFullscreen.exitFullscreen(this.getFullScreenElement())}}}},{key:'_onFullscreenChange',value:function _onFullscreenChange(){this._lastResize=Date.now();if(this.controls){this.controls.el.display='';this._hideControls()}
this._preventUserInteraction=!0;setTimeout(function(){cancelUpdate(this._updateFullscreenId);this._preventUserInteraction=!1;this.refreshSize()}.bind(this),750);this.refreshSize()}},{key:'toggleFullscreen',value:function toggleFullscreen(){if(this.isFullscreen()){this.exitFullscreen()}else{this.requestFullscreen()}}},{key:'_initUIComponents',value:function _initUIComponents(){if(this._controlsFactory){this._instantiateDefaultCustomUIControls();if(!IS_DESKTOP){this.controls.el.classList.add(MOBILE_CONTROLS_CLASS);this.setControls(!0)}else{this.el.appendChild(this._blockade.el)}}else{this.setControls(!0)}}},{key:'_showControls',value:function _showControls(){this._controlsVisible=!0;this.el.classList.remove(INITIAL_PLAY_CLASS);this.el.classList.add(USER_HOVER_CLASS)}},{key:'_hideControls',value:function _hideControls(){this._controlsVisible=!1;this.el.classList.remove(USER_HOVER_CLASS);this.hideCaptionsSelector()}},{key:'_raiseControls',value:function _raiseControls(){this._controlsVisible=!0;this.el.classList.remove(MOUSE_LEAVE_CLASS)}},{key:'_lowerControls',value:function _lowerControls(){this._controlsVisible=!1;this.el.classList.add(MOUSE_LEAVE_CLASS);this.hideCaptionsSelector()}},{key:'_onControlsReady',value:function _onControlsReady(){if(!this.options.autoplay||!IS_DESKTOP){this._showStartState()}}},{key:'_showStartState',value:function _showStartState(){if(this.controls){this.controls.el.classList.add('start-state')}
if(this._poster){this._poster.show()}
if(!IS_DESKTOP){disableFocus(this.getMediaElement())}}},{key:'_hideStartState',value:function _hideStartState(){if(this.controls){this.controls.el.classList.remove('start-state')}
if(this._poster){this._poster.hide()}
if(!IS_DESKTOP){enableFocus(this.getMediaElement())}}},{key:'_showEndState',value:function _showEndState(){if(this.controls){if(this.controls.mainControlsElement){if(this.controls.mainControlsElement.contains(document.activeElement)){setTimeout(function(){this.controls.playButtonElement.focus()}.bind(this))}}else if(this.el.contains(document.activeElement)&&!this.controls.sharingModule.el.contains(document.activeElement)){setTimeout(function(){this.controls.playButtonElement.focus()}.bind(this))}
this.controls.el.classList.add('end-state')}
if(this._poster){this._poster.show()}
disableFocus(this.getMediaElement())}},{key:'_hideEndState',value:function _hideEndState(){if(this.controls){this.controls.el.classList.remove('end-state')}
if(!IS_DESKTOP){enableFocus(this.getMediaElement())}}},{key:'_createBlockade',value:function _createBlockade(){this._blockade=new DOMEmitterMicro(document.createElement('div'));this._blockade.el.classList.add('ac-video-blockade')}},{key:'_instantiateDefaultCustomUIControls',value:function _instantiateDefaultCustomUIControls(){this.controls=this._controlsFactory.create({player:this,endState:this.options.endState,enableMainControls:IS_DESKTOP,basePath:this.options.localizationBasePath,template:this.options.template,readyCallback:function(){this._onControlsReady();this.trigger('controlsready')}.bind(this)});if(this.controls.el.parentNode!==this.el){this.el.appendChild(this.controls.el)}
this._videoImpl.setControls(!1);this._createBlockade();this._controlsInteraction=createControlsInteraction({player:this,keyboardControl:this._keyboardControl,controlsTimeoutDuration:this.options.controlsTimeoutDuration,showControls:this._showControls,hideControls:this._hideControls,raiseControls:this._raiseControls,lowerControls:this._lowerControls,controlsVisible:function(){return this._controlsVisible}.bind(this),sendMouseDown:this._videoImpl.sendMouseDown,elementEmitter:this._elementEmitter});return this.controls}},{key:'_onPlay',value:function _onPlay(){if(this._started){return}
this.el.classList.remove('idle-state');this.once('timeupdate',this._onStart,function(){return this.getCurrentTime()>0&&!this.getPaused()}.bind(this));this._started=!0}},{key:'isCaptionsSelectorShowing',value:function isCaptionsSelectorShowing(){return this.controls.el.classList.contains('captions-selector-showing')}},{key:'showCaptionsSelector',value:function showCaptionsSelector(){this.controls.el.classList.add('captions-selector-showing')}},{key:'hideCaptionsSelector',value:function hideCaptionsSelector(){this.controls.el.classList.remove('captions-selector-showing')}},{key:'_onStart',value:function _onStart(){this.el.classList.add(INITIAL_PLAY_CLASS);if(this._poster){this._poster.hide()}
if(this.controls){this._hideStartState();this._hideEndState()}
this.once('ended',this._onEnded)}},{key:'_onEnded',value:function _onEnded(){if(this.isFullscreen()){this.exitFullscreen()}
if(this.controls){this._hideStartState();this._showEndState()}
setTimeout(function(){this.once('timeupdate',function(){if(this.getEnded()){this._onEnded()}else{this._onStart()}}.bind(this))}.bind(this),300);if(this._poster){this._poster.show()}
this._started=!1}},{key:'_initPoster',value:function _initPoster(src){this._poster=createPoster({player:this,video:this._videoImpl,useNativePoster:this.options.controls===!1,is2x:IS_RETINA,src:src});if(this._poster.el){this.el.appendChild(this._poster.el)}
if(!this.options.autoplay){this._poster.show()}}},{key:'_initErrorView',value:function _initErrorView(){this._errorView=new ErrorView();this.el.appendChild(this._errorView.el)}},{key:'_useLiveMode',value:function _useLiveMode(){if(this._isLive){this.el.classList.add(LIVE_MODE_CLASS)}else{this.el.classList.remove(LIVE_MODE_CLASS)}}},{key:'once',value:function once(eventType,callback,clause){if(arguments.length<3||(typeof clause==='undefined'?'undefined':_typeof(clause))==='object'){_get(Player.prototype.__proto__||Object.getPrototypeOf(Player.prototype),'once',this).apply(this,arguments)}else{var args=arguments;var clauses=Array.prototype.slice.call(arguments,2);var cb=function(){if(clauses.every(function(fn){return!!fn()})){args[1].apply(this,args);this.off(args[0],cb)}}.bind(this);this.on(args[0],cb)}}},{key:'getMediaElement',value:function getMediaElement(){return this._videoImpl.getMediaElement()}},{key:'play',value:function play(){var _this2=this;this.el.classList.remove('idle-state');var currentTime=this._videoImpl.getCurrentTime();log('play called');if(!(this._videoImpl.getError()&&(currentTime===0||isNaN(currentTime)))){this._videoImpl.play()}else{setTimeout(function(){_this2._errorView.focus()},1000)}}},{key:'pause',value:function pause(){this._videoImpl.pause()}},{key:'seek',value:function seek(seekPosition){this.setCurrentTime.apply(this,arguments)}},{key:'addTextTrack',value:function addTextTrack(trackObject){this._videoImpl.addTextTrack(trackObject)}},{key:'getReadyState',value:function getReadyState(){return this._videoImpl.getMediaElement().readyState}},{key:'getPreload',value:function getPreload(){return this._videoImpl.getPreload()}},{key:'setPoster',value:function setPoster(url){this._poster.setSrc(url)}},{key:'getPoster',value:function getPoster(){this._poster.getSrc()}},{key:'getVolume',value:function getVolume(){return this._videoImpl.getVolume()}},{key:'getMuted',value:function getMuted(){return this._videoImpl.getMuted()}},{key:'getCurrentTime',value:function getCurrentTime(){return this._videoImpl.getCurrentTime()}},{key:'getDuration',value:function getDuration(){return this._videoImpl.getDuration()}},{key:'getPaused',value:function getPaused(){return this._videoImpl.getPaused()}},{key:'getEnded',value:function getEnded(){return this._videoImpl.getEnded()}},{key:'getBufferedPercentage',value:function getBufferedPercentage(){var currentTime=this.getCurrentTime();var duration=this.getDuration();if(isNaN(duration)||duration===Infinity){return 0}
var buffered=this._videoImpl.getBuffered();if(buffered.length){for(var i=0;i<buffered.length;i++){if(buffered.start(i)<=currentTime&&buffered.end(i)>currentTime){return buffered.end(i)/duration*100}}}
return currentTime/duration*100}},{key:'setCurrentTime',value:function setCurrentTime(time){return this._videoImpl.setCurrentTime(time)}},{key:'setVolume',value:function setVolume(volume){this.trigger('uservolumechange');return this._videoImpl.setVolume(volume)}},{key:'setMuted',value:function setMuted(muted){this.trigger('uservolumechange');this._videoImpl.setMuted(muted)}},{key:'setSrc',value:function setSrc(url){this._videoImpl.setSrc(url)}},{key:'getCurrentSrc',value:function getCurrentSrc(){return this._videoImpl.getCurrentSrc()}},{key:'setControls',value:function setControls(enable){return this._videoImpl.setControls(enable)}},{key:'getMediaHeight',value:function getMediaHeight(){return this._videoImpl.getMediaElement().videoHeight}},{key:'getMediaWidth',value:function getMediaWidth(){return this._videoImpl.getMediaElement().videoWidth}},{key:'supportsPictureInPicture',value:function supportsPictureInPicture(){return this._videoImpl.supportsPictureInPicture()}},{key:'isPictureInPicture',value:function isPictureInPicture(){return this._videoImpl.isPictureInPicture()}},{key:'setPictureInPicture',value:function setPictureInPicture(enable){return this._videoImpl.setPictureInPicture(enable)}},{key:'supportsAirPlay',value:function supportsAirPlay(){return this._videoImpl.supportsAirPlay()}},{key:'isLive',value:function isLive(){return this._isLive}},{key:'refreshSize',value:function refreshSize(){if(this._breakpointDetect){this._breakpointDetect.refresh()}else{this._currentBreakpoint&&this.el.classList.remove(this._currentBreakpoint.name);this._currentBreakpoint=BreakpointDetect.getBreakpointFromElement(this.el,DEFAULT_BREAKPOINTS);this.el.classList.add(this._currentBreakpoint.name)}
this._videoImpl.refreshSize()}},{key:'_setError',value:function _setError(error){if(error){this.el.classList.add('media-error')}else{this.el.classList.remove('media-error')}}},{key:'_onError',value:function _onError(evt){var err=this._videoImpl.getError();if(this._started){log('ERROR: an error occured during playback, but we\'ll try to recover. Error code '+(err?err.message:'unknown'));return}
this._setError(!0);if(!this.controls){return}
var msg=void 0;if(evt.message){msg=evt.message}else{if(!Localization.translationReady()){Localization.getTranslation({callback:this._onError.bind(this,evt)});return}
msg=Localization.getTranslation().error}
this._poster.show();this._errorView.setText(msg)}},{key:'_onChapterChange',value:function _onChapterChange(chapter){this.trigger('chapter:change')}},{key:'getChapters',value:function getChapters(){return this._chapterEmitter.chapters}},{key:'setChapters',value:function setChapters(chapters){this._chapterEmitter.chapters=chapters}},{key:'getChapterForTime',value:function getChapterForTime(time){var fudgeFactor=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;return this._chapterEmitter.getChapterForTime(time,fudgeFactor)}},{key:'isStalled',value:function isStalled(){return this._videoImpl.isStalled()}},{key:'destroy',value:function destroy(){this._removeEventListeners();if(this.controls){this.controls.destroy();this.controls=null}
if(this._poster){this._poster.destroy();this._poster=null}
if(this._controlsInteraction){this._controlsInteraction.destroy();this._controlsInteraction=null}
if(this._keyboardControl){this._keyboardControl.destroy()}
this.el.innerHTML='';if(this._breakpointDetect){this._breakpointDetect.destroy()}
if(this._chapterEmitter){this._chapterEmitter.destroy()}
if(this._blockade){this._blockade=null}
this._videoImpl.destroy();this._videoImpl=null;clearTimeout(this._refreshSizeTimeout);EventEmitter.prototype.destroy.call(this)}}]);return Player}(EventEmitter);Player.LOADEDMETADATA=1;Player.LOADEDDATA=2;Player.CANPLAY=3;Player.CANPLAYTHROUGH=4;module.exports=Player},{"../chapters/ChapterEmitter":200,"../dom-emitter/DOMEmitterMicro":201,"../event-emitter-shim/EventEmitterShim":202,"../posterframe/PosterFrameFactory":211,"../ui/DefaultBreakpoints":220,"../ui/controls-interaction/createControlsInteraction":240,"../ui/error/ErrorView":251,"../ui/keyboard-control/createKeyboardControl":257,"../ui/localization/Localization":260,"../utils/BreakpointDetect":273,"../utils/getVersion":275,"../video/VideoFactory":285,"./event/EventsToForward":206,"./event/ReadyStateChangeEvents":207,"@marcom/ac-accessibility/helpers/hide":26,"@marcom/ac-accessibility/helpers/show":29,"@marcom/ac-console/log":51,"@marcom/ac-feature/isDesktop":94,"@marcom/ac-feature/isHandheld":95,"@marcom/ac-feature/isRetina":96,"@marcom/ac-feature/touchAvailable":98,"@marcom/ac-fullscreen":100,"@marcom/ac-raf-emitter/cancelUpdate":152,"@marcom/ac-raf-emitter/update":154,"@marcom/useragent-detect":308}],205:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var Player=require('./Player');var createControlsInteraction=require('../ui/controls-interaction/createControlsInteraction');var os=require('@marcom/useragent-detect').os;var IS_MOBILE=os.ios||os.android||!require('@marcom/ac-feature/isDesktop')();var THREE_SIXTY_UI_CLASS='threesixty-ui';var ThreeSixtyPlayer=function(_Player){_inherits(ThreeSixtyPlayer,_Player);function ThreeSixtyPlayer(options){_classCallCheck(this,ThreeSixtyPlayer);var _this=_possibleConstructorReturn(this,(ThreeSixtyPlayer.__proto__||Object.getPrototypeOf(ThreeSixtyPlayer)).call(this,options));if(options.threesixty){_this.el.classList.add('threesixty-video')}
return _this}
_createClass(ThreeSixtyPlayer,[{key:'_bindMethods',value:function _bindMethods(){_get(ThreeSixtyPlayer.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyPlayer.prototype),'_bindMethods',this).call(this);this._showCompass=this._showCompass.bind(this);this._hideCompass=this._hideCompass.bind(this);this.panToOrigin=this.panToOrigin.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){_get(ThreeSixtyPlayer.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyPlayer.prototype),'_addEventListeners',this).call(this)}},{key:'_removeEventListeners',value:function _removeEventListeners(){_get(ThreeSixtyPlayer.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyPlayer.prototype),'_removeEventListeners',this).call(this);this.controls.compass.removeEventListener('click',this.panToOrigin)}},{key:'_showCompass',value:function _showCompass(){this.el.classList.add(THREE_SIXTY_UI_CLASS)}},{key:'_hideCompass',value:function _hideCompass(){this.el.classList.remove(THREE_SIXTY_UI_CLASS)}},{key:'_instantiateDefaultCustomUIControls',value:function _instantiateDefaultCustomUIControls(){this.controls=this._controlsFactory.create({player:this,endState:this.options.endState,threesixty:!0,enableMainControls:!0,basePath:this.options.localizationBasePath,template:this.options.template,readyCallback:function(){if(!this.options.autoplay||IS_MOBILE){this._showStartState()}
this.trigger('controlsready')}.bind(this)});if(this.controls.el.parentNode!==this.el){this.el.appendChild(this.controls.el)}
this._videoImpl.setControls(!1);this._createBlockade();this._controlsInteraction=createControlsInteraction({player:this,keyboardControl:this._keyboardControl,threesixty:!0,controlsTimeoutDuration:this.options.controlsTimeoutDuration,threesixtyElementsTimeoutDuration:this.options.threesixtyElementsTimeoutDuration,showControls:this._showControls,hideControls:this._hideControls,raiseControls:this._raiseControls,lowerControls:this._lowerControls,showCompass:this._showCompass,hideCompass:this._hideCompass,controlsVisible:function(){return this._controlsVisible}.bind(this),sendMouseDown:this._videoImpl.sendMouseDown,elementEmitter:this._elementEmitter});return this.controls}},{key:'panToOrigin',value:function panToOrigin(){this.get360().panToPosition({lat:0,lon:0})}},{key:'get360',value:function get360(){return this._videoImpl.get360()}},{key:'getFullScreenElement',value:function getFullScreenElement(){return this.el}},{key:'getFullScreenEnabled',value:function getFullScreenEnabled(){if(IS_MOBILE){return!1}else{return _get(ThreeSixtyPlayer.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyPlayer.prototype),'getFullScreenEnabled',this).call(this)}}}]);return ThreeSixtyPlayer}(Player);module.exports=ThreeSixtyPlayer},{"../ui/controls-interaction/createControlsInteraction":240,"./Player":204,"@marcom/ac-feature/isDesktop":94,"@marcom/useragent-detect":308}],206:[function(require,module,exports){'use strict';module.exports=['loadstart','progress','suspend','abort','error','emptied','stalled','play','pause','loadedmetadata','loadeddata','waiting','playing','canplay','canplaythrough','seeking','seeked','ended','ratechange','durationchange','volumechange','addtrack','change','removetrack']},{}],207:[function(require,module,exports){'use strict';module.exports=['loadstart','suspend','abort','error','emptied','stalled','loadedmetadata','loadeddata','waiting','canplay','canplaythrough']},{}],208:[function(require,module,exports){'use strict';var IS_DESKTOP=require('@marcom/ac-feature/isDesktop')();module.exports=function createPlayer(options){if(!options){options={}}else if(arguments.length>1){options=Object.assign.apply(null,Array.prototype.slice.apply(arguments))}
if(!options.components){options.components=require('../../ui/DefaultComponents')}
if(typeof options.controls==='undefined'){options.controls=!0}
if(!options.controlsImplementation){options.controlsImplementation=require('../../ui/ControlBar')}
if(!options.controlsFactory){options.controlsFactory=require('../../ui/ControlsFactory')({controlsImplementation:options.controlsImplementation,components:options.components,template:options.controlsTemplate})}
if(typeof options.urlOptimizer!=='undefined'&&options.urlOptimizer===!0||options.urlOptimizer==='true'){options.urlOptimizer=require('../../optimizeVideoUrl')}
if(!options.sources&&!options.src){options.sources=[]}else if(!options.sources){options.sources=options.src?[options.src]:[]}
options.autoplay=options.autoplay!==undefined?options.autoplay:IS_DESKTOP;if(!options.controlsTimeoutDuration){options.controlsTimeoutDuration=3000}
var player;if(options.threesixty){if(!options.threesixtyElementsTimeoutDuration){options.threesixtyElementsTimeoutDuration=3000}
var ThreeSixtyPlayer=require('../ThreeSixtyPlayer');player=new ThreeSixtyPlayer(options)}else{var Player=require('../Player');player=new Player(options)}
var metadata={};if(options.sharing){metadata.sharing=Object.assign({},options.sharing)}
if(options.thumbnails){metadata.thumbnails=Object.assign({},options.thumbnails)}
if(options.endState){metadata.endState=Object.assign({},options.endState)}
if(options.sources&&options.sources.length){if(options.autoplay||!options.preload||options.preload==='auto'||options.preload===!0){player.load(options.sources,options.textTracks,options.startTime,metadata)}else{player.setSrc(options.sources[0])}}
return player}},{"../../optimizeVideoUrl":203,"../../ui/ControlBar":218,"../../ui/ControlsFactory":219,"../../ui/DefaultComponents":221,"../Player":204,"../ThreeSixtyPlayer":205,"@marcom/ac-feature/isDesktop":94}],209:[function(require,module,exports){'use strict';module.exports=require('./createPlayer')},{"./createPlayer":208}],210:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var POSTER_CLASS='ac-video-poster';var POSTER_HIDDEN_CLASS='ac-video-poster-hide';var PosterFrame=function(){function PosterFrame(options){_classCallCheck(this,PosterFrame);this.options=options;this._defaultSrc=options.src;this._initialize()}
_createClass(PosterFrame,[{key:'_initialize',value:function _initialize(){var source=this.options.src;this.el=this.options.el||document.createElement('div');this._imgElement=document.createElement('img');this._imgElement.src=source;this._currentSrc=source;this._imgElement.alt='';this._onLoad=this._onLoad.bind(this);this._imgElement.addEventListener('load',this._onLoad);this.el.appendChild(this._imgElement);this.hide();this.el.classList.add(POSTER_CLASS)}},{key:'hide',value:function hide(){this.el.classList.add(POSTER_HIDDEN_CLASS)}},{key:'show',value:function show(){this.el.classList.remove(POSTER_HIDDEN_CLASS)}},{key:'setSrc',value:function setSrc(src){var newSrc=src||this._defaultSrc;if(newSrc!==this._currentSrc){this._imgElement.style.display='none';this._imgElement.src=newSrc;this._currentSrc=newSrc}}},{key:'_onLoad',value:function _onLoad(){this._imgElement.style.display=''}},{key:'getSrc',value:function getSrc(){return this._imgElement.src}},{key:'destroy',value:function destroy(){this._imgElement.removeEventListener('load',this._onLoad);this._el=null}}]);return PosterFrame}();module.exports=PosterFrame},{}],211:[function(require,module,exports){'use strict';var PosterFrame=require('./PosterFrame');var DEFAULT_SRC={'1x':'/ac/ac-video-posterframe/4.0/images/ac_video_poster_960x540.jpg','2x':'/ac/ac-video-posterframe/4.0/images/ac_video_poster_960x540_2x.jpg'};module.exports=function createPosterFrame(options){options.src=options.src||(options.is2x?DEFAULT_SRC['2x']:DEFAULT_SRC['1x']);if(!options.useNativePoster){return new PosterFrame(options)}else{options.video.setPoster(options.src);var showing=!1;var cachedUrl=void 0;return{show:function show(){showing=!0;if(cachedUrl){options.video.setPoster(cachedUrl);cachedUrl=null}},hide:function hide(){showing=!1},setSrc:function setSrc(src){if(!showing){cachedUrl=src}else if(src){options.video.setPoster(src)}else{options.video.setPoster(options.src)}}}}}},{"./PosterFrame":210}],212:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var http=require('@marcom/ac-ajax-xhr');var throttle=require('@marcom/ac-function/throttle');var parseVTT=require('./parseVTT');var TextTracksBehavior=function(){function TextTracksBehavior(view,options){_classCallCheck(this,TextTracksBehavior);this._view=view;this._video=options.video;this._refreshTracks=this._refreshTracks.bind(this);this._throttledRefreshCurrentCaption=throttle(this._refreshCurrentCaption.bind(this,300));this._addTrackListeners()}
_createClass(TextTracksBehavior,[{key:'_addTrackListeners',value:function _addTrackListeners(){this._video.on('addtrack',this._refreshTracks);this._video.on('removetrack',this._refreshTracks);this._video.on('change',this._refreshTracks)}},{key:'_addVideoListeners',value:function _addVideoListeners(track){if(!track.cues){this._view.setText('');try{http.get(track.src,{complete:function(response){track.cues=parseVTT(response.responseText);this._addVideoListeners(track);this._refreshCurrentCaption()}.bind(this),error:function(error){}.bind(this)})}catch(e){}}
this._video.on('loadstart',this._refreshTracks);this._video.on('timeupdate',this._throttledRefreshCurrentCaption)}},{key:'_removeVideoListeners',value:function _removeVideoListeners(){this._video.off('loadstart',this._refreshTracks);this._video.off('timeupdate',this._throttledRefreshCurrentCaption)}},{key:'_refreshTracks',value:function _refreshTracks(){var tracks=this._video.getTextTracks();if(tracks&&tracks.length){tracks=tracks.filter(function(t){return t.mode==='showing'})}
if(tracks.length){this._activeTrack=tracks[0];this._addVideoListeners(this._activeTrack)}else{this._activeTrack=null;this._removeVideoListeners()}
this._refreshCurrentCaption()}},{key:'_getCurrentCaptionText',value:function _getCurrentCaptionText(time){var cues=this._activeTrack?this._activeTrack.cues:null;if(!cues){return''}else if(this._currentCaption&&this._currentCaption.startTime>=time&&this._currentCaption<=time){return this._currentCaption.text}
var i=0;var len=cues.length;var closest=void 0;while(i<len){if(cues[i].startTime<=time&&cues[i].endTime>=time){closest=cues[i]}else if(cues[i].startTime>=time){break}
i++}
this._currentCaption=closest;return closest?closest.text:''}},{key:'_refreshCurrentCaption',value:function _refreshCurrentCaption(){this._view.setText(this._getCurrentCaptionText(this._video.getCurrentTime()))}},{key:'destroy',value:function destroy(){this._removeVideoListeners()}}]);return TextTracksBehavior}();module.exports=TextTracksBehavior},{"./parseVTT":217,"@marcom/ac-ajax-xhr":33,"@marcom/ac-function/throttle":108}],213:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var createComponents=require('../ui/factory/createComponents');var TextTracksBehavior=require('./TextTracksBehavior');var Label=require('../ui/elements/Label');var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var TEMPLATE='<div class="ac-video-player-text-track"></div>';var VISIBLE_CLASS='is-visible';var CONTAINER_CLASS='ac-video-player-text-track-container';var COMPONENTS_DEFINITION={textTracksPolyfill:{className:'ac-video-player-text-track',view:{classDef:Label,options:{}},behavior:{classDef:TextTracksBehavior}}};var TextTracksDOM=function(_EventEmitterMicro){_inherits(TextTracksDOM,_EventEmitterMicro);function TextTracksDOM(options){_classCallCheck(this,TextTracksDOM);var _this=_possibleConstructorReturn(this,(TextTracksDOM.__proto__||Object.getPrototypeOf(TextTracksDOM)).call(this,options));_this.container=options.container;_this._video=options.video;_this._initialize(options);return _this}
_createClass(TextTracksDOM,[{key:'_initialize',value:function _initialize(options){this._onTrackChange=this._onTrackChange.bind(this);this.el=document.createElement('div');this.el.innerHTML=options.template||TEMPLATE;this.el.classList.add(CONTAINER_CLASS);this._tracks=options.tracks||[];this._textTrackComponent=createComponents(this.el,COMPONENTS_DEFINITION,{video:this._video})}},{key:'_onTrackChange',value:function _onTrackChange(){this.trigger('change');if(!this.el.parentElement){this._video.getRenderElement().parentElement.appendChild(this.el);this.el.firstElementChild.classList.add(VISIBLE_CLASS)}}},{key:'addTrack',value:function addTrack(textTrack){if(!this._tracks){this._tracks=[]}
var mode=textTrack.mode||'hidden';var onChange=this._onTrackChange;Object.defineProperty(textTrack,'mode',{get:function get(){return mode},set:function set(newValue){mode=newValue;onChange()},enumerable:!0,configurable:!0});this._tracks.push(textTrack);this.trigger('addtrack')}},{key:'clearTracks',value:function clearTracks(){this._tracks=[];this.trigger('removetrack');this.trigger('change')}},{key:'getTextTracks',value:function getTextTracks(){return this._tracks}},{key:'trigger',value:function trigger(eventName,data){return _get(TextTracksDOM.prototype.__proto__||Object.getPrototypeOf(TextTracksDOM.prototype),'trigger',this).call(this,eventName,Object.assign({type:eventName},data||{}))}},{key:'destroy',value:function destroy(){this._textTrackComponent.destroy();_get(TextTracksDOM.prototype.__proto__||Object.getPrototypeOf(TextTracksDOM.prototype),'destroy',this).call(this)}}]);return TextTracksDOM}(EventEmitterMicro);module.exports=TextTracksDOM},{"../ui/elements/Label":243,"../ui/factory/createComponents":253,"./TextTracksBehavior":212,"@marcom/ac-event-emitter-micro":89}],214:[function(require,module,exports){'use strict';var userAgent=require('@marcom/useragent-detect');var setTextTrackMode;if(userAgent.browser.safari){setTextTrackMode=function setTextTrackMode(track,mode){track.track.mode=mode}}else{setTextTrackMode=function setTextTrackMode(track,mode){track.mode=mode}}
var addTextTrackTag=function addTextTrackTag(textTrack){var index;if(textTrack instanceof HTMLElement){this.el.appendChild(textTrack);return}
var track=document.createElement('track');track.src=textTrack.src;track.kind='captions';track.srclang=textTrack.srclang;if(track.srclang==='en'){track.label=textTrack.label||'English'}else{track.label=textTrack.label||textTrack.srclang&&textTrack.srclang.toUpperCase()||'Unknown CC'}
if(userAgent.browser.firefox){index=this.el.textTracks.length;setTimeout(function(){this.el.appendChild(track);setTextTrackMode(this.el.textTracks[index],textTrack.mode||'hidden')}.bind(this),0)}else if(userAgent.os.android){index=this.el.textTracks.length;this.el.appendChild(track);setTextTrackMode(this.el.textTracks[index],textTrack.mode||'hidden')}else{this.el.appendChild(track);setTextTrackMode(track,textTrack.mode||'hidden')}};var getTracks=function getTracks(){return this.el.textTracks};var getEmitter=function getEmitter(){if(!this._textTracksEmitter){var DOMEmitter=require('../dom-emitter/DOMEmitterMicro');this._textTracksEmitter=new DOMEmitter(this.getTextTracks())}
return this._textTracksEmitter};var createTextTrackTags=function createTextTrackTags(textTracks){var i=0;var len=textTracks?textTracks.length:0;for(;i<len;i++){var track=textTracks[i];addTextTrackTag.call(this,track)}};var destroy=function destroy(){};module.exports={create:createTextTrackTags,add:addTextTrackTag,get:getTracks,getEmitter:getEmitter,destroy:destroy}},{"../dom-emitter/DOMEmitterMicro":201,"@marcom/useragent-detect":308}],215:[function(require,module,exports){'use strict';var TextTracksDOM=require('./TextTracksDOM');var createTextTrackPolyfill=function createTextTrackPolyfill(textTracks){if(!textTracks){return}
if(!this._textTracksPolyfill){this._textTracksPolyfill=new TextTracksDOM({video:this,tracks:textTracks,container:this._parentElement})}else{this._textTracksPolyfill.clearTracks();var i=0;var len=textTracks.length;for(;i<len;i++){this._textTracksPolyfill.addTrack(textTracks[i])}}};var addTextTrackTag=function addTextTrackTag(textTrack){return this._textTracksPolyfill.addTrack(textTrack)};var getTracks=function getTracks(){if(!this._textTracksPolyfill){this._createTextTrackTags([])}
return this._textTracksPolyfill.getTextTracks()};var getEmitter=function getEmitter(){if(!this._textTracksPolyfill){this._createTextTrackTags([])}
return this._textTracksPolyfill};var destroy=function destroy(){this._textTracksPolyfill.destroy();this._textTracksPolyfill=null};module.exports={create:createTextTrackPolyfill,add:addTextTrackTag,get:getTracks,getEmitter:getEmitter,destroy:destroy}},{"./TextTracksDOM":213}],216:[function(require,module,exports){'use strict';var ac_userAgent=require('@marcom/useragent-detect');var SUPPORTS_NATIVE_CAPTIONS=!ac_userAgent.browser.ie&&!ac_userAgent.browser.edge;module.exports=function createTextTracks(options){options=options||{};var useNative;if(options.hls){useNative=!0}else if(options.threesixty){useNative=!1}else{useNative=typeof options.useNativeCaptions==='undefined'?SUPPORTS_NATIVE_CAPTIONS:options.useNativeCaptions}
return useNative?require('./TextTracksNative'):require('./TextTracksPolyfill')}},{"./TextTracksNative":214,"./TextTracksPolyfill":215,"@marcom/useragent-detect":308}],217:[function(require,module,exports){'use strict';var Time=require('../utils/Time');module.exports=function parseVTT(captionsData){var fileContents=captionsData.split(/\n/);var timeIdentifyer=/([\d]{2}:)?[\d]{2}:[\d]{2}.[\d]{3}( --> ){1}([\d]{2}:)?[\d]{2}:[\d]{2}.[\d]{3}/;var returnData=[];var timeMarkers;var text;var i=0;var len=fileContents.length;for(i;i<len;i++){text='';if(timeIdentifyer.test(fileContents[i])){timeMarkers=fileContents[i].split(' --> ');timeMarkers[0]=timeMarkers[0].split(':').length<3?'00:'+timeMarkers[0]:timeMarkers[0];timeMarkers[1]=timeMarkers[1].split(':').length<3?'00:'+timeMarkers[1]:timeMarkers[1];while(++i&&i<len&&!timeIdentifyer.test(fileContents[i])){if(fileContents[i]!==''){text+=fileContents[i]+'<br />'}}
text=text.substr(0,text.length-6);if(i<len){i--}
returnData.push({startTime:Time.stringToNumber(timeMarkers[0].split(' ')[0]),endTime:Time.stringToNumber(timeMarkers[1].split(' ')[0]),text:text})}}
return returnData}},{"../utils/Time":274}],218:[function(require,module,exports){'use strict';var supplant=require('@marcom/ac-string/supplant');var Time=require('../utils/Time');var Localization=require('./localization/Localization');var createComponents=require('./factory/createComponents');var DEFAULT_CLASS_NAME='ac-video-controls';var DEFAULT_SKIN='control-bar-skin-default';var IS_DESKTOP=require('@marcom/ac-feature/isDesktop')();var OverlayContainer=require('./overlays/OverlayContainer');var EndStateContainer=require('./end-state/EndStateItemContainer');var Compass=require('./compass/Compass');var LoadingIndicator=require('./loading-indicator/LoadingIndicator');var merge=require('../utils/merge');var DEFAULT_CONTROLS_TEMPLATE=require('https://www.apple.com/jobs/us/templates/default-controls.html');var ControlBar=function ControlBar(options){this._initialize(options)};var proto=ControlBar.prototype;proto._initialize=function(options){this.el=options.element||document.createElement('div');this._basePath=options.basePath;this.el.style.display='none';this._template=options.template||DEFAULT_CONTROLS_TEMPLATE;this._templateData=options.templateData||Object.assign({elementClassPrefix:'controls'});this._destroyed=!1;this._localize().then(function(){if(!this._destroyed){this._initUIComponents(options);this.el.style.display=''}
if(typeof options.readyCallback==='function'){options.readyCallback()}}.bind(this))};proto._localize=function(){return new Promise(function(resolve){Localization.getTranslation({callback:function(response){resolve(response)}.bind(this),basePath:this._basePath})}.bind(this)).then(function(response){this._templateData=Object.assign(this._templateData,response)}.bind(this))};proto._renderTemplateMarkup=function(){var supplantedTemplate=supplant(this._template,this._templateData);this.el.innerHTML=supplantedTemplate};proto._initDesktopControls=function(rootElement,components){this._componentCollection=createComponents(rootElement,merge(components,{elementClassPrefix:this._templateData.elementClassPrefix,elapsedTimeIndicator:{behavior:{observe:{source:this._player,events:['timeupdate','seeking','seeked','durationchange'],update:function(view){view.setText(Time.formatTime(this._player.getCurrentTime(),this._player.getDuration()))}.bind(this)}}},remainingTimeIndicator:{behavior:{observe:{source:this._player,events:['timeupdate','seeking','seeked','durationchange'],update:function(view){view.setText(Time.formatTime(this._player.getCurrentTime()-this._player.getDuration(),this._player.getDuration()))}.bind(this)}}},volumeLevel:{view:{options:{value:this._player.getMuted()?0:this._player.getVolume()*100}}},playPauseContainer:{view:{options:{labels:{'playing':this._templateData.pause,'paused':this._templateData.play,'ended':this._templateData.replay}}}},fullScreen:{view:{options:{labels:{'initial':this._templateData.fullscreen,'on':this._templateData.exitfullscreen,'off':this._templateData.fullscreen}}}},pictureInPictureToggle:{view:{options:{labels:{'initial':this._templateData.pictureinpicture,'on':this._templateData.exitpictureinpicture,'off':this._templateData.pictureinpicture}}}}}),{player:this._player,localization:this._templateData})};proto._initUIComponents=function(options){this._player=options.player;var rootElement=this.el;var components=options.components;rootElement.classList.add(options.className||DEFAULT_CLASS_NAME);this._renderTemplateMarkup();var mainControlsContainer=rootElement.querySelector('.main-controls-container');if(mainControlsContainer){if(!options.enableMainControls){mainControlsContainer.parentElement.removeChild(mainControlsContainer)}else{mainControlsContainer.classList.add(DEFAULT_SKIN);this.mainControlsElement=mainControlsContainer}}
var endStateContainer=rootElement.querySelector('.end-state-container');if(endStateContainer){this.endState=new EndStateContainer(Object.assign({},{el:endStateContainer,player:this._player},options.endState))}
if(options.threesixty){this.compass=new Compass({rootElement:rootElement,player:this._player})}
this._initDesktopControls(rootElement,components);var shareArray=this._componentCollection.components.socialShare;this.sharingModule=shareArray&&shareArray.length?shareArray[0].behavior.sharingModule:null;if(this._componentCollection.components.progressBar.length){this.scrubberView=this._componentCollection.components.progressBar[0].view}
this.playButtonElement=this.el.querySelector('.controls-play-pause-button');if(IS_DESKTOP&&options.enableMainControls){this.overlays=new OverlayContainer({el:this.el.querySelector('.ac-video-overlay-container'),player:this._player})}
this._loadingIndicator=new LoadingIndicator({player:this._player,el:this.el.querySelector('.loading-indicator-container')})};proto.destroy=function(){if(this._componentCollection){this._componentCollection.destroy();this._componentCollection=null}
if(this.overlays){this.overlays.destroy()}
this._destroyed=!0;this._player=null;this._templateData=null};module.exports=ControlBar},{"../utils/Time":274,"../utils/merge":276,"./compass/Compass":236,"./end-state/EndStateItemContainer":250,"./factory/createComponents":253,"./loading-indicator/LoadingIndicator":258,"./localization/Localization":260,"./overlays/OverlayContainer":262,"./templates/default-controls.html":266,"@marcom/ac-feature/isDesktop":94,"@marcom/ac-string/supplant":193}],219:[function(require,module,exports){'use strict';var DEFAULTS={components:require('./DefaultComponents'),controlsImplementation:require('./ControlBar')};var ControlsFactory=function ControlsFactory(options){options=options||{};var combinedOptions=Object.assign({},DEFAULTS,options);return{create:function create(controlsOptions){var opts=Object.assign({},combinedOptions,controlsOptions);opts.components=options.components||DEFAULTS.components;return new opts.controlsImplementation(opts)}}};module.exports=ControlsFactory},{"./ControlBar":218,"./DefaultComponents":221}],220:[function(require,module,exports){'use strict';module.exports=[{name:'small',minWidth:0,maxWidth:569},{name:'medium',minWidth:570,maxWidth:779},{name:'large',minWidth:780,maxWidth:Infinity}]},{}],221:[function(require,module,exports){'use strict';var Button=require('./elements/Button');var StatefulButton=require('./elements/StatefulButton');var ToggleButton=require('./elements/ToggleButton');var Label=require('./elements/Label');var ListSelector=require('./elements/ListSelector');var Slider=require('./elements/Slider');var Container=require('./elements/Container');var MuteButtonBehavior=require('./behaviors/MuteButtonBehavior');var PlayPauseButtonBehavior=require('./behaviors/PlayPauseButtonBehavior');var PictureInPictureButtonBehavior=require('./behaviors/PictureInPictureButtonBehavior');var CaptionsButtonBehavior=require('./behaviors/CaptionsButtonBehavior');var CaptionsSelectorBehavior=require('./behaviors/CaptionsSelectorBehavior');var FullScreenButtonBehavior=require('./behaviors/FullScreenButtonBehavior');var ProgressBarSliderBehavior=require('./behaviors/ProgressBarSliderBehavior');var VolumeSliderBehavior=require('./behaviors/VolumeSliderBehavior');var SharingButtonBehavior=require('./behaviors/SharingButtonBehavior');var SocialContainerBehavior=require('./behaviors/SocialContainerBehavior');var AirPlayButtonBehavior=require('./behaviors/AirPlayButtonBehavior');var CursorPointer=require('./elements/mixins/CursorPointer');var PROGRESS_BAR_TEMPLATE=require('https://www.apple.com/jobs/us/templates/progress-slider.html');var VOLUME_BAR_TEMPLATE=require('https://www.apple.com/jobs/us/templates/volume-slider.html');module.exports={back30Seconds:{className:'back-30-seconds-button',view:{classDef:Button}},fullScreen:{className:'full-screen-button',view:{classDef:ToggleButton,options:{states:{'initial':'fullscreen-unsupported','on':'is-fullscreen','off':''},labels:{'initial':'fullscreen','on':'exitfullscreen','off':'fullscreen'}}},behavior:{classDef:FullScreenButtonBehavior}},toggleMuteVolume:{className:'toggle-mute-volume-button',view:{classDef:ToggleButton,options:{states:{'initial':[],'on':['is-muted'],'off':[]}}},behavior:{classDef:MuteButtonBehavior}},playPauseContainer:{className:'play-pause-button-container',view:{classDef:StatefulButton,options:{states:{'playing':['is-playing'],'paused':[],'ended':['is-ended']}}},behavior:{classDef:PlayPauseButtonBehavior}},pictureInPictureToggle:{className:'picture-in-picture-button',view:{classDef:ToggleButton,options:{states:{'initial':['picture-in-picture-unsupported'],'on':['is-picture-in-picture'],'off':[]},labels:{'initial':'pictureinpicture','on':'exitpictureinpicture','off':'pictureinpicture'}}},behavior:{classDef:PictureInPictureButtonBehavior}},captionsToggle:{className:'text-tracks-toggle-button',view:{classDef:ToggleButton,options:{states:{'initial':['no-text-tracks'],'on':['text-tracks-visible'],'off':[]}}},behavior:{classDef:CaptionsButtonBehavior}},captionsSelector:{className:'captions-selector',view:{classDef:ListSelector},behavior:{classDef:CaptionsSelectorBehavior}},airplayToggle:{className:'airplay-button',view:{classDef:ToggleButton,options:{states:{'initial':['airplay-unsupported'],'on':['airplay-active'],'off':[]}}},behavior:{classDef:AirPlayButtonBehavior}},elapsedTimeIndicator:{className:'elapsed-time',view:{classDef:Label}},remainingTimeIndicator:{className:'remaining-time',view:{classDef:Label}},progressBar:{className:'progress-indicator',view:{classDef:Slider,options:{template:PROGRESS_BAR_TEMPLATE,min:0,max:1,mixins:[CursorPointer],orientation:'horizontal'}},behavior:{classDef:ProgressBarSliderBehavior}},volumeLevel:{className:'volume-level-indicator',view:{classDef:Slider,options:{template:VOLUME_BAR_TEMPLATE,min:0,max:100,mixins:[CursorPointer],orientation:'vertical'}},behavior:{classDef:VolumeSliderBehavior}},sharing:{className:'sharing-button',view:{classDef:StatefulButton,options:{states:{'initial':['sharing-unsupported'],'on':['is-sharing'],'off':[]}}},behavior:{classDef:SharingButtonBehavior}},socialShare:{className:'social-tray',view:{classDef:Container,options:{}},behavior:{classDef:SocialContainerBehavior}}}},{"./behaviors/AirPlayButtonBehavior":222,"./behaviors/CaptionsButtonBehavior":225,"./behaviors/CaptionsSelectorBehavior":226,"./behaviors/FullScreenButtonBehavior":227,"./behaviors/MuteButtonBehavior":228,"./behaviors/PictureInPictureButtonBehavior":229,"./behaviors/PlayPauseButtonBehavior":230,"./behaviors/ProgressBarSliderBehavior":231,"./behaviors/SharingButtonBehavior":232,"./behaviors/SocialContainerBehavior":233,"./behaviors/VolumeSliderBehavior":234,"./elements/Button":241,"./elements/Container":242,"./elements/Label":243,"./elements/ListSelector":244,"./elements/Slider":245,"./elements/StatefulButton":246,"./elements/ToggleButton":247,"./elements/mixins/CursorPointer":248,"./templates/progress-slider.html":268,"./templates/volume-slider.html":272}],222:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var ButtonBehavior=require('./ButtonBehavior');var AirPlayButtonBehavior=function(_ButtonBehavior){_inherits(AirPlayButtonBehavior,_ButtonBehavior);function AirPlayButtonBehavior(view,options){_classCallCheck(this,AirPlayButtonBehavior);var _this=_possibleConstructorReturn(this,(AirPlayButtonBehavior.__proto__||Object.getPrototypeOf(AirPlayButtonBehavior)).call(this,view,options));if(_this._player.supportsAirPlay()){_this._airplayStateChange=_this._airplayStateChange.bind(_this);_this._player.getMediaElement().addEventListener('webkitplaybacktargetavailabilitychanged',_this._airplayStateChange);_this._updateState=_this._updateState.bind(_this);_this._player.getMediaElement().addEventListener('webkitcurrentplaybacktargetiswirelesschanged',_this._updateState)}
return _this}
_createClass(AirPlayButtonBehavior,[{key:'_airplayStateChange',value:function _airplayStateChange(evt){if(evt.availability==='available'){this._airplayAvailable=!0}else{this._airplayAvailable=!1}
this._updateState()}},{key:'_updateState',value:function _updateState(){if(this._player.getMediaElement().webkitCurrentPlaybackTargetIsWireless){this._view.setState('on')}else if(this._airplayAvailable){this._view.setState('off')}else{this._view.setState('initial')}}},{key:'_onClick',value:function _onClick(){this._player.getMediaElement().webkitShowPlaybackTargetPicker()}},{key:'destroy',value:function destroy(){this._player.getMediaElement().removeEventListener('webkitplaybacktargetavailabilitychanged',this._airplayStateChange);this._player.getMediaElement().removeEventListener('webkitcurrentplaybacktargetiswirelesschanged',this._updateState);_get(AirPlayButtonBehavior.prototype.__proto__||Object.getPrototypeOf(AirPlayButtonBehavior.prototype),'destroy',this).call(this)}}]);return AirPlayButtonBehavior}(ButtonBehavior);module.exports=AirPlayButtonBehavior},{"./ButtonBehavior":224}],223:[function(require,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var BaseBehavior=function BaseBehavior(view,options){_classCallCheck(this,BaseBehavior);this._player=options.player;this._view=view;if(this._addViewListeners){this._addViewListeners()}
if(this._addPlayerListeners){this._addPlayerListeners()}};module.exports=BaseBehavior},{}],224:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var Base=require('./BaseBehavior');var ButtonBehavior=function(_Base){_inherits(ButtonBehavior,_Base);function ButtonBehavior(view,options){_classCallCheck(this,ButtonBehavior);return _possibleConstructorReturn(this,(ButtonBehavior.__proto__||Object.getPrototypeOf(ButtonBehavior)).call(this,view,options))}
_createClass(ButtonBehavior,[{key:'_initialize',value:function _initialize(){this._onClick=this._onClick.bind(this)}},{key:'_addViewListeners',value:function _addViewListeners(){this._initialize();this._view.on('click',this._onClick)}},{key:'_onClick',value:function _onClick(evt){}},{key:'destroy',value:function destroy(){this._view.off('click',this._onClick)}}]);return ButtonBehavior}(Base);module.exports=ButtonBehavior},{"./BaseBehavior":223}],225:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var ButtonBehavior=require('./ButtonBehavior');var CaptionsButtonBehavior=function(_ButtonBehavior){_inherits(CaptionsButtonBehavior,_ButtonBehavior);function CaptionsButtonBehavior(view,options){_classCallCheck(this,CaptionsButtonBehavior);var _this=_possibleConstructorReturn(this,(CaptionsButtonBehavior.__proto__||Object.getPrototypeOf(CaptionsButtonBehavior)).call(this,view,options));_this._updateState();_this._allowMultiLanguageCaptions=!_this._player.options.disableMultiLanguageCaptions;return _this}
_createClass(CaptionsButtonBehavior,[{key:'_updateState',value:function _updateState(){var visibleTracks=this._player.getVisibleTextTracks();var tracks=this._player.getTextTracks().filter(function(track){return track.kind==='subtitles'||track.kind==='captions'||!track.kind});if(visibleTracks.length){this._view.setState('on')}else if(tracks.length){this._view.setState('off')}else{this._view.setState('initial')}}},{key:'_addPlayerListeners',value:function _addPlayerListeners(){this._updateState=this._updateState.bind(this);this._player.on('addtrack',this._updateState);this._player.on('change',this._updateState);this._player.on('removetrack',this._updateState)}},{key:'_onClick',value:function _onClick(){var visibleTracks=this._player.getVisibleTextTracks();var tracks=this._player.getTextTracks().filter(function(track){return track.kind!=='metadata'});if(tracks.length>1&&this._allowMultiLanguageCaptions){this._player.isCaptionsSelectorShowing()?this._player.hideCaptionsSelector():this._player.showCaptionsSelector()}else if(visibleTracks.length===1){tracks[0].mode='hidden'}else{tracks[0].mode='showing'}
setTimeout(this._updateState)}},{key:'destroy',value:function destroy(){this._player.off('addtrack',this._updateState);this._player.off('change',this._updateState);this._player.off('removetrack',this._updateState);_get(CaptionsButtonBehavior.prototype.__proto__||Object.getPrototypeOf(CaptionsButtonBehavior.prototype),'destroy',this).call(this)}}]);return CaptionsButtonBehavior}(ButtonBehavior);module.exports=CaptionsButtonBehavior},{"./ButtonBehavior":224}],226:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var CC_DISABLE='__CC_DISABLE';var Base=require('./BaseBehavior');var browser=require('@marcom/useragent-detect').browser;var NEEDS_SYNTHETIC_CHANGE_EVENT=browser.edge||browser.ie||browser.firefox;var Localization=require('../localization/Localization');var CaptionsSelectorBehavior=function(_Base){_inherits(CaptionsSelectorBehavior,_Base);function CaptionsSelectorBehavior(view,options){_classCallCheck(this,CaptionsSelectorBehavior);var _this=_possibleConstructorReturn(this,(CaptionsSelectorBehavior.__proto__||Object.getPrototypeOf(CaptionsSelectorBehavior)).call(this,view,options));_this._updateState();return _this}
_createClass(CaptionsSelectorBehavior,[{key:'_addViewListeners',value:function _addViewListeners(){this._onSelected=this._onSelected.bind(this);this._view.on('ItemSelected',this._onSelected)}},{key:'_updateState',value:function _updateState(){var showDisabled='showing';var tracks=this._player.getTextTracks().filter(function(track){return track.kind==='subtitles'||track.kind==='captions'||!track.kind});var mappedTracks=tracks.map(function(track){if(track.mode==='showing'){showDisabled='hidden'}
var mappedTrack={label:track.label||track.language||track.srclang&&(track.srclang.toLowerCase()==='en'?'English':track.srclang)||'Unknown CC',language:track.language};Object.defineProperty(mappedTrack,'mode',{get:function get(){return track.mode},set:function set(val){track.mode=val}});return mappedTrack});this._view.setItems([{label:Localization.getTranslation().captionsoff,language:CC_DISABLE,mode:showDisabled}].concat(mappedTracks))}},{key:'_addPlayerListeners',value:function _addPlayerListeners(){this._updateState=this._updateState.bind(this);this._player.on('addtrack',this._updateState);this._player.on('change',this._updateState);this._player.on('removetrack',this._updateState)}},{key:'_onSelected',value:function _onSelected(evt){var newTrack=evt.detail;this._player.getVisibleTextTracks().forEach(function(track){track.mode='hidden'});if(newTrack.language!==CC_DISABLE){newTrack.mode='showing'}
if(NEEDS_SYNTHETIC_CHANGE_EVENT){this._player.getMediaElement().textTracks.dispatchEvent(new CustomEvent('change'))}
setTimeout(this._updateState)}},{key:'destroy',value:function destroy(){this._player.off('addtrack',this._updateState);this._player.off('change',this._updateState);this._player.off('removetrack',this._updateState);this._view.off('ItemSelected',this._onSelected)}}]);return CaptionsSelectorBehavior}(Base);module.exports=CaptionsSelectorBehavior},{"../localization/Localization":260,"./BaseBehavior":223,"@marcom/useragent-detect":308}],227:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var ButtonBehavior=require('./ButtonBehavior');var FullScreenButtonBehavior=function(_ButtonBehavior){_inherits(FullScreenButtonBehavior,_ButtonBehavior);function FullScreenButtonBehavior(view,options){_classCallCheck(this,FullScreenButtonBehavior);var _this=_possibleConstructorReturn(this,(FullScreenButtonBehavior.__proto__||Object.getPrototypeOf(FullScreenButtonBehavior)).call(this,view,options));if(_this._player.getFullScreenEnabled()){_this._updateState()}
return _this}
_createClass(FullScreenButtonBehavior,[{key:'_addPlayerListeners',value:function _addPlayerListeners(){this._updateState=this._updateState.bind(this);this._player.on('fullscreen:change',this._updateState)}},{key:'_updateState',value:function _updateState(){this._view.setState(this._player.isFullscreen()?'on':'off')}},{key:'_onClick',value:function _onClick(){this._player.toggleFullscreen(!this._player.isFullscreen())}},{key:'destroy',value:function destroy(){this._player.off('fullscreen:change',this._updateState);_get(FullScreenButtonBehavior.prototype.__proto__||Object.getPrototypeOf(FullScreenButtonBehavior.prototype),'destroy',this).call(this)}}]);return FullScreenButtonBehavior}(ButtonBehavior);module.exports=FullScreenButtonBehavior},{"./ButtonBehavior":224}],228:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var ButtonBehavior=require('./ButtonBehavior');var MuteButtonBehavior=function(_ButtonBehavior){_inherits(MuteButtonBehavior,_ButtonBehavior);function MuteButtonBehavior(view,options){_classCallCheck(this,MuteButtonBehavior);var _this=_possibleConstructorReturn(this,(MuteButtonBehavior.__proto__||Object.getPrototypeOf(MuteButtonBehavior)).call(this,view,options));_this._updateState();return _this}
_createClass(MuteButtonBehavior,[{key:'_updateState',value:function _updateState(){this._view.setState(this._player.getMuted()?'on':'off')}},{key:'_addPlayerListeners',value:function _addPlayerListeners(){this._updateState=this._updateState.bind(this);this._player.on('volumechange',this._updateState)}},{key:'_onClick',value:function _onClick(){if(this._player.getMuted()){this._player.setMuted(!1);if(this._player.getVolume()===0){this._player.setVolume(0.1)}}else{this._player.setMuted(!0)}}},{key:'destroy',value:function destroy(){this._player.off('volumechange',this._updateState);_get(MuteButtonBehavior.prototype.__proto__||Object.getPrototypeOf(MuteButtonBehavior.prototype),'destroy',this).call(this)}}]);return MuteButtonBehavior}(ButtonBehavior);module.exports=MuteButtonBehavior},{"./ButtonBehavior":224}],229:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var ButtonBehavior=require('./ButtonBehavior');var PictureInPictureButtonBehavior=function(_ButtonBehavior){_inherits(PictureInPictureButtonBehavior,_ButtonBehavior);function PictureInPictureButtonBehavior(view,options){_classCallCheck(this,PictureInPictureButtonBehavior);return _possibleConstructorReturn(this,(PictureInPictureButtonBehavior.__proto__||Object.getPrototypeOf(PictureInPictureButtonBehavior)).call(this,view,options))}
_createClass(PictureInPictureButtonBehavior,[{key:'_initialize',value:function _initialize(){this._updateButtonState=this._updateButtonState.bind(this);if(this._player.supportsPictureInPicture()){this._updateButtonState();this._player.on('webkitpresentationmodechanged',this._updateButtonState)}
_get(PictureInPictureButtonBehavior.prototype.__proto__||Object.getPrototypeOf(PictureInPictureButtonBehavior.prototype),'_initialize',this).call(this)}},{key:'_onClick',value:function _onClick(){this._player.setPictureInPicture(!this._player.isPictureInPicture())}},{key:'_updateButtonState',value:function _updateButtonState(){this._view.setState(this._player.isPictureInPicture()?'on':'off')}},{key:'destroy',value:function destroy(){this._player.off('webkitpresentationmodechanged',this._updateButtonState);_get(PictureInPictureButtonBehavior.prototype.__proto__||Object.getPrototypeOf(PictureInPictureButtonBehavior.prototype),'destroy',this).call(this)}}]);return PictureInPictureButtonBehavior}(ButtonBehavior);module.exports=PictureInPictureButtonBehavior},{"./ButtonBehavior":224}],230:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var ButtonBehavior=require('./ButtonBehavior');var PlayPauseButtonBehavior=function(_ButtonBehavior){_inherits(PlayPauseButtonBehavior,_ButtonBehavior);function PlayPauseButtonBehavior(view,options){_classCallCheck(this,PlayPauseButtonBehavior);var _this=_possibleConstructorReturn(this,(PlayPauseButtonBehavior.__proto__||Object.getPrototypeOf(PlayPauseButtonBehavior)).call(this,view,options));_this._setPlayingState();return _this}
_createClass(PlayPauseButtonBehavior,[{key:'_addPlayerListeners',value:function _addPlayerListeners(){this._setPlayingState=this._setPlayingState.bind(this);this._player.on('play',this._setPlayingState);this._player.on('playing',this._setPlayingState);this._player.on('pause',this._setPlayingState);this._player.on('ended',this._setPlayingState)}},{key:'_onClick',value:function _onClick(){this._togglePlay()}},{key:'_setPlayingState',value:function _setPlayingState(){if(this._player.getEnded()){this._view.setState('ended')}else{this._view.setState(this._player.getPaused()?'paused':'playing')}}},{key:'_togglePlay',value:function _togglePlay(){if(this._player.getPaused()||this._player.getEnded()){this._player.play()}else{this._player.pause()}}},{key:'destroy',value:function destroy(){this._player.off('play',this._setPlayingState);this._player.off('pause',this._setPlayingState);this._player.off('playing',this._setPlayingState);this._player.off('ended',this._setPlayingState);_get(PlayPauseButtonBehavior.prototype.__proto__||Object.getPrototypeOf(PlayPauseButtonBehavior.prototype),'destroy',this).call(this)}}]);return PlayPauseButtonBehavior}(ButtonBehavior);module.exports=PlayPauseButtonBehavior},{"./ButtonBehavior":224}],231:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var Base=require('./BaseBehavior');var supplant=require('@marcom/ac-string/supplant');var IS_PLAYING='is-playing';var draw=require('@marcom/ac-raf-emitter/draw');var cancelDraw=require('@marcom/ac-raf-emitter/cancelDraw');var ProgressBarSliderBehavior=function(_Base){_inherits(ProgressBarSliderBehavior,_Base);function ProgressBarSliderBehavior(view,options){_classCallCheck(this,ProgressBarSliderBehavior);var _this=_possibleConstructorReturn(this,(ProgressBarSliderBehavior.__proto__||Object.getPrototypeOf(ProgressBarSliderBehavior)).call(this,view,options));_this._visible=!1;_this._ariaTextTemplate=options.localization.currenttimetext;_this._onDurationChange();_this._refreshChapters();return _this}
_createClass(ProgressBarSliderBehavior,[{key:'_addViewListeners',value:function _addViewListeners(){this._onSliderGrab=this._onSliderGrab.bind(this);this._onSliderChange=this._onSliderChange.bind(this);this._onSliderRelease=this._onSliderRelease.bind(this);this._onChapterClicked=this._onChapterClicked.bind(this);this._onChapterFocusIn=this._onChapterFocusIn.bind(this);this._onChapterFocusOut=this._onChapterFocusOut.bind(this);this._view.on('grab',this._onSliderGrab);this._view.on('chapter:click',this._onChapterClicked);this._view.on('chapter:focusin',this._onChapterFocusIn);this._view.on('chapter:focusout',this._onChapterFocusOut)}},{key:'_addPlayerListeners',value:function _addPlayerListeners(){this._onTimeUpdate=this._onTimeUpdate.bind(this);this._onPlay=this._onPlay.bind(this);this._onPause=this._onPause.bind(this);this._onEnded=this._onEnded.bind(this);this._onDurationChange=this._onDurationChange.bind(this);this._onProgress=this._onProgress.bind(this);this._refreshChapters=this._refreshChapters.bind(this);this._onRAF=this._onRAF.bind(this);this._player.on('durationchange',this._onDurationChange);this._player.on('loadstart',this._onEnded);this._player.on('ended',this._onEnded);this._player.on('timeupdate',this._onTimeUpdate);this._player.on('progress',this._onProgress);this._player.on('play',this._onPlay);this._player.on('pause',this._onPause);this._player.on('ended',this._onEnded);this._player.on('chapters:change',this._refreshChapters)}},{key:'_onProgress',value:function _onProgress(){this._view.setBufferedValue(this._player.getBufferedPercentage())}},{key:'_setIsPlaying',value:function _setIsPlaying(enabled){if(enabled){this._view.setState(IS_PLAYING)}else{this._view.clearState(IS_PLAYING)}}},{key:'_onPlay',value:function _onPlay(){this._setIsPlaying(!0);if(!this._player.isLive()){cancelDraw(this._timeUpdateInterval);this._raf=draw(this._onRAF)}}},{key:'_onRAF',value:function _onRAF(){this._onTimeUpdate();this._timeUpdateInterval=draw(this._onRAF)}},{key:'_onPause',value:function _onPause(){this._setIsPlaying(!1);cancelDraw(this._raf);cancelDraw(this._timeUpdateInterval);this._onTimeUpdate()}},{key:'_onEnded',value:function _onEnded(){this._onPause();this._updateSliderPosition(0)}},{key:'_onChapterClicked',value:function _onChapterClicked(chapter){this._player.setCurrentTime(chapter['start-time'])}},{key:'_onChapterFocusIn',value:function _onChapterFocusIn(chapter){this._chapterFocused=!0;this._player.controls.overlays.setPopUpPosition(chapter['start-time'])}},{key:'_onChapterFocusOut',value:function _onChapterFocusOut(chapter){this._chapterFocused=!1}},{key:'_refreshChapters',value:function _refreshChapters(){var duration=this._player.getDuration();if(duration&&!isNaN(duration)&&duration!==Math.Infinity){this._view.setChapters(this._player.getChapters().map(function(c){var startTimeInPercentage=c['start-time']/duration*100;return Object.assign({},c,{startTimeInPercentage:startTimeInPercentage+'%',startTime:startTimeInPercentage})}))}else{this._view.setChapters([])}}},{key:'_onSliderGrab',value:function _onSliderGrab(){if(this._chapterFocused){return}
this._player.off('timeupdate',this._onTimeUpdate);cancelDraw(this._timeUpdateInterval);this._view.off('grab',this._onSliderGrab);this._view.on('change',this._onSliderChange);this._view.on('release',this._onSliderRelease);this._onPause()}},{key:'_onSliderRelease',value:function _onSliderRelease(){if(this._chapterFocused){return}
this._view.off('change',this._onSliderChange);this._view.off('release',this._onSliderRelease);this._view.on('grab',this._onSliderGrab);this._player.on('timeupdate',this._onTimeUpdate);if(!this._player.getPaused()){this._onPlay()}}},{key:'_getDuration',value:function _getDuration(){if(!this._cachedDuration||!isNaN(this._cachedDuration)){this._cachedDuration=this._player.getDuration()}
return this._cachedDuration}},{key:'_getTimeAsPercent',value:function _getTimeAsPercent(){return this._player.getCurrentTime()/this._getDuration()}},{key:'_onDurationChange',value:function _onDurationChange(){this._cachedDuration=this._player.getDuration();this._updateSliderPosition(this._getTimeAsPercent());if(!this._player.getPaused()){this._onPlay()}
this._refreshChapters()}},{key:'_onSliderChange',value:function _onSliderChange(){if(this._player.getEnded()){return}
var time=this._view.getValue();this._setPlayerCurrentTime(time*this._getDuration());this._setAriaValueText(time*this._getDuration());this._updateScrubbedValue()}},{key:'_onTimeUpdate',value:function _onTimeUpdate(){this._updateSliderPosition(this._getTimeAsPercent())}},{key:'_updateSliderPosition',value:function _updateSliderPosition(position){this._view.setValue(position);this._setAriaValueText(position*this._getDuration());this._updateScrubbedValue();if(!this._visible&&!isNaN(this._getDuration())){this._view.show();this._visible=!0}}},{key:'_setAriaValueText',value:function _setAriaValueText(position){var minutes=Math.floor(position/60);var seconds=Math.ceil(position%60);this._view.setAriaValueText(supplant(this._ariaTextTemplate,{minutes:minutes,seconds:seconds}))}},{key:'_updateScrubbedValue',value:function _updateScrubbedValue(){this._view.setScrubbedValue()}},{key:'_setPlayerCurrentTime',value:function _setPlayerCurrentTime(value){this._player.setCurrentTime(value)}},{key:'_removeEventListeners',value:function _removeEventListeners(){if(this._player.chapters){this._player.chapters.off('change',this._refreshChapters)}
this._player.off('durationchange',this._onDurationChange);this._player.off('loadstart',this._onEnded);this._player.off('ended',this._onEnded);this._player.off('timeupdate',this._onTimeUpdate);this._player.off('progress',this._onTimeUpdate);this._view.off('change',this._onSliderChange);this._view.off('release',this._onSliderRelease);this._view.off('grab',this._onSliderGrab);this._view.off('chapter:click',this._onChapterClicked);this._view.off('chapter:focusin',this._onChapterFocusIn);this._view.off('chapter:focusout',this._onChapterFocusOut);this._player.off('play',this._onPlay);this._player.off('pause',this._onPause);this._player.off('ended',this._onPause);this._player.off('chapters:change',this._refreshChapters)}},{key:'destroy',value:function destroy(){this._removeEventListeners();cancelDraw(this._raf);cancelDraw(this._timeUpdateInterval);this._view=null}}]);return ProgressBarSliderBehavior}(Base);module.exports=ProgressBarSliderBehavior},{"./BaseBehavior":223,"@marcom/ac-raf-emitter/cancelDraw":151,"@marcom/ac-raf-emitter/draw":153,"@marcom/ac-string/supplant":193}],232:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var ButtonBehavior=require('./ButtonBehavior');var SharingButtonBehavior=function(_ButtonBehavior){_inherits(SharingButtonBehavior,_ButtonBehavior);function SharingButtonBehavior(view,options){_classCallCheck(this,SharingButtonBehavior);var _this=_possibleConstructorReturn(this,(SharingButtonBehavior.__proto__||Object.getPrototypeOf(SharingButtonBehavior)).call(this,view,options));if(_this._player.states){_this._updateState()}
return _this}
_createClass(SharingButtonBehavior,[{key:'_addPlayerListeners',value:function _addPlayerListeners(){this._updateState=this._updateState.bind(this);this._player.states&&this._player.states.on('statechange',this._updateState)}},{key:'_updateState',value:function _updateState(){this._stateChanging=!1;this._view.setState(this._player.states.getCurrentState()==='sharing'?'on':'off')}},{key:'_onClick',value:function _onClick(){if(this._stateChanging){return}
if(this._player.states.getCurrentState()==='sharing'){this._view.setState('off');this._player.states.setState('none')}else{this._view.setState('on');this._player.states.setState('sharing')}
this._stateChanging=!0}},{key:'destroy',value:function destroy(){this._player.states&&this._player.states.off('statechange',this._updateState);_get(SharingButtonBehavior.prototype.__proto__||Object.getPrototypeOf(SharingButtonBehavior.prototype),'destroy',this).call(this)}}]);return SharingButtonBehavior}(ButtonBehavior);module.exports=SharingButtonBehavior},{"./ButtonBehavior":224}],233:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var BaseBehavior=require('./BaseBehavior');var SharingModule=require('../sharing/SharingModule');var SocialContainerBehavior=function(_BaseBehavior){_inherits(SocialContainerBehavior,_BaseBehavior);function SocialContainerBehavior(view,options){_classCallCheck(this,SocialContainerBehavior);var _this=_possibleConstructorReturn(this,(SocialContainerBehavior.__proto__||Object.getPrototypeOf(SocialContainerBehavior)).call(this,view,options));_this._updateState();return _this}
_createClass(SocialContainerBehavior,[{key:'_updateState',value:function _updateState(){this.sharingModule=new SharingModule(Object.assign({},{player:this._player,parentView:this._view}));this.sharingModule.setData(this._player.options.sharing);this._view.el.innerHTML='';this._view.el.appendChild(this.sharingModule.el)}}]);return SocialContainerBehavior}(BaseBehavior);module.exports=SocialContainerBehavior},{"../sharing/SharingModule":265,"./BaseBehavior":223}],234:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var Base=require('./BaseBehavior');var VolumeSliderBehavior=function(_Base){_inherits(VolumeSliderBehavior,_Base);function VolumeSliderBehavior(view,options){_classCallCheck(this,VolumeSliderBehavior);var _this=_possibleConstructorReturn(this,(VolumeSliderBehavior.__proto__||Object.getPrototypeOf(VolumeSliderBehavior)).call(this,view,options));_this._hideVolume();_this._updateSliderVolumeValue();return _this}
_createClass(VolumeSliderBehavior,[{key:'_addViewListeners',value:function _addViewListeners(){this._showVolume=this._showVolume.bind(this);this._hideVolume=this._hideVolume.bind(this);this._onSliderGrab=this._onSliderGrab.bind(this);this._onSliderChange=this._onSliderChange.bind(this);this._onSliderRelease=this._onSliderRelease.bind(this);this._onFocusChange=this._onFocusChange.bind(this);this._view.on('grab',this._onSliderGrab);this._view.on('focuschange',this._onFocusChange)}},{key:'_addPlayerListeners',value:function _addPlayerListeners(){this._updateSliderVolumeValue=this._updateSliderVolumeValue.bind(this);this._onUserVolumeChange=this._onUserVolumeChange.bind(this);this._player.once('durationchange',this._updateSliderVolumeValue);this._player.on('volumechange',this._updateSliderVolumeValue);this._player.on('uservolumechange',this._onUserVolumeChange)}},{key:'_onSliderGrab',value:function _onSliderGrab(){this._cachedVolume=this._player.getVolume();this._player.off('volumechange',this._updateSliderVolumeValue);this._view.off('grab',this._onSliderGrab);this._view.on('change',this._onSliderChange);this._view.on('release',this._onSliderRelease)}},{key:'_onSliderRelease',value:function _onSliderRelease(){this._setPlayerVolume(this._view.getValue());this._view.off('change',this._onSliderChange);this._view.off('release',this._onSliderRelease);this._view.on('grab',this._onSliderGrab);this._player.on('volumechange',this._updateSliderVolumeValue)}},{key:'_onSliderChange',value:function _onSliderChange(){var val=this._view.getValue();this._setPlayerVolume(val);this._view.setScrubbedValue()}},{key:'_setPlayerVolume',value:function _setPlayerVolume(value){if(value){this._player.setMuted(!1);this._player.setVolume(value/100)}else{this._player.setMuted(!0);this._player.setVolume(this._cachedVolume)}}},{key:'_showVolume',value:function _showVolume(){this._view.show()}},{key:'_hideVolume',value:function _hideVolume(){this._view.hide()}},{key:'_onUserVolumeChange',value:function _onUserVolumeChange(){this._showVolume();clearTimeout(this._hideVolumeTimer);if(!this._view.isFocused()){this._hideVolumeTimer=setTimeout(this._hideVolume,1000)}}},{key:'_onFocusChange',value:function _onFocusChange(){if(!this._view.isFocused()){this._hideVolume()}else{this._showVolume()}}},{key:'_updateSliderVolumeValue',value:function _updateSliderVolumeValue(){if(this._player.getMuted()){this._view.setValue(0);this._view.setScrubbedValue()}else{var vol=this._player.getVolume();this._view.setValue(vol*100);this._view.setScrubbedValue()}}},{key:'_removeEventListeners',value:function _removeEventListeners(){this._player.off('durationchange',this._updateSliderVolumeValue);this._player.off('volumechange',this._updateSliderVolumeValue);this._player.off('uservolumechange',this._onUserVolumeChange);this._view.off('change',this._onSliderChange);this._view.off('release',this._onSliderRelease);this._view.off('grab',this._onSliderGrab)}},{key:'destroy',value:function destroy(){this._removeEventListeners()}}]);return VolumeSliderBehavior}(Base);module.exports=VolumeSliderBehavior},{"./BaseBehavior":223}],235:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var CLASS='ac-slider-chapter-container';var CHAPTER_LANGUAGE='en';var HIDDEN_CHAPTER_CLASS='hidden-chapter';var supplant=require('@marcom/ac-string/supplant');var Localization=require('../localization/Localization');var ChapterView=function(_EventEmitterMicro){_inherits(ChapterView,_EventEmitterMicro);function ChapterView(chapter){_classCallCheck(this,ChapterView);var _this=_possibleConstructorReturn(this,(ChapterView.__proto__||Object.getPrototypeOf(ChapterView)).call(this));_this.el=document.createElement('button');_this.el.className=CLASS;var titleItem=chapter.titles.find(function(t){return t.language===CHAPTER_LANGUAGE})||chapter.titles[0];var chapterAXTemplate=Localization.getTranslation().chapter;_this._chapterMarker=document.createElement('div');_this._chapterMarker.classList.add('ac-slider-chapter-marker');if(chapter.startTimeInPercentage==='0%'){_this.el.classList.add(HIDDEN_CHAPTER_CLASS)}
_this.el.style.left=chapter.startTimeInPercentage;_this.el.setAttribute('data-acv-chapter-time',chapter['start-time']);_this.el.tabIndex=0;_this._chapterData=chapter;_this.el.appendChild(_this._chapterMarker);var position=chapter['start-time'];var minutes=Math.floor(position/60);var seconds=Math.ceil(position%60);_this._span=document.createElement('span');_this._span.innerText=supplant(chapterAXTemplate,{chaptertitle:titleItem.title,chaptertime:supplant(Localization.getTranslation().currenttimetext,{minutes:minutes,seconds:seconds})});_this.el.firstElementChild.appendChild(_this._span);_this._onClick=_this._onClick.bind(_this);_this._onMouseOver=_this._onMouseOver.bind(_this);_this._onMouseOut=_this._onMouseOut.bind(_this);_this._onFocusIn=_this._onFocusIn.bind(_this);_this._onFocusOut=_this._onFocusOut.bind(_this);_this._onMouseDown=_this._onMouseDown.bind(_this);_this.el.addEventListener('click',_this._onClick);_this.el.addEventListener('focusin',_this._onFocusIn);_this.el.addEventListener('focusout',_this._onFocusOut);_this.el.addEventListener('mouseover',_this._onMouseOver);_this.el.addEventListener('mouseout',_this._onMouseOut);_this.el.addEventListener('mousemove',_this._onMouseMove);_this.el.addEventListener('mousedown',_this._onMouseDown);return _this}
_createClass(ChapterView,[{key:'_onClick',value:function _onClick(evt){evt.preventDefault();evt.stopPropagation();this.trigger('click',this._chapterData)}},{key:'_onMouseOver',value:function _onMouseOver(evt){evt.stopPropagation();this.trigger('mouseover',this._chapterData)}},{key:'_onMouseOut',value:function _onMouseOut(evt){this.trigger('mouseout',this._chapterData)}},{key:'_onMouseMove',value:function _onMouseMove(evt){evt.stopPropagation()}},{key:'_onMouseDown',value:function _onMouseDown(evt){evt.stopPropagation()}},{key:'_onFocusIn',value:function _onFocusIn(evt){this.trigger('focusin',this._chapterData)}},{key:'_onFocusOut',value:function _onFocusOut(evt){this.trigger('focusout',this._chapterData)}},{key:'destroy',value:function destroy(){this.el.removeEventListener('click',this._onClick);this.el.removeEventListener('focusin',this._onFocusIn);this.el.removeEventListener('focusout',this._onFocusOut);this.el.removeEventListener('mouseover',this._onMouseOver);this.el.removeEventListener('mouseout',this._onMouseOut);this.el.removeEventListener('mousemove',this._onMouseMove)}}]);return ChapterView}(EventEmitterMicro);module.exports=ChapterView},{"../localization/Localization":260,"@marcom/ac-event-emitter-micro":89,"@marcom/ac-string/supplant":193}],236:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var Keyboard=require('@marcom/ac-keyboard/Keyboard');var acUserAgent=require('@marcom/useragent-detect');var IS_MOBILE=acUserAgent.os.ios||acUserAgent.os.android;var AC360=require('@marcom/ac-360');var THREESIXTY=360;var RETURN_THRESHOLD=180;var Compass=function(){function Compass(options){_classCallCheck(this,Compass);this._rootElement=options.rootElement;this._player=options.player;this._360=this._player.get360();this.el=this._rootElement.querySelector('.compass-wrapper');this.compassRing=this.el.querySelector('.compass-ring');this.compassField=this.el.querySelector('.compass-field');this.compass=this.el.querySelector('.compass');this.compassArrows=this.el.querySelector('.compass-arrows');this.compassArrowLeft=this.el.querySelector('.compass-arrow-left');this.compassArrowRight=this.el.querySelector('.compass-arrow-right');this.compassArrowTop=this.el.querySelector('.compass-arrow-top');this.compassArrowBottom=this.el.querySelector('.compass-arrow-bottom');this._keyboard=new Keyboard(this.el);this._arrowControls=this._player.get360().arrowControls;this._bindMethods();this._addEventListeners()}
_createClass(Compass,[{key:'_bindMethods',value:function _bindMethods(){this._onFocusIn=this._onFocusIn.bind(this);this._onFocusOut=this._onFocusOut.bind(this);this._onCompassClick=this._onCompassClick.bind(this);this._onCompassMouseEnter=this._onCompassMouseEnter.bind(this);this._onCompassMouseLeave=this._onCompassMouseLeave.bind(this);this._onCompassFocusIn=this._onCompassFocusIn.bind(this);this._onCompassFocusOut=this._onCompassFocusOut.bind(this);this._onRotationTransitionEnd=this._onRotationTransitionEnd.bind(this);this._onCompassArrowsClick=this._onCompassArrowsClick.bind(this);this._on360PositionChange=this._on360PositionChange.bind(this);this._on360IconUpdate=this._on360IconUpdate.bind(this);this._transitionTiming=this._transitionTiming.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){this._player.once('controlsready',function(){if(!IS_MOBILE){this.compass.addEventListener('mouseenter',this._onCompassMouseEnter);this.compass.addEventListener('mouseleave',this._onCompassMouseLeave)}
this.el.addEventListener('focusin',this._onFocusIn);this.el.addEventListener('focusout',this._onFocusOut);this.compass.addEventListener('click',this._onCompassClick);this.compass.addEventListener('focusin',this._onCompassFocusIn);this.compass.addEventListener('focusout',this._onCompassFocusOut);this.compassArrows.addEventListener('click',this._onCompassArrowsClick);this._360.on(AC360.POSITION_CHANGE,this._on360PositionChange);this._360.on(AC360.ROTATION_START,this._transitionTiming);this._360.on(AC360.ROTATION_COMPLETE,this._onRotationTransitionEnd)}.bind(this))}},{key:'_removeEventListeners',value:function _removeEventListeners(){this.el.removeEventListener('focusin',this._onFocusIn);this.el.removeEventListener('focusout',this._onFocusOut);this.compass.removeEventListener('click',this._onCompassClick);this.compass.removeEventListener('focusin',this._onCompassFocusIn);this.compass.removeEventListener('focusout',this._onCompassFocusOut);this.compass.removeEventListener('mouseenter',this._onCompassMouseEnter);this.compass.removeEventListener('mouseleave',this._onCompassMouseLeave);this.compassArrows.removeEventListener('click',this._onCompassArrowsClick);this._360.off(AC360.POSITION_CHANGE,this._on360PositionChange);this._360.off(AC360.ROTATION_START,this._transitionTiming);this._360.off(AC360.ROTATION_COMPLETE,this._onRotationTransitionEnd)}},{key:'_showCompassArrows',value:function _showCompassArrows(){this.el.classList.add('show-arrows')}},{key:'_hideCompassArrows',value:function _hideCompassArrows(){this.el.classList.remove('show-arrows')}},{key:'_onRotationTransitionEnd',value:function _onRotationTransitionEnd(){this._compassIsRotating=!1;this._360.off(AC360.ROTATION_UPDATE,this._on360IconUpdate)}},{key:'_transitionTiming',value:function _transitionTiming(data){var time=data.time;var rotation=this._get360HorizontalAngle();this._compassIsRotating=!0;this.compassRing.style.transition='transform '+time+'ms cubic-bezier(0.25,0.1,0,1)';this.compassField.style.transition='transform '+time+'ms cubic-bezier(0.25,0.1,0,1)';var targetRotation='rotate('+THREESIXTY+'deg)';if(rotation>RETURN_THRESHOLD){this.compassRing.style.transform=targetRotation;this.compassField.style.transform=targetRotation}else if(rotation<-RETURN_THRESHOLD){this.compassRing.style.transform=targetRotation;this.compassField.style.transform=targetRotation}else{this.compassRing.style.transform='rotate(0deg)';this.compassField.style.transform='rotate(0deg)'}}},{key:'_on360IconUpdate',value:function _on360IconUpdate(evt){this.compassRing.style.transition='transform 0.1s ease';this.compassRing.style.transform='rotate('+evt.currentPosition.lon+'deg)';this.compassField.style.transition='transform 0.1s ease';this.compassField.style.transform='rotate('+evt.currentPosition.lon+'deg)'}},{key:'_onCompassClick',value:function _onCompassClick(evt){if(!this._compassIsRotating){if(this._player.get360().isAtOrigin){this._360.on(AC360.ROTATION_UPDATE,this._on360IconUpdate);this._player.get360().oscillateLongitude()}else{this._player.panToOrigin()}}}},{key:'_onCompassArrowsClick',value:function _onCompassArrowsClick(evt){switch(evt.target){case this.compassArrowLeft:this._arrowControls.leftArrowDown(evt);this._arrowControls.leftArrowUp(evt);break;case this.compassArrowRight:this._arrowControls.rightArrowDown(evt);this._arrowControls.rightArrowUp(evt);break;case this.compassArrowTop:this._arrowControls.upArrowDown(evt);this._arrowControls.upArrowUp(evt);break;case this.compassArrowBottom:this._arrowControls.downArrowDown(evt);this._arrowControls.downArrowUp(evt);break;default:break}}},{key:'_onFocusIn',value:function _onFocusIn(evt){if(evt.target!==this.compass){this._showCompassArrows()}}},{key:'_onFocusOut',value:function _onFocusOut(evt){this._hideCompassArrows()}},{key:'_onCompassFocusIn',value:function _onCompassFocusIn(evt){this._rotateFieldOfViewToOrigin()}},{key:'_onCompassFocusOut',value:function _onCompassFocusOut(evt){var rotation=this._get360HorizontalAngle();this.compassField.style.transform='rotate('+rotation+'deg)'}},{key:'_rotateFieldOfViewToOrigin',value:function _rotateFieldOfViewToOrigin(){var rotation=this._get360HorizontalAngle();this.compassField.style.transition='transform 0.3s ease';if(rotation>RETURN_THRESHOLD){this.compassField.style.transform='rotate('+THREESIXTY+'deg)'}else if(rotation<-RETURN_THRESHOLD){this.compassField.style.transform='rotate(-'+THREESIXTY+'deg)'}else{this.compassField.style.transform='rotate(0deg)'}}},{key:'_onCompassMouseEnter',value:function _onCompassMouseEnter(evt){this._hovering=!0;if(this._compassIsRotating){return}
this._rotateFieldOfViewToOrigin()}},{key:'_onCompassMouseLeave',value:function _onCompassMouseLeave(evt){this._hovering=!1;if(this._compassIsRotating){return}
var rotation=this._get360HorizontalAngle();this.compassField.style.transition='transform 0.3s ease';this.compassField.style.transform='rotate('+rotation+'deg)'}},{key:'_on360PositionChange',value:function _on360PositionChange(){var rotation=this._get360HorizontalAngle();this.compassRing.style.transition='none';this.compassRing.style.transform='rotate('+rotation+'deg)';if(!this._hovering){this.compassField.style.transition='none';this.compassField.style.transform='rotate('+rotation+'deg)'}}},{key:'_get360HorizontalAngle',value:function _get360HorizontalAngle(){var pos=this._player.get360().position;var rotation=pos.lon%THREESIXTY;return rotation}},{key:'destroy',value:function destroy(){this._removeEventListeners()}}]);return Compass}();module.exports=Compass},{"@marcom/ac-360":13,"@marcom/ac-keyboard/Keyboard":109,"@marcom/useragent-detect":308}],237:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var DefaultControlsInteraction=function(){function DefaultControlsInteraction(options){_classCallCheck(this,DefaultControlsInteraction);this._player=options.player;this.el=this._player.el;this._showControls=options.showControls;this._hideControls=options.hideControls;this._raiseControls=options.raiseControls;this._lowerControls=options.lowerControls;this._sendMouseDown=options.sendMouseDown;this._controls=this._player.controls;this._controlsVisible=options.controlsVisible;this._controlsTimeoutDuration=options.controlsTimeoutDuration;this._keyboardControl=options.keyboardControl;this._lastMouseCoords={};this._elementEmitter=options.elementEmitter;this._bindMethods();this._addEventListeners()}
_createClass(DefaultControlsInteraction,[{key:'_bindMethods',value:function _bindMethods(){this._onUserInteraction=this._onUserInteraction.bind(this);this._onFullscreenChange=this._onFullscreenChange.bind(this);this._onFullscreenWillExit=this._onFullscreenWillExit.bind(this);this._onMouseOut=this._onMouseOut.bind(this);this._onMouseLeave=this._onMouseLeave.bind(this);this._onClick=this._onClick.bind(this);this._onFocusIn=this._onFocusIn.bind(this);this._onFocusOut=this._onFocusOut.bind(this);this._onUserInteractionTimeout=this._onUserInteractionTimeout.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){this._controls.el.addEventListener('mousemove',this._onUserInteraction,!0);this._controls.el.addEventListener('click',this._onClick,!0);this._player.on('fullscreen:change',this._onFullscreenChange);this._player.on('fullscreen:willexit',this._onFullscreenWillExit);if('onmouseleave' in this.el){this._controls.el.addEventListener('mouseleave',this._onMouseLeave)}else{this._controls.el.addEventListener('mouseout',this._onMouseOut,!0)}
if(this._keyboardControl){this._keyboardControl.on('keyboardinteraction',this._onUserInteraction)}
this._elementEmitter.on('focusin',this._onFocusIn);this._elementEmitter.on('focusout',this._onFocusOut)}},{key:'_removeEventListeners',value:function _removeEventListeners(){this._controls.el.removeEventListener('mousemove',this._onUserInteraction,!0);this._controls.el.removeEventListener('click',this._onClick,!0);this._player.off('fullscreen:change',this._onFullscreenChange);this._player.off('fullscreen:willexit',this._onFullscreenWillExit);if('onmouseleave' in this.el){this._controls.el.removeEventListener('mouseleave',this._onMouseLeave)}else{this._controls.el.removeEventListener('mouseout',this._onMouseOut,!0)}
if(this._keyboardControl){this._keyboardControl.off('keyboardinteraction',this._onUserInteraction)}
this._elementEmitter.off('focusin',this._onFocusIn);this._elementEmitter.off('focusout',this._onFocusOut)}},{key:'_shouldIgnoreUserInteraction',value:function _shouldIgnoreUserInteraction(evt){if(evt&&evt.type!=='focusin'&&evt.target){if(this._isActiveArea(evt.target)){return!0}}
return!1}},{key:'_onUserInteraction',value:function _onUserInteraction(evt,ignoreCoordinates){if(evt&&(evt.type==='click'||evt.type==='focusin')){if(this._player.isCaptionsSelectorShowing()&&!evt.target.classList.contains('controls-text-tracks-toggle-button')&&evt.target.getAttribute('role')!=='radio'&&evt.target.getAttribute('role')!=='radiogroup'){this._player.hideCaptionsSelector()}}
if(!this._player.getCurrentSrc()||this._preventUserInteraction||!ignoreCoordinates&&evt&&evt.type==='mousemove'&&this._lastMouseCoords.x===evt.screenX&&this._lastMouseCoords.y===evt.screenY){return}
if(evt&&evt.pageX){this._lastMouseCoords={x:evt.screenX,y:evt.screenY}}
this._showControls();this._raiseControls();clearTimeout(this._userInteractionTimeout);if(this._shouldIgnoreUserInteraction(evt)){return}
this._userInteractionTimeout=window.setTimeout(this._onUserInteractionTimeout,this._controlsTimeoutDuration)}},{key:'_onUserInteractionTimeout',value:function _onUserInteractionTimeout(){this._hideControls()}},{key:'_onMouseLeave',value:function _onMouseLeave(evt){window.clearTimeout(this._userInteractionTimeout);this._hideControls();this._lowerControls();this._lastMouseCoords={}}},{key:'_onMouseOut',value:function _onMouseOut(evt){if(!this._controls.el.contains(evt.target)&&evt.target!==this._controls.el){this._onMouseLeave()}}},{key:'_isActiveArea',value:function _isActiveArea(el){while(el!==this.el){if(el.hasAttribute('data-acv-active-area')){return!0}
el=el.parentNode}
return!1}},{key:'_onClick',value:function _onClick(evt){this._hasFocus=!1;this._onUserInteraction(evt)}},{key:'_onFullscreenWillExit',value:function _onFullscreenWillExit(){if(this.controls){this.controls.el.display='none'}}},{key:'_onFullscreenChange',value:function _onFullscreenChange(){var _this=this;if(this.controls){this.controls.el.display=''}
this._hideControls();this._lowerControls();this._preventUserInteraction=!0;this._fullscreenChangeTimeout=setTimeout(function(){_this._preventUserInteraction=!1;_this._player.refreshSize()},750);this._player.refreshSize()}},{key:'_onFocusIn',value:function _onFocusIn(evt){clearTimeout(this._focusOutTimer);this._focusOutTimer=null;this._hasFocus=!0;this._onUserInteraction(evt)}},{key:'_onFocusOut',value:function _onFocusOut(evt){var _this2=this;this._focusOutTimer=setTimeout(function(){if(_this2._hasFocus&&!_this2.el.contains(document.activeElement)){_this2._hasFocus=!1;_this2._hideControls();_this2._lowerControls()}},100)}},{key:'destroy',value:function destroy(){clearTimeout(this._focusOutTimer);clearTimeout(this._fullscreenChangeTimeout);clearTimeout(this._userInteractionTimeout);this._removeEventListeners()}}]);return DefaultControlsInteraction}();module.exports=DefaultControlsInteraction},{}],238:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var DefaultControlsInteraction=require('./DefaultControlsInteraction');var DRAG_START_THRESHOLD=30;var DRAG_END_THRESHOLD=500;var THREESIXTY_TIMEOUT_DEFAULT=3000;var ThreeSixtyControlsInteraction=function(_DefaultControlsInter){_inherits(ThreeSixtyControlsInteraction,_DefaultControlsInter);function ThreeSixtyControlsInteraction(options){_classCallCheck(this,ThreeSixtyControlsInteraction);var _this=_possibleConstructorReturn(this,(ThreeSixtyControlsInteraction.__proto__||Object.getPrototypeOf(ThreeSixtyControlsInteraction)).call(this,options));_this._showCompass=options.showCompass;_this._hideCompass=options.hideCompass;_this._threesixtyElementsTimeoutDuration=options.threesixtyElementsTimeoutDuration||THREESIXTY_TIMEOUT_DEFAULT;_this._dragEndThreshold=DRAG_END_THRESHOLD;_this._mouseDownPosition=null;return _this}
_createClass(ThreeSixtyControlsInteraction,[{key:'_bindMethods',value:function _bindMethods(){_get(ThreeSixtyControlsInteraction.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyControlsInteraction.prototype),'_bindMethods',this).call(this);this._onMouseDown=this._onMouseDown.bind(this);this._onMouseUp=this._onMouseUp.bind(this);this._onDragging=this._onDragging.bind(this);this._onClick=this._onClick.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){_get(ThreeSixtyControlsInteraction.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyControlsInteraction.prototype),'_addEventListeners',this).call(this);this._controls.el.addEventListener('mousedown',this._onMouseDown);this._controls.el.addEventListener('click',this._onClick)}},{key:'_removeEventListeners',value:function _removeEventListeners(){_get(ThreeSixtyControlsInteraction.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyControlsInteraction.prototype),'_removeEventListeners',this).call(this);this._controls.el.removeEventListener('mousedown',this._onMouseDown)}},{key:'_onUserInteraction',value:function _onUserInteraction(evt){if(this._userWasRecentlyDragging||evt&&evt.type==='mousemove'&&this._lastMouseCoords.x===evt.screenX&&this._lastMouseCoords.y===evt.screenY||this._dragging){return}
this._showCompass();clearTimeout(this._userHideMouse);_get(ThreeSixtyControlsInteraction.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyControlsInteraction.prototype),'_onUserInteraction',this).call(this)}},{key:'_onUserInteractionTimeout',value:function _onUserInteractionTimeout(){var _this2=this;_get(ThreeSixtyControlsInteraction.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyControlsInteraction.prototype),'_onUserInteractionTimeout',this).call(this);clearTimeout(this._userHideMouse);this._userHideMouse=setTimeout(function(){_this2._hideCompass()},this._threesixtyElementsTimeoutDuration)}},{key:'_onDragging',value:function _onDragging(evt){var _this3=this;if(!this._dragging&&this._isActiveArea(evt.target)){return}
this._dragging=!0;this._player.el.classList.add('dragging');this._player.el.classList.add('recently-dragging');this._recentDragTimeout=setTimeout(function(){if(_this3._dragging){_this3._hideControls();_this3._userWasRecentlyDragging=!0;clearTimeout(_this3._dragTimer);_this3._dragTimer=setTimeout(function(){_this3._userWasRecentlyDragging=!1;_this3._player.el.classList.remove('recently-dragging')},_this3._dragEndThreshold)}},DRAG_START_THRESHOLD);clearTimeout(this._userInteractionTimeout);clearTimeout(this._userHideMouse)}},{key:'_isDraggable',value:function _isDraggable(el){var draggableElements=[this._player.controls.compass.el,this._player.controls.playButtonElement];return draggableElements.indexOf(el)!==-1||this._player.controls.compass.el.contains(el)}},{key:'_onMouseDown',value:function _onMouseDown(evt){if(this._isActiveArea(evt.target)&&this._controlsVisible()&&!this._isDraggable(evt.target)||!this._isPlayingState()){return}
this._showControls();clearTimeout(this._userHideMouse);clearTimeout(this._recentDragTimeout);this._player.el.classList.remove('dragging');this._player.el.classList.remove('recently-dragging');this._mouseDownPosition={x:evt.x,y:evt.y};window.addEventListener('mouseup',this._onMouseUp);window.addEventListener('mousemove',this._onDragging);this._sendMouseDown(evt)}},{key:'_onMouseUp',value:function _onMouseUp(evt){window.removeEventListener('mousemove',this._onDragging);window.removeEventListener('mouseup',this._onMouseUp);if(this._dragging){this._onUserInteractionTimeout()}
if(!this._player.el.contains(evt.target)){this._hideCompass()}
this._player.el.classList.remove('dragging');this._dragging=!1}},{key:'_onMouseLeave',value:function _onMouseLeave(evt){_get(ThreeSixtyControlsInteraction.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyControlsInteraction.prototype),'_onMouseLeave',this).call(this);this._userWasRecentlyDragging=!1;if(!this._dragging){clearTimeout(this._userHideMouse);this._hideCompass()}}},{key:'_onClick',value:function _onClick(evt){if(this._player.controls.compass.el.contains(evt.target)&&this._userWasRecentlyDragging){evt.stopPropagation()}
if(evt.target!==this._player.controls.playButtonElement.parentElement&&evt.target!==this._controls.el.firstElementChild||this._mouseDownPosition===null||!(this._mouseDownPosition.x===evt.x&&this._mouseDownPosition.y===evt.y)){return}
this._mouseDownPosition=null;this._mouseDownTime=Infinity;this._dragging=!1;this._userWasRecentlyDragging=!1;clearTimeout(this._dragTimer);clearTimeout(this._recentDragTimeout)}},{key:'_isPlayingState',value:function _isPlayingState(){return!this._player.controls.el.classList.contains('start-state')&&!this._player.controls.el.classList.contains('end-state')}}]);return ThreeSixtyControlsInteraction}(DefaultControlsInteraction);module.exports=ThreeSixtyControlsInteraction},{"./DefaultControlsInteraction":237}],239:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var ThreeSixtyControlsInteraction=require('./ThreeSixtyControlsInteraction');var ThreeSixtyMobileControlsInteraction=function(_ThreeSixtyControlsIn){_inherits(ThreeSixtyMobileControlsInteraction,_ThreeSixtyControlsIn);function ThreeSixtyMobileControlsInteraction(options){_classCallCheck(this,ThreeSixtyMobileControlsInteraction);var _this=_possibleConstructorReturn(this,(ThreeSixtyMobileControlsInteraction.__proto__||Object.getPrototypeOf(ThreeSixtyMobileControlsInteraction)).call(this,options));_this._controlsVisible=options.controlsVisible;return _this}
_createClass(ThreeSixtyMobileControlsInteraction,[{key:'_bindMethods',value:function _bindMethods(){_get(ThreeSixtyMobileControlsInteraction.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyMobileControlsInteraction.prototype),'_bindMethods',this).call(this);this._onTouchStart=this._onTouchStart.bind(this);this._onTouchEnd=this._onTouchEnd.bind(this);this._onClick=this._onClick.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){this._controls.el.addEventListener('touchstart',this._onTouchStart,{passive:!1});this._controls.el.addEventListener('click',this._onClick);this._controls.el.addEventListener('focusin',this._onFocusIn);this._controls.el.addEventListener('focusout',this._onFocusOut)}},{key:'_removeEventListeners',value:function _removeEventListeners(){this._controls.el.removeEventListener('touchstart',this._onTouchStart);this._controls.el.removeEventListener('touchend',this._onTouchEnd);this._controls.el.removeEventListener('click',this._onClick);this._controls.el.removeEventListener('focusin',this._onFocusIn);this._controls.el.removeEventListener('focusout',this._onFocusOut)}},{key:'_onDragging',value:function _onDragging(evt){_get(ThreeSixtyMobileControlsInteraction.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyMobileControlsInteraction.prototype),'_onDragging',this).call(this)}},{key:'_shouldIgnoreUserInteraction',value:function _shouldIgnoreUserInteraction(evt){return!1}},{key:'_onClick',value:function _onClick(evt){if(evt.target===this._player.controls.compass.compassView){return}
if(!this._controlsVisible()){this._onUserInteraction(evt)}else if(!this._isActiveArea(evt.target)){this._hideControls();this._hideCompass()}}},{key:'_onTouchStart',value:function _onTouchStart(evt){if(evt.target!==this._player.controls.playButtonElement&&evt.target!==this._controls.el.firstElementChild&&evt.target!==this._player.controls.compass.compassView&&evt.target!==this._player.controls.playButtonElement){return}
document.addEventListener('touchend',this._onTouchEnd);window.addEventListener('touchmove',this._onDragging);this._showCompass();this._touchDownTime=Date.now();this._sendMouseDown(evt)}},{key:'_onTouchEnd',value:function _onTouchEnd(evt){document.removeEventListener('touchend',this._onTouchEnd);window.removeEventListener('touchmove',this._onDragging);this._onMouseUp(evt)}}]);return ThreeSixtyMobileControlsInteraction}(ThreeSixtyControlsInteraction);module.exports=ThreeSixtyMobileControlsInteraction},{"./ThreeSixtyControlsInteraction":238}],240:[function(require,module,exports){'use strict';var userAgent=require('@marcom/useragent-detect');var IS_MOBILE=userAgent.os.ios||userAgent.os.android;var DefaultControlsInteraction=require('./DefaultControlsInteraction');var ThreeSixtyControlsInteraction=require('./ThreeSixtyControlsInteraction');var ThreeSixtyMobileControlsInteraction=require('./ThreeSixtyMobileControlsInteraction');var createControlsInteraction=function createControlsInteraction(options){if(options.threesixty){return IS_MOBILE?new ThreeSixtyMobileControlsInteraction(options):new ThreeSixtyControlsInteraction(options)}else{return new DefaultControlsInteraction(options)}};module.exports=createControlsInteraction},{"./DefaultControlsInteraction":237,"./ThreeSixtyControlsInteraction":238,"./ThreeSixtyMobileControlsInteraction":239,"@marcom/useragent-detect":308}],241:[function(require,module,exports){'use strict';function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var DOMEmitterMicro=require('../../dom-emitter/DOMEmitterMicro');var Button=function(_DOMEmitterMicro){_inherits(Button,_DOMEmitterMicro);function Button(elements){_classCallCheck(this,Button);return _possibleConstructorReturn(this,(Button.__proto__||Object.getPrototypeOf(Button)).call(this,elements))}
return Button}(DOMEmitterMicro);module.exports=Button},{"../../dom-emitter/DOMEmitterMicro":201}],242:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var Container=function(){function Container(element){_classCallCheck(this,Container);this.el=element}
_createClass(Container,[{key:'show',value:function show(){this.el.classList.remove('hidden')}},{key:'hide',value:function hide(){this.el.classList.add('hidden')}},{key:'destroy',value:function destroy(f){}}]);return Container}();module.exports=Container},{}],243:[function(require,module,exports){"use strict";var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var Label=function(){function Label(element){_classCallCheck(this,Label);this.el=element}
_createClass(Label,[{key:"setText",value:function setText(value){this.el.innerHTML=value}}]);return Label}();module.exports=Label},{}],244:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var DOMEmitterMicro=require('../../dom-emitter/DOMEmitterMicro');var Keyboard=require('@marcom/ac-keyboard/Keyboard');var keyMap=require('@marcom/ac-keyboard/keyMap');var ListSelector=function(_DOMEmitterMicro){_inherits(ListSelector,_DOMEmitterMicro);function ListSelector(element){_classCallCheck(this,ListSelector);var _this=_possibleConstructorReturn(this,(ListSelector.__proto__||Object.getPrototypeOf(ListSelector)).call(this,element));_this.el=element;_this._keyboard=new Keyboard(_this.el);_this._addEventListeners();return _this}
_createClass(ListSelector,[{key:'_addEventListeners',value:function _addEventListeners(){this._onClick=this._onClick.bind(this);this._onKeyDown=this._onKeyDown.bind(this);this.el.addEventListener('click',this._onClick);this._keyboard.onDown(keyMap.ARROW_UP,this._onKeyDown);this._keyboard.onDown(keyMap.ARROW_DOWN,this._onKeyDown)}},{key:'_removeEventListeners',value:function _removeEventListeners(){this.el.removeEventListener('click',this._onClick);this._keyboard.onDown(keyMap.ARROW_UP,this._onKeyDown);this._keyboard.onDown(keyMap.ARROW_DOWN,this._onKeyDown)}},{key:'setItems',value:function setItems(items){var _this2=this;var showingEl=void 0;this.el.innerHTML='';items.forEach(function(item){var el=document.createElement('li');el.setAttribute('role','radio');if(item.mode==='showing'){el.classList.add(item.mode);el.setAttribute('aria-checked','true');el.setAttribute('tabIndex',0);showingEl=el}else{el.setAttribute('aria-checked','false');el.setAttribute('tabIndex',-1)}
el.innerText=item.label;el.acvMetadata=item;_this2.el.appendChild(el)});if(showingEl){showingEl.focus()}}},{key:'_onKeyDown',value:function _onKeyDown(evt){var node=evt.target;var next=!1;if(parseInt(evt.keyCode)===keyMap.ARROW_DOWN){next=node.nextSibling}else if(parseInt(evt.keyCode)===keyMap.ARROW_UP){next=node.previousSibling}
if(next){this.trigger('ItemSelected',next.acvMetadata);evt.preventDefault();evt.stopPropagation()}}},{key:'_onClick',value:function _onClick(evt){if(this.el!==evt.target&&this.el.contains(evt.target)){this.trigger('ItemSelected',evt.target.acvMetadata)}}},{key:'destroy',value:function destroy(){this._removeEventListeners()}}]);return ListSelector}(DOMEmitterMicro);module.exports=ListSelector},{"../../dom-emitter/DOMEmitterMicro":201,"@marcom/ac-keyboard/Keyboard":109,"@marcom/ac-keyboard/keyMap":112}],245:[function(require,module,exports){'use strict';var _Slider=require('@marcom/ac-slider').Slider;var ChapterView=require('../chapters/ChapterView');var INACTIVE_CLASS='ac-slider-inactive';var INVERT_ELEMENT_CLASS='invert-element';var Slider=function Slider(element,options){this.el=element;this._min=options.min||0;this._max=options.max||1;if(options.mixins){var mixins=options.mixins.slice(0);while(mixins.length){Object.assign(this,mixins.pop())}}
this._slider=new _Slider(this.el,{template:options.template,min:this._min,max:this._max,step:isNaN(+this.el.getAttribute('step'))?this.el.getAttribute('step'):+this.el.getAttribute('step'),value:options.value!==undefined?options.value:+this.el.getAttribute('value'),orientation:options.orientation,renderedPosition:!0,keyboardContext:this.el});this._onFocusChange=this._onFocusChange.bind(this);this._setHoveringValue=this._setHoveringValue.bind(this);this._onMouseOver=this._onMouseOver.bind(this);this._onMouseLeave=this._onMouseLeave.bind(this);this._onChapterClicked=this._onChapterClicked.bind(this);this._onChapterFocusIn=this._onChapterFocusIn.bind(this);this._onChapterFocusOut=this._onChapterFocusOut.bind(this);this._slider.el.addEventListener('blur',this._onFocusChange);this._slider.el.addEventListener('focus',this._onFocusChange);this._slider.el.addEventListener('mouseout',this._onFocusChange);this._onGrab=this._onGrab.bind(this);this._onRelease=this._onRelease.bind(this);this._slider.on('grab',this._onGrab);this._slider.on('release',this._onRelease);this._scrubbedEl=this.el.querySelector('.ac-slider-scrubbed');this._notchEl=this.el.querySelector('.ac-slider-hover-notch');this._chapterContainer=this.el.querySelector('.ac-slider-chapters-track');this._axTrack=this.el.querySelector('.ac-slider-ax-track');this._bufferedTrack=this.el.querySelector('.ac-slider-buffered');if(this._notchEl){this._slider.el.addEventListener('mouseover',this._onMouseOver);this._slider.el.addEventListener('mouseleave',this._onMouseLeave);this._slider.el.addEventListener('mousemove',this._setHoveringValue)}
if(this._axTrack){this._axTrack.tabIndex=0;this._slider.el.tabIndex=-1;this._slider.el.setAttribute('aria-hidden','');this._slider.el.removeAttribute('aria-label');this._slider.el.removeAttribute('role')}
if(options.value){requestAnimationFrame(function(){if(this._slider){this.setValue(options.value)}}.bind(this))}};var proto=Slider.prototype;proto.on=function(){return this._slider.on.apply(this._slider,arguments)};proto.off=function(){return this._slider.off.apply(this._slider,arguments)};proto.trigger=function(){return this._slider.trigger.apply(this._slider,arguments)};proto.setValue=function(value){if(this._axTrack){this._axTrack.setAttribute('aria-valuenow',value)}
return this._slider.setValue.call(this._slider,value)};proto.setAriaValueText=function(value){if(this._axTrack){this._axTrack.setAttribute('aria-valuetext',value)}else{this._slider.el.setAttribute('aria-valuetext',value)}};proto.setMin=function(min){this._min=min;this._slider.setMin(min)};proto.setMax=function(max){this._max=max;this._slider.setMax(max)};proto._onMouseOver=function(){this._slider.el.classList.add('hover')};proto._onMouseLeave=function(){this._slider.el.classList.remove('hover')};proto._onFocusChange=function(){setTimeout(function(){this.trigger('focuschange')}.bind(this),0)};proto.isFocused=function(){return this._slider.el===document.activeElement&&this._hasFocusOutline()};proto._hasFocusOutline=function(){return getComputedStyle(this._slider.el).getPropertyValue('outline-style')!=='none'};proto.getValue=function(){return this._slider.getValue.apply(this._slider,arguments)};proto.getMax=function(){return this._max};proto.setScrubbedValue=function(){if(this._chapters){this._checkCollisionsSetValue()}
if(this._slider.getOrientation()==='horizontal'){this._scrubbedEl.style.left=this._slider.thumbElement.style.left}else{this._scrubbedEl.style.bottom=this._slider.thumbElement.style.bottom}};proto.setBufferedValue=function(value){this._bufferedTrack.style.left=value+'%'};proto._checkCollisionsSetValue=function(){for(var i=0;i<this._chapters.length;i++){var chapterMaker=this._chapters[i].el.children[0];var hasOverlap=parseInt(this._chapters[i].el.style.left)<this.getValue()/this.getMax()*100;this._setInlineBackgroundColor(!hasOverlap,chapterMaker)}};proto._setHoveringValue=function(evt){var value=this.getClientXValue(evt,this._notchEl);var valBool=value>this.getValue();this._notchEl.style.left=value/this.getMax()*100+'%';this._setInlineBackgroundColor(valBool,this._notchEl)};proto._setInlineBackgroundColor=function(value,target){if(value){target.classList.remove(INVERT_ELEMENT_CLASS)}else{target.classList.add(INVERT_ELEMENT_CLASS)}};proto._onChapterClicked=function(chapter){this.trigger('chapter:click',chapter);this._slider.thumbElement.style.pointerEvents=''};proto._onChapterFocusIn=function(chapter){this._notchEl.classList.add('hidden');this._slider.thumbElement.style.pointerEvents='none';this.trigger('chapter:focusin',chapter)};proto._onChapterFocusOut=function(chapter){this._notchEl.classList.remove('hidden');this._slider.thumbElement.style.pointerEvents='';this.trigger('chapter:focusout',chapter)};proto._onGrab=function(){this.forceCursorPointer();this.setScrubbedValue()};proto._onRelease=function(){this.disableForcedCursorPointer();this.setScrubbedValue()};proto.setChapters=function(chapters){var _this=this;if(this._chapters){this._chapters.forEach(function(c){c.off('click',_this._onChapterClicked);c.off('focusin',_this._onChapterFocusIn);c.off('focusout',_this._onChapterFocusOut);c.off('mouseover',_this._onChapterFocusIn);c.off('mouseout',_this._onChapterFocusOut);c.destroy()})}
this._chapterContainer.innerHTML='';this._chapters=[];for(var i=0;i<chapters.length;i++){if(chapters[i].startTime<100){var c=new ChapterView(chapters[i]);c.on('click',this._onChapterClicked);c.on('focusin',this._onChapterFocusIn);c.on('focusout',this._onChapterFocusOut);c.on('mouseover',this._onChapterFocusIn);c.on('mouseout',this._onChapterFocusOut);this._chapters.push(c);this._chapterContainer.appendChild(c.el)}}};proto.show=function(){this.el.classList.remove(INACTIVE_CLASS)};proto.hide=function(){this.el.classList.add(INACTIVE_CLASS)};proto.setState=function(state){this.el.classList.add(state)};proto.clearState=function(state){this.el.classList.remove(state)};proto.getClientXValue=function(evt,offsetEl){return this._slider.getClientXValue(evt,offsetEl)};proto.destroy=function(){var _this2=this;if(this._chapters){this._chapters.forEach(function(c){c.off('click',_this2._onChapterClicked);c.off('focusin',_this2._onChapterFocusIn);c.off('focusout',_this2._onChapterFocusOut);c.off('mouseover',_this2._onChapterFocusIn);c.off('mouseout',_this2._onChapterFocusOut);c.destroy()})}
this._slider.el.removeEventListener('mousemove',this._setHoveringValue);this._slider.el.removeEventListener('mouseleave',this._onMouseOver);this._slider.el.removeEventListener('mouseout',this._onMouseLeave);this._slider.el.removeEventListener('blur',this._onFocusChange);this._slider.el.removeEventListener('focus',this._onFocusChange);this._slider.el.removeEventListener('mouseout',this._onFocusChange);this._slider.off('grab',this._onGrab);this._slider.off('release',this._onRelease);this._slider.destroy();this._slider=null};module.exports=Slider},{"../chapters/ChapterView":235,"@marcom/ac-slider":166}],246:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var Button=require('./Button');var StatefulButton=function(_Button){_inherits(StatefulButton,_Button);function StatefulButton(element,options){_classCallCheck(this,StatefulButton);var _this=_possibleConstructorReturn(this,(StatefulButton.__proto__||Object.getPrototypeOf(StatefulButton)).call(this,element,options));_this._states=options.states||{};_this._labels=options.labels;_this._focusTarget=_this.el.querySelector('button')||_this.el;if(_this._states&&_this._states.initial){_this.setState('initial')}
return _this}
_createClass(StatefulButton,[{key:'setState',value:function setState(state){if(this._currentState&&this._currentState!==state&&this._states[this._currentState].length){this.el.classList.remove(this._states[this._currentState])}
this._currentState=state;if(this._labels&&this._labels[this._currentState]){this._focusTarget.value=this._labels[this._currentState];this._focusTarget.setAttribute('aria-label',this._labels[this._currentState])}
if(this._states[state].length){this.el.classList.add(this._states[state])}}}]);return StatefulButton}(Button);module.exports=StatefulButton},{"./Button":241}],247:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var StatefulButton=require('./StatefulButton');var ToggleButton=function(_StatefulButton){_inherits(ToggleButton,_StatefulButton);function ToggleButton(element,options){_classCallCheck(this,ToggleButton);return _possibleConstructorReturn(this,(ToggleButton.__proto__||Object.getPrototypeOf(ToggleButton)).call(this,element,options))}
_createClass(ToggleButton,[{key:'setState',value:function setState(state){_get(ToggleButton.prototype.__proto__||Object.getPrototypeOf(ToggleButton.prototype),'setState',this).call(this,state);if(this._currentState==='on'){this._focusTarget.setAttribute('aria-pressed',!0)}else{this._focusTarget.setAttribute('aria-pressed',!1)}}}]);return ToggleButton}(StatefulButton);module.exports=ToggleButton},{"./StatefulButton":246}],248:[function(require,module,exports){'use strict';var FORCE_CURSOR_POINTER_CLASS='cursor-pointer';module.exports={disableForcedCursorPointer:function disableForcedCursorPointer(){document.body.classList.remove(FORCE_CURSOR_POINTER_CLASS);this.onSelectStartResumeDefault()},forceCursorPointer:function forceCursorPointer(){document.body.classList.add(FORCE_CURSOR_POINTER_CLASS);this.onSelectStartPreventDefault()},onSelectStartResumeDefault:function onSelectStartResumeDefault(){document.removeEventListener('selectstart',this.preventDefault)},onSelectStartPreventDefault:function onSelectStartPreventDefault(){document.addEventListener('selectstart',this.preventDefault)},preventDefault:function preventDefault(e){e.preventDefault()}}},{}],249:[function(require,module,exports){'use strict';var HIDDEN='hidden';var template=require('https://www.apple.com/jobs/templates/states/EndStateItem.html');var EndStateItem=function EndStateItem(options){this.el=options.el;this.el.innerHTML=template;this._player=options.player;this._bindContent(options)};var proto=EndStateItem.prototype;proto._bindContent=function(options){if(options.type==='link'||options.type==='video'){var anchor=this.el.querySelector('.end-state-link');var textContainer=document.createElement('div');anchor.classList.remove(HIDDEN);textContainer.classList.add('end-state-text-container');textContainer.innerText=options.label||'';anchor.href=options.url||'';anchor.appendChild(textContainer);if(options.type==='link'){anchor.classList.add('icon','icon-after','icon-chevronright')}else if(options.type==='video'){anchor.classList.add('icon','icon-after','icon-playcircle')}
this._bindAction(this.el,options)}};proto._bindAction=function(el,options){if(typeof options.onclick==='function'){el.onclick=function(evt){evt.preventDefault();options.onclick.call(null,evt)}.bind(this)}else if(options.type==='video'&&options.url){el.onclick=function(evt){evt.preventDefault();this._player.load(options.url,null,0,{})}.bind(this)}};proto.destroy=function(){};module.exports=EndStateItem},{"../templates/states/EndStateItem.html":269}],250:[function(require,module,exports){'use strict';var EndStateItem=require('./EndStateItem');var EndStateItemContainer=function EndStateItemContainer(options){this.el=options.el;this._player=options.player;this._addItems(options.items||[])};var proto=EndStateItemContainer.prototype;proto._addItems=function(items){this._items=[];items.forEach(function(item){var el=document.createElement('div');el.classList.add('end-state-item');var esi=new EndStateItem(Object.assign({},item,{el:el,player:this._player}));this.el.appendChild(el);this._items.push(esi)}.bind(this))};proto.setData=function(options){while(this._items.length){this._items.pop().destroy()}
this.el.innerHTML='';if(options){this.el.classList.remove('hidden');this._addItems(options.items)}else{this.el.classList.add('hidden')}};proto.destroy=function(){while(this._items.length){this._items.pop().destroy()}};module.exports=EndStateItemContainer},{"./EndStateItem":249}],251:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var ErrorView=function(){function ErrorView(options){_classCallCheck(this,ErrorView);this.el=document.createElement('div');this.el.classList.add('error-state-wrapper')}
_createClass(ErrorView,[{key:'setText',value:function setText(str){this._errorStr=str;this.render();this._container=this.el.firstElementChild}},{key:'focus',value:function focus(){this._container.firstElementChild.focus()}},{key:'render',value:function render(){this.el.innerHTML='<div class="error-state-container" >\n\t\t\t<div tabindex="-1" role="text" class="error-state-message">'+this._errorStr+'</div>\n\t\t</div>\n\t\t'}}]);return ErrorView}();module.exports=ErrorView},{}],252:[function(require,module,exports){'use strict';var createBehaviorFromClass=function createBehaviorFromClass(view,behaviorDefinitionObject,behaviorDecorations){return new behaviorDefinitionObject.classDef(view,Object.assign(behaviorDefinitionObject.options||{},behaviorDecorations||{}))};var createListener=function createListener(context,eventName,view){return function(event){context[eventName](event,view)}};var createBehaviorDynamically=function createBehaviorDynamically(view,behaviorDefinitionObject){var handlers=behaviorDefinitionObject.handlers||{};var boundListeners={};for(var evt in handlers){if(handlers.hasOwnProperty(evt)){view.on(evt,boundListeners[evt]=createListener(handlers,evt,view))}}
var observe=behaviorDefinitionObject.observe;var destroyObserver;if(observe){var update=observe.update;var source=observe.source;var on=source.on.bind(source)||source.addEventListener;var off=source.off.bind(source)||source.removeEventListener;var events=observe.events;var i=0;var len=events.length;var updateCallback=function updateCallback(){update.call(observe,view)};for(;i<len;i++){evt=events[i];on(evt,updateCallback)}
destroyObserver=function destroyObserver(){for(i=0;i<len;i++){evt=events[i];off(evt,updateCallback)}}}
var destroy=function destroy(){for(var evt in boundListeners){if(boundListeners.hasOwnProperty(evt)){view.off(evt,boundListeners[evt])}}
if(destroyObserver){destroyObserver()}};return{destroy:destroy}};module.exports=function createBehavior(view,behaviorDefinitionObject,behaviorDecorations){if(behaviorDefinitionObject.classDef){return createBehaviorFromClass(view,behaviorDefinitionObject,behaviorDecorations)}else{return createBehaviorDynamically(view,behaviorDefinitionObject,behaviorDecorations)}}},{}],253:[function(require,module,exports){'use strict';var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var createView=require('./createView');var createBehavior=require('./createBehavior');var destroyComponent=function destroyComponent(view,behavior){if(typeof behavior.destroy==='function'){behavior.destroy()}
if(typeof view.destroy==='function'){view.destroy()}};var destroyArray=function destroyArray(array){while(array.length){array.shift().destroy()}};var destroyMap=function destroyMap(map){for(var prop in map){if(map.hasOwnProperty(prop)){destroyArray(map[prop]);delete map[prop]}}};var createComponent=function createComponent(element,componentDefinitionObject,behaviorDecorations){var view=createView(element,componentDefinitionObject.view);var behavior=createBehavior(view,componentDefinitionObject.behavior,behaviorDecorations);return{view:view,behavior:behavior,destroy:destroyComponent.bind(null,view,behavior)}};module.exports=function createComponents(contextElement,componentDefinitionObject,behaviorDecorations){var components={};for(var componentName in componentDefinitionObject){if(componentDefinitionObject.hasOwnProperty(componentName)&&_typeof(componentDefinitionObject[componentName])==='object'){var definition=componentDefinitionObject[componentName];var targetSelector=componentDefinitionObject.elementClassPrefix?'.'+componentDefinitionObject.elementClassPrefix+'-'+definition.className:'.'+definition.className;var targetElements=contextElement.querySelectorAll(targetSelector);components[componentName]=[];var i=0;var len=targetElements.length;for(;i<len;i++){components[componentName].push(createComponent(targetElements[i],definition,behaviorDecorations))}}}
return{components:components,destroy:destroyMap.bind(null,components)}}},{"./createBehavior":252,"./createView":254}],254:[function(require,module,exports){'use strict';module.exports=function createView(element,viewDefinitionObject){return new viewDefinitionObject.classDef(element,viewDefinitionObject.options)}},{}],255:[function(require,module,exports){'use strict';var Keyboard=require('@marcom/ac-keyboard/Keyboard');var EventEmitter=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var SPACE=32;var LEFT=37;var UP=38;var RIGHT=39;var DOWN=40;var KeyboardControl=function KeyboardControl(options){EventEmitter.call(this);this._player=options.player;this._target=options.keyboardTarget||this._player.el;this._keyboard=new Keyboard(this._target);this._bindMethods();this._addEventListeners()};var superProto=EventEmitter.prototype;var proto=KeyboardControl.prototype=Object.create(superProto);proto._bindMethods=function(){this._onLeftArrowDown=this._onLeftArrowDown.bind(this);this._onRightArrowDown=this._onRightArrowDown.bind(this);this._onUpArrowDown=this._onUpArrowDown.bind(this);this._onDownArrowDown=this._onDownArrowDown.bind(this);this._onSpaceBarUp=this._onSpaceBarUp.bind(this);this._onSpaceBarDown=this._onSpaceBarDown.bind(this);this._onKeyboardInteraction=this._onKeyboardInteraction.bind(this);this._onDurationChange=this._onDurationChange.bind(this);this._boundKeyboardInteraction={};[SPACE,LEFT,RIGHT,UP,DOWN].forEach(function(evtName){this._boundKeyboardInteraction[evtName]=this._onKeyboardInteraction.bind(this,evtName)}.bind(this))};proto._addEventListeners=function(){[SPACE,LEFT,RIGHT,UP,DOWN].forEach(function(evtName){this._keyboard.onDown(evtName,this._boundKeyboardInteraction[evtName])}.bind(this));this._keyboard.onDown(SPACE,this._onSpaceBarDown);this._keyboard.onDown(LEFT,this._onLeftArrowDown);this._keyboard.onDown(RIGHT,this._onRightArrowDown);this._keyboard.onDown(UP,this._onUpArrowDown);this._keyboard.onDown(DOWN,this._onDownArrowDown);this._player.on('durationchange',this._onDurationChange)};proto._removeEventListeners=function(){[SPACE,LEFT,RIGHT,UP,DOWN].forEach(function(evtName){this._keyboard.offDown(evtName,this._boundKeyboardInteraction[evtName])}.bind(this));this._boundKeyboardInteraction=null;this._keyboard.offDown(SPACE,this._onSpaceBarDown);this._keyboard.offUp(SPACE,this._onSpaceBarUp);this._keyboard.offDown(LEFT,this._onLeftArrowDown);this._keyboard.offDown(RIGHT,this._onRightArrowDown);this._keyboard.offDown(UP,this._onUpArrowDownDown);this._keyboard.offDown(DOWN,this._onDownArrowDown);this._player.off('durationchange',this._onDurationChange)};proto._onKeyboardInteraction=function(){this._triggerKeyboardInteraction()};proto._triggerKeyboardInteraction=function(){this.trigger('keyboardinteraction')};proto._onDurationChange=function(){var duration=this._player.getDuration();if(duration>=60){this._interval=10}else if(duration>=20){this._interval=5}else{this._interval=1}};proto._onLeftArrowDown=function(evt){if(this._player.isLive()){return}
evt.originalEvent.preventDefault();evt.originalEvent.stopPropagation();var currentTime=this._player.getCurrentTime();if(!isNaN(currentTime)){this._player.seek(Math.max(currentTime-this._interval,0))}};proto._onRightArrowDown=function(evt){if(this._player.isLive()){return}
evt.originalEvent.preventDefault();evt.originalEvent.stopPropagation();var currentTime=this._player.getCurrentTime();if(!isNaN(currentTime)){this._player.seek(Math.min(currentTime+this._interval,this._player.getDuration()))}};proto._onUpArrowDown=function(evt){if(evt.target.hasAttribute('aria-checked')){return}
evt.originalEvent.preventDefault();evt.originalEvent.stopPropagation();var volume=this._player.getMuted()?0:this._player.getVolume();var newValue=Math.min(1,volume+0.1);this._player.setVolume(newValue);this._player.setMuted(!1)};proto._onDownArrowDown=function(evt){if(evt.target.hasAttribute('aria-checked')){return}
evt.originalEvent.preventDefault();evt.originalEvent.stopPropagation();var volume=this._player.getMuted()?0:this._player.getVolume();var newValue=Math.max(0,volume-0.1);this._player.setVolume(newValue);this._player.setMuted(Math.round(newValue*10)===0)};proto._onSpaceBarDown=function(evt){if(evt.target.tagName==='BUTTON'||evt.target.getAttribute('role')==='button'){return}
this._keyboard.offDown(SPACE,this._onSpaceBarDown);this._keyboard.onUp(SPACE,this._onSpaceBarUp)};proto._onSpaceBarUp=function(){this._keyboard.offUp(SPACE,this._onSpaceBarUp);if(this._player.getPaused()){this._player.play()}else{this._player.pause()}
this._keyboard.onDown(SPACE,this._onSpaceBarDown)};proto.destroy=function(){this._removeEventListeners();this._keyboard.destroy();superProto.destroy.call(this)};module.exports=KeyboardControl},{"@marcom/ac-event-emitter-micro":89,"@marcom/ac-keyboard/Keyboard":109}],256:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var KeyboardControl=require('./KeyboardControl');var UP_DOWN_FILTERED_CLASSES=['controls-toggle-mute-volume-button','controls-volume-level-indicator'];var LEFT_RIGHT_FILTERED_CLASS='controls-progress-indicator';var LEFT=37;var UP=38;var RIGHT=39;var DOWN=40;var ThreeSixtyKeyboardControl=function(_KeyboardControl){_inherits(ThreeSixtyKeyboardControl,_KeyboardControl);function ThreeSixtyKeyboardControl(options){_classCallCheck(this,ThreeSixtyKeyboardControl);var _this=_possibleConstructorReturn(this,(ThreeSixtyKeyboardControl.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl)).call(this,options));var _360=_this._player.get360();_this._arrowControls=!_360||_360.arrowControls;return _this}
_createClass(ThreeSixtyKeyboardControl,[{key:'_bindMethods',value:function _bindMethods(){_get(ThreeSixtyKeyboardControl.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl.prototype),'_bindMethods',this).call(this);this._onLeftArrowUp=this._onLeftArrowUp.bind(this);this._onRightArrowUp=this._onRightArrowUp.bind(this);this._onDownArrowUp=this._onDownArrowUp.bind(this);this._onUpArrowUp=this._onUpArrowUp.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){_get(ThreeSixtyKeyboardControl.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl.prototype),'_addEventListeners',this).call(this);this._keyboard.onUp(LEFT,this._onLeftArrowUp);this._keyboard.onUp(RIGHT,this._onRightArrowUp);this._keyboard.onUp(UP,this._onUpArrowUp);this._keyboard.onUp(DOWN,this._onDownArrowUp)}},{key:'_removeEventListeners',value:function _removeEventListeners(){_get(ThreeSixtyKeyboardControl.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl.prototype),'_removeEventListeners',this).call(this);this._keyboard.offUp(LEFT,this._onLeftArrowUp);this._keyboard.offUp(RIGHT,this._onRightArrowUp);this._keyboard.offUp(UP,this._onUpArrowUp);this._keyboard.offUp(DOWN,this._onDownArrowUp)}},{key:'_onLeftArrowDown',value:function _onLeftArrowDown(evt){if(evt.target.classList.contains(LEFT_RIGHT_FILTERED_CLASS)){this._triggerKeyboardInteraction();_get(ThreeSixtyKeyboardControl.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl.prototype),'_onLeftArrowDown',this).call(this,evt);return}
this._arrowControls.leftArrowDown(evt)}},{key:'_onRightArrowDown',value:function _onRightArrowDown(evt){if(evt.target.classList.contains(LEFT_RIGHT_FILTERED_CLASS)){this._triggerKeyboardInteraction();_get(ThreeSixtyKeyboardControl.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl.prototype),'_onRightArrowDown',this).call(this,evt);return}
this._arrowControls.rightArrowDown(evt)}},{key:'_onUpArrowDown',value:function _onUpArrowDown(evt){if(evt.target.classList.contains(UP_DOWN_FILTERED_CLASSES[0])||evt.target.classList.contains(UP_DOWN_FILTERED_CLASSES[1])){this._triggerKeyboardInteraction();_get(ThreeSixtyKeyboardControl.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl.prototype),'_onUpArrowDown',this).call(this,evt);return}
evt.originalEvent.preventDefault();this._arrowControls.upArrowDown(evt)}},{key:'_onDownArrowDown',value:function _onDownArrowDown(evt){if(evt.target.classList.contains(UP_DOWN_FILTERED_CLASSES[0])||evt.target.classList.contains(UP_DOWN_FILTERED_CLASSES[1])){this._triggerKeyboardInteraction();_get(ThreeSixtyKeyboardControl.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl.prototype),'_onDownArrowDown',this).call(this,evt);return}
evt.originalEvent.preventDefault();this._arrowControls.downArrowDown(evt)}},{key:'_onLeftArrowUp',value:function _onLeftArrowUp(evt){if(evt.target.classList.contains(LEFT_RIGHT_FILTERED_CLASS)){this._triggerKeyboardInteraction();return}
evt.originalEvent.preventDefault();this._arrowControls.leftArrowUp(evt)}},{key:'_onRightArrowUp',value:function _onRightArrowUp(evt){if(evt.target.classList.contains(LEFT_RIGHT_FILTERED_CLASS)){this._triggerKeyboardInteraction();return}
evt.originalEvent.preventDefault();this._arrowControls.rightArrowUp(evt)}},{key:'_onUpArrowUp',value:function _onUpArrowUp(evt){if(evt.target.classList.contains(LEFT_RIGHT_FILTERED_CLASS)){this._triggerKeyboardInteraction();return}
this._arrowControls.upArrowUp(evt)}},{key:'_onDownArrowUp',value:function _onDownArrowUp(evt){if(evt.target.classList.contains(LEFT_RIGHT_FILTERED_CLASS)){this._triggerKeyboardInteraction();return}
this._arrowControls.downArrowUp(evt)}},{key:'_onKeyboardInteraction',value:function _onKeyboardInteraction(evt){}},{key:'destroy',value:function destroy(){_get(ThreeSixtyKeyboardControl.prototype.__proto__||Object.getPrototypeOf(ThreeSixtyKeyboardControl.prototype),'destroy',this).call(this)}}]);return ThreeSixtyKeyboardControl}(KeyboardControl);module.exports=ThreeSixtyKeyboardControl},{"./KeyboardControl":255}],257:[function(require,module,exports){'use strict';var ThreeSixtyKeyboardControl;var KeyboardControl;module.exports=function createKeyboardControl(options){if(options.threesixty){if(!ThreeSixtyKeyboardControl){ThreeSixtyKeyboardControl=require('./ThreeSixtyKeyboardControl')}
return new ThreeSixtyKeyboardControl(options)}else{if(!KeyboardControl){KeyboardControl=require('./KeyboardControl')}
return new KeyboardControl(options)}}},{"./KeyboardControl":255,"./ThreeSixtyKeyboardControl":256}],258:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
var Localization=require('../localization/Localization');var TEMPLATE='<div class="loading-indicator">\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n        <div></div>\n\t\t<div></div>\n    </div>';var LOADING_CLASS='loading';var WAS_LOADING_CLASS='was-loading';var USER_HOVER_CLASS='user-hover';var DEFAULT_DELAY=500;var LoadingIndicator=function(){function LoadingIndicator(options){var _this=this;_classCallCheck(this,LoadingIndicator);this._player=options.player;this.el=options.el;this.el.innerHTML=TEMPLATE;this._ariaSpan=this._player.controls.el.querySelector('#loading-status');this._ariaString='';Localization.getTranslation({callback:function callback(translation){_this._ariaString=translation.loading;if(_this._isShowing()){_this._ariaSpan.innerText=_this._ariaString}}});this._showTimeoutDelay=options.showTimeoutDelay!==undefined?options.showTimeoutDelay:DEFAULT_DELAY;this._bindMethods();this._addEventListeners()}
_createClass(LoadingIndicator,[{key:'_bindMethods',value:function _bindMethods(){this.show=this.show.bind(this);this.hide=this.hide.bind(this);this._onPlaying=this._onPlaying.bind(this);this._onSeeking=this._onSeeking.bind(this);this._onSeeked=this._onSeeked.bind(this);this._onPause=this._onPause.bind(this);this._onEnded=this._onEnded.bind(this);this._onError=this._onError.bind(this);this._doShow=this._doShow.bind(this);this._checkLoadingState=this._checkLoadingState.bind(this);this._onPlay=this._onPlay.bind(this);this._onMouseOut=this._onMouseOut.bind(this)}},{key:'_addEventListeners',value:function _addEventListeners(){this._player.on('waiting',this.show);this._player.on('seeking',this._onSeeking);this._player.on('seeked',this._onSeeked);this._player.on('playing',this._onPlaying);this._player.on('ended',this._onEnded);this._player.on('canplaythrough',this._checkLoadingState);this._player.on('progress',this._checkLoadingState);this._player.on('error',this._onError);this._player.on('pause',this._onPause);this._player.on('timeupdate',this._checkLoadingState);this._player.on('play',this._onPlay);if(this._player.controls){this._player.controls.el.addEventListener('mouseout',this._onMouseOut)}}},{key:'_removeEventListeners',value:function _removeEventListeners(){this._player.off('waiting',this.show);this._player.off('seeking',this._onSeeking);this._player.off('seeked',this._onSeeked);this._player.off('playing',this._onPlaying);this._player.off('ended',this._onEnded);this._player.off('canplaythrough',this._checkLoadingState);this._player.off('progress',this._checkLoadingState);this._player.off('error',this._onError);this._player.off('pause',this._onPause);this._player.off('timeupdate',this._checkLoadingState);this._player.off('play',this._onPlay);this.el.removeEventListener('click',this._onClick);if(this._player.controls){this._controls.el.addEventListener('mouseout',this._onMouseOut)}}},{key:'_onPause',value:function _onPause(){this._isPaused=this._player.getPaused();if(this._isPaused){this.hide()}}},{key:'_onPlaying',value:function _onPlaying(){this._isPaused=this._player.getPaused();this._started=!0;this._checkLoadingState()}},{key:'_onPlay',value:function _onPlay(){if(!this._isPaused&&this._started){return}
this._isPaused=this._player.getPaused();if(!this._isPaused){this._started=!0}
this._isSeeking=!1;this._checkLoadingState(!0)}},{key:'_onSeeking',value:function _onSeeking(){this._isSeeking=!0;this.show()}},{key:'_onSeeked',value:function _onSeeked(){this._isSeeking=!1;this._checkLoadingState()}},{key:'_onEnded',value:function _onEnded(){this._started=!1;this.hide()}},{key:'_onError',value:function _onError(){if(!this._started){return}
this.show(!0)}},{key:'_onMouseOut',value:function _onMouseOut(){if(!this._player.isStalled()){this._player.el.classList.remove(WAS_LOADING_CLASS)}}},{key:'show',value:function show(showImmediately){if(this._isPaused){return}
if(!(showImmediately===!0)&&this._started){clearTimeout(this._showTimeout);this._showTimeout=setTimeout(this._doShow,this._showTimeoutDelay)}else{this._doShow()}}},{key:'_checkLoadingState',value:function _checkLoadingState(showImmediately){if(!this._player.getEnded()&&this._started&&(this._player.isStalled()||this._isSeeking)){this.show(showImmediately===!0)}else{this.hide()}}},{key:'_isShowing',value:function _isShowing(){return this._player.el.classList.contains(LOADING_CLASS)}},{key:'_doShow',value:function _doShow(){this._player.el.classList.add(LOADING_CLASS);this._player.el.classList.remove(WAS_LOADING_CLASS);this._ariaSpan.innerText=this._ariaString}},{key:'hide',value:function hide(){clearTimeout(this._showTimeout);if(this._isShowing()){this._player.el.classList.remove(LOADING_CLASS);if(!this._player.el.classList.contains(USER_HOVER_CLASS)){this._player.el.classList.add(WAS_LOADING_CLASS)}
this._ariaSpan.innerText=''}}},{key:'destroy',value:function destroy(){this._removeEventListeners()}}]);return LoadingIndicator}();module.exports=LoadingIndicator},{"../localization/Localization":260}],259:[function(require,module,exports){'use strict';module.exports={'backthirtyseconds':'Back 30 Seconds','playpause':'Play/Pause','play':'Play','pause':'Pause','togglemutevolume':'Toggle Mute Volume','mutevolume':'Mute Volume','minvolume':'Minimum Volume','adjustvolume':'Adjust Volume','fastreverse':'Fast Reverse','fastforward':'Fast Forward','fullvolume':'Full Volume','fullscreen':'Full Screen','exitfullscreen':'Exit Full Screen','airplay':'AirPlay','captionscontrol':'Closed Captions','captionsturnedon':'Closed Captions On','captionsturnedoff':'Closed Captions Off','subtitlescontrol':'Subtitles','subtitlesturnedon':'Subtitles On','subtitlesturnedoff':'Subtitles Off','sizescontrol':'Video Size','downloadcontrol':'Download Video','share':'Share','small':'Small','medium':'Medium','large':'Large','hd':'HD','ipod':'iPod/iPhone','mb':'MB','gb':'GB','tb':'TB','downloadquicktimetitle':'Get QuickTime.','downloadquicktimetext':'Download QuickTime to view this video. QuickTime is free for Mac + PC.','downloadquicktimebutton':'Download','downloadquicktimeurl':'https://www.apple.com/quicktime/download/','elapsed':'elapsed','remaining':'remaining','currenttimetext':'{minutes} minutes and {seconds} seconds','pictureinpicture':'Picture-in-Picture','exitpictureinpicture':'Exit Picture-in-Picture','closesharing':'Close Sharing','facebookshare':'Share to Facebook','twittershare':'Share to Twitter','copylink':'Copy Link','copyembed':'Copy Embed Code','copyarea':'Copy Link Text Area','selectlink':'Select Link Text','selectembed':'Select Embed Code','close':'Close','dismisscopy':'Dismiss Copy','replay':'Replay','livestream':'Live Streaming','newwindow':'Opens in New Window','threesixtyicon':'Return 360 Point of View to Origin','threesixtyleft':'Move 360 Point of View Left','threesixtyright':'Move 360 Point of View Right','threesixtyup':'Move 360 Point of View Up','threesixtydown':'Move 360 Point of View Down','error':'The video could not be played.','jumptochapter':'Jump to chapter','chapter':'{chaptertitle} Chapter {chaptertime}','minutesandseconds':'{minutes} minutes and {seconds} seconds','loading':'The video is loading','captionsoff':'Off'}},{}],260:[function(require,module,exports){'use strict';var TRANSLATIONS=require('./Translations');var DEFAULT_LABEL_STRINGS=require('./DefaultLabelStrings');var HTML=window.document.documentElement;var TOP_HTML=void 0;try{TOP_HTML=window.top.document.documentElement}catch(e){TOP_HTML=HTML}
var xhr=require('@marcom/ac-ajax-xhr');var m='m';var BASE_PATH='/global/ac_'+m+'edia_player/scripts/ac_'+m+'edia_languages/';var DEFAULT_LANGUAGE='en-US';var localizationCache={};var getLanguage=function getLanguage(langCode){var attr=void 0;try{attr=langCode||TOP_HTML.getAttribute('lang')}catch(err){attr=HTML.getAttribute('lang')}
var lang=void 0;if(!attr){lang=DEFAULT_LANGUAGE}else{switch(attr.toLowerCase()){case 'es-418':lang='es-LA';break;case 'pt':lang='pt-BR';break;default:lang=attr;break}}
return lang};var translationReady=function translationReady(lang){lang=getLanguage(lang);return localizationCache[lang]!==undefined};var getTranslation=function getTranslation(options){options=options||{};var lang=getLanguage(options.lang);if(translationReady(lang)){if(options.callback){options.callback(localizationCache[lang]);return null}else{return localizationCache[lang]}}else if(!options.callback){throw new Error('To use Localization.getTranslation you must either pass a callback or ensure the translation is ready via Localization.translationReady')}
var path=options.basePath||BASE_PATH;var fullPath=TRANSLATIONS[lang]?path+TRANSLATIONS[lang]:path+TRANSLATIONS[DEFAULT_LANGUAGE];var translation=DEFAULT_LABEL_STRINGS;var onError=function onError(){localizationCache[lang]=translation;options.callback(translation)};xhr.get(fullPath,{success:function success(response){try{translation=Object.assign(translation,JSON.parse(response));localizationCache[lang]=translation;options.callback(translation)}catch(err){onError()}},error:onError});return null};module.exports={getLanguage:getLanguage,getTranslation:getTranslation,translationReady:translationReady}},{"./DefaultLabelStrings":259,"./Translations":261,"@marcom/ac-ajax-xhr":33}],261:[function(require,module,exports){'use strict';module.exports={'bg-BG':'bg-BG.json','cs-CZ':'cs-CZ.json','el-GR':'el-GR.json','de-AT':'de-AT.json','de-CH':'de-CH.json','de-DE':'de-DE.json','de-LI':'de-LI.json','da-DK':'da-DK.json','en':'en.json','en-US':'en-US.json','en-AP':'en-AP.json','en-CA':'en-CA.json','en-GB':'en-GB.json','en-HK':'en-HK.json','en-IE':'en-IE.json','en-IN':'en-IN.json','en-KR':'en-KR.json','en-AU':'en-AU.json','en-NZ':'en-NZ.json','en-SG':'en-SG.json','en-ZA':'en-ZA.json','es':'es.json','es-LA':'es-LA.json','es-MX':'es-MX.json','es-ES':'es-ES.json','et-EE':'et-EE.json','fi-FI':'fi-FI.json','fr':'fr.json','fr-BE':'fr-BE.json','fr-CA':'fr-CA.json','fr-CH':'fr-CH.json','fr-FR':'fr-FR.json','hr-HR':'hr-HR.json','hu-HU':'hu-HU.json','it-IT':'it-IT.json','ja':'ja.json','ja-JP':'ja-JP.json','ko-KR':'ko-KR.json','lt-LT':'lt-LT.json','lv-LV':'lv-LV.json','nl-BE':'nl-BE.json','nl-NL':'nl-NL.json','no-NO':'no-NO.json','pl-PL':'pl-PL.json','pt':'pt.json','pt-BR':'pt-BR.json','pt-PT':'pt-PT.json','ro-RO':'ro-RO.json','ru-RU':'ru-RU.json','sk-SK':'sk-SK.json','sv-SE':'sv-SE.json','tr-TR':'tr-TR.json','zh':'zh.json','zh-CN':'zh-CN.json','zh-HK':'zh-HK.json','zh-TW':'zh-TW.json'}},{}],262:[function(require,module,exports){'use strict';var PopUp=require('./PopUp');var OverlayContainer=function OverlayContainer(options){this.el=options.el;this._player=options.player;this._popUp=new PopUp(options);this.el.appendChild(this._popUp.el)};var proto=OverlayContainer.prototype;proto.setData=function(data){this._popUp.setData(data)};proto.show=function(){this.el.classList.remove('hidden');this._popUp.show()};proto.hide=function(){this.el.classList.add('hidden');this._popUp.hide()};proto.setPopUpPosition=function(time){this._popUp.setPopUpPosition(time)};proto.destroy=function(){this._popUp.destroy()};module.exports=OverlayContainer},{"./PopUp":263}],263:[function(require,module,exports){'use strict';var TEMPLATE=require('https://www.apple.com/jobs/templates/overlays/trickplay-overlay.html');var Time=require('../../utils/Time');var ThumbnailHandler=require('./ThumbnailHandler');var throttle=require('@marcom/function-utils/throttle');var CHAPTER_LANGUAGE='en';var CHAPTERS_FUDGE_FACTOR=0;var PopUp=function PopUp(options){this._player=options.player;this.el=document.createElement('div');this.el.style.opacity='0';this.el.innerHTML=TEMPLATE;this._thumbnailHandler=new ThumbnailHandler({el:this.el.querySelector('.ac-video-trickplay-image'),player:this._player,numberOfImages:options.numberOfImages});this._timeLabel=this.el.querySelector('.ac-video-trickplay-time');this._chapterLabel=this.el.querySelector('.ac-video-trickplay-chapter-title');this._bindMethods();this._addEventListeners()};var proto=PopUp.prototype;proto._initPointerTracking=function(){this._scrubberView=this._player.controls.scrubberView;if(!this._scrubberView){return}
this._runnableTrack=this._scrubberView.el.querySelector('.ac-slider-runnable-track');this._calcOffsets();this._scrubberView.el.addEventListener('mouseover',this.show);this._scrubberView.el.addEventListener('mouseout',this.hide);this._scrubberView.el.addEventListener('focusin',this._onScrubberFocusIn);this._scrubberView.el.addEventListener('focusout',this._onScrubberFocusOut);this._scrubberView.el.addEventListener('mousedown',this._startScrubbing);this._scrubberView.el.addEventListener('mouseup',this._endScrubbing);this._scrubberView.el.addEventListener('mousemove',this._onTrackerUpdate);this._scrubberView.el.addEventListener('mousemove',this._setThumbnail);this._player.on('resize',this._throttledCalcOffsets);window.addEventListener('resize',this._throttledCalcOffsets)};proto._bindMethods=function(){this.show=this.show.bind(this);this.hide=this.hide.bind(this);this._onDurationChange=this._onDurationChange.bind(this);this._onLoadedMetaData=this._onLoadedMetaData.bind(this);this._startScrubbing=this._startScrubbing.bind(this);this._endScrubbing=this._endScrubbing.bind(this);this._initPointerTracking=this._initPointerTracking.bind(this);this._onTrackerUpdate=this._onTrackerUpdate.bind(this);this._setThumbnail=this._setThumbnail.bind(this);this._calcOffsets=this._calcOffsets.bind(this);this._onScrubberFocusIn=this._onScrubberFocusIn.bind(this);this._onScrubberFocusOut=this._onScrubberFocusOut.bind(this);this._throttledCalcOffsets=throttle(this._calcOffsets,30)};proto._startScrubbing=function(evt){this._thumbnailHandler.el.classList.add('hidden');this._scrubberView.el.removeEventListener('mousemove',this._setThumbnail);this._scrubberView.el.removeEventListener('mouseout',this.hide);document.addEventListener('mouseup',this._endScrubbing);document.addEventListener('mousemove',this._onTrackerUpdate)};proto._endScrubbing=function(evt){if(evt.target===this._scrubberView.el){this.hide()}
this._scrubberView.el.addEventListener('mousemove',this._setThumbnail);this._scrubberView.el.addEventListener('mouseout',this.hide);document.removeEventListener('mouseup',this._endScrubbing);document.removeEventListener('mousemove',this._onTrackerUpdate);this._setThumbnail(evt);this._thumbnailHandler.el.classList.remove('hidden')};proto._calcOffsets=function(){this._onLoadedMetaData();var playerRect=this._player.el.getBoundingClientRect();this._offsetLeft=playerRect.left;var rect=this._runnableTrack.getBoundingClientRect();this._leftBoundary=rect.left-this._offsetLeft;this._rightBoundary=rect.right-this._offsetLeft;this._imgWidth=this.el.firstElementChild.getBoundingClientRect().width};proto._onLoadedMetaData=function(){var w=this._player.getMediaElement().videoWidth;var h=this._player.getMediaElement().videoHeight;var src=this._player.getCurrentSrc()||'';var is24x10=src.indexOf('-tft-')!==-1;this.el.classList.remove('square-video');this.el.classList.remove('vertical-video');this.el.classList.remove('tft-video');if(is24x10){this.el.classList.add('tft-video');this._thumbnailHandler.setVertical(!1)}else if(w<h){this.el.classList.add('vertical-video');this._thumbnailHandler.setVertical(!0)}else if(w===h){this.el.classList.add('square-video');this._thumbnailHandler.setVertical(!1)}else{this._thumbnailHandler.setVertical(!1)}};proto._addEventListeners=function(){this._player.on('durationchange',this._onDurationChange);this._player.once('controlsready',this._initPointerTracking);this._player.on('loadedmetadata',this._calcOffsets)};proto._removeEventListeners=function(){this._player.off('durationchange',this._onDurationChange);this._player.off('controlsready',this._initPointerTracking);this._player.off('canplaythrough',this._canPlayThroughHander);this._player.off('playing',this._canPlayThroughHander);this._player.off('loadedmetadata',this._calcOffsets);this._player.off('resize',this._throttledCalcOffsets);window.removeEventListener('resize',this._throttledCalcOffsets);this._scrubberView.el.removeEventListener('mouseover',this.show);this._scrubberView.el.removeEventListener('mouseout',this.hide);this._scrubberView.el.removeEventListener('focusin',this._onScrubberFocusIn);this._scrubberView.el.removeEventListener('focusout',this._onScrubberFocusOut);this._scrubberView.el.removeEventListener('mouseout',this.hide);this._scrubberView.el.removeEventListener('mousemove',this._onTrackerUpdate);this._scrubberView.el.removeEventListener('mousemove',this._setThumbnail);document.removeEventListener('mouseup',this._endScrubbing);document.removeEventListener('mousemove',this._onTrackerUpdate)};proto._getDuration=function(){if(!this._cachedDuration||!isNaN(this._cachedDuration)){this._cachedDuration=this._player.getDuration()}
return this._cachedDuration};proto.setPopUpPosition=function(time){this.show();var position=time/this._cachedDuration*(this._rightBoundary-this._leftBoundary);var centeredPosition=position-this._imgWidth/2-1;var positionInPixels=this._leftBoundary+centeredPosition;this.el.firstElementChild.style.left=positionInPixels+'px';this._time=time;this._timeLabel.innerText=Time.formatTime(time,this._getDuration());this._refreshChapter();this._setThumbnail()};proto._onScrubberFocusIn=function(evt){if(evt.target.classList.contains('ac-slider-chapter-container')){this._calcOffsets();var index=Array.from(evt.target.parentElement.children).indexOf(evt.target);var time=this._player.getChapters()[index]['start-time'];this.setPopUpPosition(time);this.show()}};proto._onScrubberFocusOut=function(evt){this.hide()};proto._onTrackerUpdate=function(evt){this._calcOffsets();var position=Math.min(Math.max(evt.clientX-this._offsetLeft,this._leftBoundary),this._rightBoundary);this.el.firstElementChild.style.left=position-this._imgWidth/2+'px';var scrubberPosition=this._scrubberView.getClientXValue(evt);if(this._player.getReadyState()<=2){this._cachedTrackerUpdate=evt}else{this._cachedTrackerUpdate=null}
this._setTimeFromPercentPosition(Math.max(scrubberPosition,0))};proto._onDurationChange=function(evt){this._cachedDuration=this._player.getDuration();if(this._cachedTrackerUpdate){this._onTrackerUpdate(this._cachedTrackerUpdate);this._setThumbnail()}
this.el.style.opacity='1'};proto._setThumbnail=function(evt){this._thumbnailHandler.setTime(this._time,this._getDuration())};proto._setTimeFromPercentPosition=function(position){var percent=position/this._scrubberView.getMax();this._time=Math.min(percent*this._getDuration(),this._getDuration());var formattedTime=Time.formatTime(this._time,this._getDuration());this._timeLabel.innerText=formattedTime;this._refreshChapter()};proto._refreshChapter=function(){var chapter=this._player.getChapterForTime(this._time,CHAPTERS_FUDGE_FACTOR);if(chapter&&chapter.titles.length){var titleItem=chapter.titles.find(function(t){return t.language===CHAPTER_LANGUAGE})||chapter.titles[0];this._chapterLabel.innerText=titleItem.title;this._chapterLabel.classList.remove('hidden')}else{this._chapterLabel.classList.add('hidden')}};proto.setData=function(data){this.el.style.opacity='0';if(this._canPlayThroughHander){this._player.off('canplaythrough',this._canPlayThroughHander);this._player.off('playing',this._canPlayThroughHander);this._canPlayThroughHander=null}
if(data&&this._player.getReadyState()>2){this.el.style.opacity='1';this._thumbnailHandler.setData(data);if(this._cachedTrackerUpdate){this._onTrackerUpdate(this._cachedTrackerUpdate);this._setThumbnail()}}else{this._thumbnailHandler.setData(null);if(data){this._canPlayThroughHander=this.setData.bind(this,data);this._player.on('canplaythrough',this._canPlayThroughHander);this._player.on('playing',this._canPlayThroughHander)}else{this.el.style.opacity='1'}}
this._onLoadedMetaData()};proto.show=function(evt){if(evt){this._onTrackerUpdate(evt)}
this.el.firstElementChild.classList.remove('hidden')};proto.hide=function(){this.el.firstElementChild.classList.add('hidden')};proto.destroy=function(){if(this._canPlayThroughHander){this._player.off('canplaythrough',this._canPlayThroughHander);this._player.off('playing',this._canPlayThroughHander)}
this._removeEventListeners();if(this._throttledCalcOffsets){this._throttledCalcOffsets.cancel()}
this._scrubberView=null};module.exports=PopUp},{"../../utils/Time":274,"../templates/overlays/trickplay-overlay.html":267,"./ThumbnailHandler":264,"@marcom/function-utils/throttle":304}],264:[function(require,module,exports){'use strict';var DEFAULT_NUMBER_OF_IMAGES=120;var DEFAULT_WIDTH=144;var DEFAULT_HEIGHT=81;var ThumbnailHandler=function ThumbnailHandler(options){this.el=options.el;this._player=options.player;this._imgWidth=options.imgWidth||DEFAULT_WIDTH;this.el.style.backgroundSize=this._numberOfImages*100+'% 100%'};var proto=ThumbnailHandler.prototype;proto.setVertical=function(vertical){this._imgWidth=vertical?DEFAULT_HEIGHT:DEFAULT_WIDTH};proto.getWidth=function(){return this._imgWidth};proto.setData=function(data){if(!data){this._imgUrl=null;this.el.style.backgroundImage='';return}else if(data.url===this._imgUrl){return}
this._imgUrl=data.url;this._numberOfImages=parseInt(data.numberOfImages||DEFAULT_NUMBER_OF_IMAGES);this.el.style.backgroundSize=this._numberOfImages*100+'% 100%';this.el.style.backgroundImage='';this.el.classList.add('hidden');var currentPromise=this._loadImage(this._imgUrl).then(function(){if(this._imageLoadPromise!==currentPromise){return}
this.el.style.backgroundImage='url("'+this._imgUrl+'")';this._imageLoadPromise=null;this.el.classList.remove('hidden')}.bind(this));this._imageLoadPromise=currentPromise};proto._loadImage=function(url){return new Promise(function(resolve,reject){var img=new Image();img.onload=function(){resolve()};img.onerror=function(){reject()};img.src=url})};proto.setTime=function(time,max){var percent=time/max;var sequenceNumber=Math.min(Math.round(percent*this._numberOfImages),this._numberOfImages-1);var percentageOffset=sequenceNumber/(this._numberOfImages-1)*100;this.el.style.backgroundPositionX=percentageOffset+'%'};proto.destroy=function(){if(this._imageLoadPromise){this._imageLoadPromise.cancel()}};module.exports=ThumbnailHandler},{}],265:[function(require,module,exports){'use strict';var TEMPLATE=require('https://www.apple.com/jobs/templates/states/SharingState.html');var EMBED_CODE_TEMPLATE=require('https://www.apple.com/jobs/templates/states/IFrameEmbed.html');var DEFAULT_EMBED_PATH='https://www.apple.com/embed/';var DEFAULT_TITLE='Video Player';var log=require('@marcom/ac-console/log');var select=require('@marcom/ac-clipboard/select');var Dialog=require('@marcom/ac-social').Dialog;var supplant=require('@marcom/ac-string/supplant');var Localization=require('../localization/Localization');var TabManager=require('@marcom/ac-accessibility/helpers/TabManager');var createAnalyticsObserver=void 0;try{createAnalyticsObserver=require('@marcom/ac-analytics-share/factory/create')}catch(err){log('ac-analytics-share failed to load, are you sure you\'ve included it?')}
var userAgent=require('@marcom/useragent-detect');var os=userAgent.os;var IS_MOBILE=os.ios||os.android;var BREAKPOINT=735;var SharingModule=function SharingModule(options){if(!this.el){this._initializeElement(options.el,options.template)}
this._player=options.player;this._parentView=options.parentView;this._clickedShareButton=null;this._container=this.el.querySelector('.container');this._sharingButtonContainer=this.el.querySelector('.social-sharing-container');this._facebookButton=this.el.querySelector('.acv-fb-share');this._twitterButton=this.el.querySelector('.acv-tw-share');this._copyLinkButton=this.el.querySelector('.copy-link');this._copyEmbedCodeButton=this.el.querySelector('.copy-embed-code');this._copyTextArea=this.el.querySelector('.copy-area');this._copyCloseButton=this.el.querySelector('.textinput-close-button');this._closeButton=this.el.querySelector('.close-button');if(options.analytics===!1){createAnalyticsObserver=null}
if(IS_MOBILE){this.el.firstChild.classList.add('mobile');this._player.on('loadstart',function(){if(this._getClientWidth()>BREAKPOINT){this.el.firstChild.classList.add('mobile-large')}}.bind(this))}
this._bindMethods();this._addEventListeners();this._syncSocialShareHidden()};var proto=SharingModule.prototype;proto._initializeElement=function(el,template){if(!el){this.el=document.createElement('div');this._templateData=Localization.getTranslation();this.el.innerHTML=supplant((template||TEMPLATE).toString(),this._templateData)}else{this.el=el}};proto.setData=function(data){if(!data){this._parentView.hide();return}else{this._parentView.show()}
if(data.allowEmbed){this.el.firstChild.classList.add('embed-enabled')}
this._sharingUrl=data.originatorUrl||window.location.href;this._videoid=data.videoid;this._hideExtension=data.hideExtension;this._embedPath=data.embedpath||DEFAULT_EMBED_PATH;this._hideFacebook=data.hideFacebookShare||!1;this._hideTwitter=data.hideTwitterShare||!1;this._title=data.title||DEFAULT_TITLE;this._syncSocialShareHidden();this._container.classList.remove('textarea-active');if(createAnalyticsObserver&&data.analytics!==!1&&data.videoid){try{this._initAnalyticsAttributes(data);if(!this._analyticsObserver){this._analyticsObserver=createAnalyticsObserver({context:this.el})}}catch(error){log('ac-analytics-share failed to load, are you sure you\'ve included it?')}}};proto._bindMethods=function(){this._doFacebookShare=this._doSocialShare.bind(this,Dialog.FACEBOOK_SHARE);this._doTwitterShare=this._doSocialShare.bind(this,Dialog.TWITTER_TWEET);this._copyUrl=this._copyUrl.bind(this);this._copyEmbedCode=this._copyEmbedCode.bind(this);this._closeCopyArea=this._showTextArea.bind(this,!1);this._closeState=this._closeState.bind(this)};proto._addEventListeners=function(){this._facebookButton&&this._facebookButton.addEventListener('click',this._doFacebookShare);this._twitterButton&&this._twitterButton.addEventListener('click',this._doTwitterShare);this._copyLinkButton&&this._copyLinkButton.addEventListener('click',this._copyUrl);this._copyEmbedCodeButton&&this._copyEmbedCodeButton.addEventListener('click',this._copyEmbedCode);this._copyCloseButton&&this._copyCloseButton.addEventListener('click',this._closeCopyArea);this._closeButton&&this._closeButton.addEventListener('click',this._closeState)};proto._removeEventListeners=function(){this._facebookButton&&this._facebookButton.removeEventListener('click',this._doFacebookShare);this._twitterButton&&this._twitterButton.removeEventListener('click',this._doTwitterShare);this._copyLinkButton&&this._copyLinkButton.removeEventListener('click',this._copyUrl);this._copyEmbedCodeButton&&this._copyEmbedCodeButton.removeEventListener('click',this._copyEmbedCode);this._copyCloseButton&&this._copyCloseButton.removeEventListener('click',this._closeCopyArea);this._closeButton&&this._closeButton.removeEventListener('click',this._closeState)};proto._syncSocialShareHidden=function(){if(this._facebookButton){if(this._hideFacebook){this._facebookButton.classList.add('hide-button')}else{this._facebookButton.classList.remove('hide-button')}}
if(this._twitterButton){if(this._hideTwitter){this._twitterButton.classList.add('hide-button')}else{this._twitterButton.classList.remove('hide-button')}}};proto._doSocialShare=function(network){this._clickedShareButton=null;this._copyLinkButton.classList.remove('active');this._copyEmbedCodeButton.classList.remove('active');this._showTextArea(!1);Dialog.create(network,{url:this._sharingUrl,title:this._title})};proto._showTextArea=function(show){if(show){this._container.classList.add('textarea-active');select(this._copyTextArea);if(!IS_MOBILE){this._copyTextArea.setAttribute('readonly','')}}else{this._container.classList.remove('textarea-active');this._copyLinkButton.classList.remove('active');this._copyEmbedCodeButton.classList.remove('active');this._copyTextArea.removeAttribute('readonly');if(this._clickedShareButton){this._clickedShareButton.focus()}
this._copyLinkButton.setAttribute('aria-label',this._templateData.copylink);this._copyEmbedCodeButton.setAttribute('aria-label',this._templateData.copyembed)}};proto._copyUrl=function(){this._clearTextArea();this._copyTextArea.value=this._sharingUrl;this._copyLinkButton.classList.add('active');this._copyLinkButton.setAttribute('aria-label',this._templateData.selectlink);this._showTextArea(!0);this._clickedShareButton=this._copyLinkButton;this._copyTextArea.setAttribute('aria-label',this._templateData.copylink);select(this._copyTextArea)};proto._clearTextArea=function(){window.getSelection().removeAllRanges();this._copyLinkButton.classList.remove('active');this._copyEmbedCodeButton.classList.remove('active');this._copyTextArea.removeAttribute('readonly')};proto._copyEmbedCode=function(){this._clearTextArea();this._copyTextArea.value=supplant(EMBED_CODE_TEMPLATE,{videoid:this._videoid,embedCodePath:this._embedPath,width:this._player.getMediaWidth(),height:this._player.getMediaHeight(),title:this._title,extension:this._hideExtension?'':'.html'});this._copyEmbedCodeButton.classList.add('active');this._copyEmbedCodeButton.setAttribute('aria-label',this._templateData.selectembed);this._showTextArea(!0);this._clickedShareButton=this._copyEmbedCodeButton;this._copyTextArea.setAttribute('aria-label',this._templateData.copyembed);select(this._copyTextArea)};proto._focusFirstButton=function(){if(!this._firstButton){this._firstButton=TabManager.getTabbableElements(this._sharingButtonContainer)[0]}
this._firstButton.focus()};proto.show=function(){this._container.classList.add('showing')};proto.hide=function(){this._clickedShareButton=null;this._showTextArea(!1);this._container.classList.remove('showing')};proto._getClientHeight=function(){return this.el.clientHeight};proto._getClientWidth=function(){return this.el.clientWidth};proto.destroy=function(){this._removeEventListeners()};proto._closeState=function(){this._showTextArea(!1);if(this._player.getCurrentTime()===0||this._player.getEnded()){this._player.states.setState('initial')}else{this._player.states.setState('none')}};proto._getAnalyticsSource=function(){return'drawer'};proto._initAnalyticsAttributes=function(data){var buttons=[];this._facebookButton&&buttons.push({button:this._facebookButton,title:'facebook',events:'event85'});this._twitterButton&&buttons.push({button:this._twitterButton,title:'twitter',events:'event84'});this._copyLinkButton&&buttons.push({button:this._copyLinkButton,title:'copy-link',events:'event89'});this._copyEmbedCodeButton&&buttons.push({button:this._copyEmbedCodeButton,title:'copy-embed-code',events:'event101'});var fileType=((data.url&&data.url.indexOf('.m3u8'))!==-1?'m3u8':'mp4')+' via html5';var evar70=this._getAnalyticsSource();var name=data.videoid;var analyticsTrackMeta=document.head.querySelectorAll('meta[property="analytics-track"]');analyticsTrackMeta=analyticsTrackMeta?analyticsTrackMeta[0].getAttribute('content'):'';buttons.forEach(function(btn){btn.button.setAttribute('data-analytics-click','');btn.button.setAttribute('data-analytics-share',JSON.stringify({title:name,events:btn.events,prop2:analyticsTrackMeta+' - '+name+' - '+btn.title,prop18:fileType,eVar49:document.referrer,eVar54:document.location.href,eVar55:analyticsTrackMeta+' - '+name,eVar70:evar70}))}.bind(this))};module.exports=SharingModule},{"../localization/Localization":260,"../templates/states/IFrameEmbed.html":270,"../templates/states/SharingState.html":271,"@marcom/ac-accessibility/helpers/TabManager":25,"@marcom/ac-analytics-share/factory/create":41,"@marcom/ac-clipboard/select":48,"@marcom/ac-console/log":51,"@marcom/ac-social":173,"@marcom/ac-string/supplant":193,"@marcom/useragent-detect":308}],266:[function(require,module,exports){"use strict";module.exports="\n<div class=\"controls-container\">\n\t<div class=\"{elementClassPrefix}-social-tray hidden\"></div>\n\n\t<div class=\"center-button-container {elementClassPrefix}-play-pause-button-container\">\n\t\t<div class=\"button-wrapper\">\n\t\t\t<button type=\"button\" class=\"ac-video-icon centered-button {elementClassPrefix}-play-pause-button {elementClassPrefix}-button no-autoplay\" value=\"{playpause}\" aria-label=\"{playpause}\" role=\"button\" tabindex=\"0\" data-acv-active-area data-acv-draggable-area>\n\t\t\t\t<div class=\"loading-indicator-container\"></div>\n\t\t\t</button>\n\t\t\t<span id='loading-status' class=\"visuallyhidden\" aria-live='polite'></span>\n\t\t</div>\t\t\n\t</div>\n\n\t<div class=\"main-controls-container\">\n\t\t<div class=\"ac-video-overlay-container\"></div>\n\t\t<div class=\"main-controls\">\n\t\t\t<div class=\"button-wrapper\">\n\t\t\t\t<div class=\"main-controls-item controls-volume\">\n\t\t\t\t\t<button type=\"button\" class=\"ac-video-icon {elementClassPrefix}-toggle-mute-volume-button {elementClassPrefix}-button\" value=\"{togglemutevolume}\" aria-label=\"{togglemutevolume}\" role=\"button\" tabindex=\"0\" data-acv-active-area></button>\n\t\t\t\t\t<div class=\"{elementClassPrefix}-volume-level-indicator\" tabindex=\"0\" aria-valuemin=\"0\" aria-valuemax=\"100\" min=\"0\" max=\"100\" aria-label=\"{adjustvolume}\" role=\"slider\" aria-orientation=\"vertical\" step=\"0.05\" data-acv-active-area></div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"button-wrapper\">\n\t\t\t\t<button type=\"button\" class=\"ac-video-icon main-controls-item {elementClassPrefix}-text-tracks-toggle-button {elementClassPrefix}-button no-text-tracks\" value=\"{captionscontrol}\" aria-label=\"{captionscontrol}\" role=\"button\" tabindex=\"0\" data-acv-active-area></button>\n\t\t\t\t<div class=\"ac-video-captions-selector-container\">\n\t\t\t\t\t<span class=\"ac-video-captions-selector-title\">{subtitlescontrol}</span>\n\t\t\t\t\t<ul class=\"{elementClassPrefix}-captions-selector\" role=\"radiogroup\" aria-label=\"{subtitlescontrol}\" data-acv-active-area></ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"main-controls-item controls-progress\">\n\t\t\t\t<div class=\"controls-progress-time controls-progress-time-1\">\n\t\t\t\t\t<div class=\"{elementClassPrefix}-elapsed-time-indicator\" role=\"text\" tabindex=\"-1\">\n\t\t\t\t\t\t<span class=\"label\">{elapsed}</span>\n\t\t\t\t\t\t<span class=\"{elementClassPrefix}-elapsed-time\">00:00</span>\n\t\t\t\t\t\t<span class=\"{elementClassPrefix}-time-maxwidth\" aria-hidden=\"true\">44:44</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"controls-progress-bar\">\n\t\t\t\t\t<div class=\"{elementClassPrefix}-buffered-indicator\"></div>\n\t\t\t\t\t<div class=\"{elementClassPrefix}-progress-indicator ac-slider-inactive\" aria-label=\"progress-indicator\" role=\"slider\" precision=\"float\" min=\"0\" max=\"1\" step=\"0.0005\" value=\"0\" tabindex=\"0\" aria-valuemax=\"1\" aria-valuemin=\"0\" aria-valuenow=\"{value}\" data-acv-active-area></div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"controls-progress-time controls-progress-time-2\">\n\t\t\t\t\t<div class=\"{elementClassPrefix}-remaining-time-indicator\" role=\"text\" tabindex=\"-1\">\n\t\t\t\t\t\t<span class=\"label\">{remaining}</span>\n\t\t\t\t\t\t<span class=\"{elementClassPrefix}-remaining-time\">-00:00</span>\n\t\t\t\t\t\t<span class=\"{elementClassPrefix}-time-maxwidth\" aria-hidden=\"true\">-44:44</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t<div class=\"main-controls-item live-stream\">\n\t\t\t\t<span class=\"live-stream-text\">{livestream}</span>\n\t\t\t</div>\n\n\t\t\t<div class=\"button-wrapper\">\n\t\t\t\t<button type=\"button\" class=\"ac-video-icon main-controls-item {elementClassPrefix}-airplay-button {elementClassPrefix}-button airplay-unsupported\" value=\"{airplay}\" aria-label=\"{airplay}\" role=\"button\" tabindex=\"0\" data-acv-active-area></button>\n\t\t\t</div>\n\n\t\t\t<div class=\"button-wrapper\">\n\t\t\t\t<button type=\"button\" class=\"ac-video-icon main-controls-item {elementClassPrefix}-picture-in-picture-button {elementClassPrefix}-button picture-in-picture-unsupported\" value=\"{pictureinpicture}\" aria-label=\"{pictureinpicture}\" role=\"button\" tabindex=\"0\" data-acv-active-area></button>\n\t\t\t</div>\n\n\t\t\t<div class=\"button-wrapper\">\n\t\t\t\t<button type=\"button\" class=\"ac-video-icon main-controls-item {elementClassPrefix}-full-screen-button {elementClassPrefix}-button fullscreen-unsupported\" value=\"{fullscreen}\" aria-label=\"{fullscreen}\" role=\"button\" tabindex=\"0\" data-acv-active-area></button>\n\t\t\t</div>\n\t\t\t\n\t\t</div>\n\t</div>\n\n\t<div class=\"end-state-wrapper\">\n\t\t<div class=\"end-state-container\"></div>\n\t</div>\n\n\n</div>\n\n<div class=\"compass-wrapper\" data-acv-active-area>\n\t<div class=\"compass-background ac-video-icon\"></div>\n\t<div class=\"compass-arrows\">\n\t\t<button class=\"compass-arrow-top ac-video-icon\" aria-label=\"{threesixtyup}\" role=\"button\" tabindex=\"0\"></button>\n\t\t<button class=\"compass-arrow-right ac-video-icon\" aria-label=\"{threesixtyright}\" role=\"button\" tabindex=\"0\"></button>\n\t\t<button class=\"compass-arrow-bottom ac-video-icon\" aria-label=\"{threesixtydown}\" role=\"button\" tabindex=\"0\"></button>\n\t\t<button class=\"compass-arrow-left ac-video-icon\" aria-label=\"{threesixtyleft}\" role=\"button\" tabindex=\"0\"></button>\n\t</div>\n\t<div class=\"compass-field ac-video-icon\"></div>\n\t<div class=\"compass-ring ac-video-icon\"></div>\n\t<button class=\"compass\" aria-label=\"{threesixtyicon}\" role=\"button\" tabindex=\"0\"></button>\n</div>\n"},{}],267:[function(require,module,exports){"use strict";module.exports="<div class=\"ac-video-trickplay hidden\" aria-hidden=\"true\">\n    <div class=\"ac-video-trickplay-image\">\n    </div>\n    <div class=\"ac-video-trickplay-chapter-title\"></div>\n    <div class=\"ac-video-trickplay-time\"></div>\n</div>"},{}],268:[function(require,module,exports){"use strict";module.exports="\n<div class=\"ac-slider-ax-track\" role=\"slider\" aria-valuemin=\"0\" aria-valuemax=\"1\" ></div>\n<div class=\"ac-slider-runnable-track\">\n\t<div class=\"ac-slider-hover-track\">\n\t\t<div class=\"ac-slider-hover-notch\"></div>\n\t</div>\n\t<div class=\"ac-slider-thumb\">\n\t\t<div class=\"ac-slider-thumb-background-wrapper\">\n\t\t\t<div class=\"ac-slider-thumb-overlay\"></div>\n\t\t\t<div class=\"ac-slider-thumb-background\"></div>\n\t\t</div>\n\t</div>\n\t<div class=\"ac-slider-chapters-track\"></div>\n\t<div class=\"ac-slider-inner-track\">\n\t\t<div class=\"ac-slider-buffered\"></div>\n\t\t<div class=\"ac-slider-scrubbed\"></div>\n\t</div>\n</div>\n"},{}],269:[function(require,module,exports){'use strict';module.exports='<a class="end-state-link hidden"></a>'},{}],270:[function(require,module,exports){'use strict';module.exports='<iframe src="{embedCodePath}{videoid}{extension}" width="{width}" height="{height}" title="{title}" allowfullscreen></iframe>'},{}],271:[function(require,module,exports){"use strict";module.exports="<div class=\"sharing-state\">\n    <div class=\"container\" data-acv-active-area>\n        <div class=\"social-sharing-container\">\n            <div class=\"sharing-button-container\">\n                <button class=\"acv-fb-share ac-video-icon icon-share_fb\" aria-label=\"{facebookshare}, {newwindow}\"></button>\n                <button class=\"acv-tw-share ac-video-icon icon-share_twitter\" aria-label=\"{twittershare}, {newwindow}\"></button>\n                <button class=\"copy-link ac-video-icon icon-share_link\" aria-label=\"{copylink}\"></button>\n                <button class=\"copy-embed-code ac-video-icon icon-share_embed\" aria-label=\"{copyembed}\"></button>\n            </div>\n        </div>\n        <div class=\"textarea-container\">\n            <span>\n                <input class=\"copy-area form-textbox form-textbox-text disabled\" type=\"text\" id=\"copy-link\" aria-label=\"{copylink}\"></input>\n                <button class=\"textinput-close-button ac-video-icon icon-share_close\" aria-label=\"{dismisscopy}\"></button>\n            </span>\n        </div>\n    </div>\n</div>"},{}],272:[function(require,module,exports){"use strict";module.exports="\n<div class=\"ac-slider-runnable-track\">\n\t<div class=\"ac-slider-background\"></div>\n\t<div class=\"ac-slider-thumb-wrapper\">\n\t\t<div class=\"ac-slider-thumb\">\n\t\t\t<div class=\"ac-slider-thumb-background-wrapper\">\n\t\t\t\t<div class=\"ac-slider-thumb-background\"></div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t<div class=\"ac-slider-inner-track\">\n\t\t<div class=\"ac-slider-scrubbed\"></div>\n\t</div>\n</div>\n"},{}],273:[function(require,module,exports){'use strict';var EventEmitterMicro=require('@marcom/ac-event-emitter-micro').EventEmitterMicro;var BreakpointDetect=function BreakpointDetect(options){EventEmitterMicro.call(this);this.el=options.el||document.body;this.breakpoints=options.breakpoints.sort(function(a,b){return a.minWidth-b.minWidth});this._player=options.player;this._breakPointsLength=this.breakpoints.length;this._addClasses=options.addClass;this._addEventListeners();this._onResize()};var superProto=EventEmitterMicro.prototype;var proto=BreakpointDetect.prototype=Object.create(superProto);proto.constructor=BreakpointDetect;proto._addEventListeners=function(){var self=this;this._boundOnResize=function(){self._onResize.apply(self,arguments)};window.addEventListener('resize',this._boundOnResize);window.addEventListener('orientationchange',this._boundOnResize);window.addEventListener('DOMContentLoaded',this._boundOnResize)};proto._removeEventListeners=function(){window.removeEventListener('resize',this._boundOnResize);window.removeEventListener('orientationchange',this._boundOnResize);window.addEventListener('DOMContentLoaded',this._boundOnResize)};proto._onResize=function(refreshPlayer){var clientWidth=this.el.clientWidth;var currentBP=this._currentBreakpoint;if(refreshPlayer!==!1){this._player.refreshSize()}
if(currentBP&&BreakpointDetect.widthInBreakpoint(clientWidth,currentBP)){return}
var newBreakpoint=BreakpointDetect.getBreakpointFromWidth(clientWidth,this.breakpoints,currentBP,this._breakPointsLength);if(this._addClasses){this._currentBreakpoint&&this.el.classList.remove(currentBP.name);this.el.classList.add(newBreakpoint.name)}
this._currentBreakpoint=newBreakpoint;this.trigger('breakpointchange',newBreakpoint)};proto.getCurrentBreakpoint=function(){return this._currentBreakpoint};proto.refresh=function(){this._onResize(!1)};proto.destroy=function(){this._removeEventListeners();superProto.destroy.call(this)};BreakpointDetect.getBreakpointFromElement=function(el,breakpoints){return BreakpointDetect.getBreakpointFromWidth(el.clientWidth,breakpoints)};BreakpointDetect.getBreakpointFromWidth=function(clientWidth,breakpoints,excludeBP,cachedLength){var i=0;var len=cachedLength||breakpoints.length;for(;i<len;i++){var bp=breakpoints[i];if(bp===excludeBP){continue}
if(clientWidth>=bp.minWidth&&clientWidth<=bp.maxWidth){return bp}}
return null};BreakpointDetect.widthInBreakpoint=function(clientWidth,breakpoint){return clientWidth>=breakpoint.minWidth&&clientWidth<=breakpoint.maxWidth};module.exports=BreakpointDetect},{"@marcom/ac-event-emitter-micro":89}],274:[function(require,module,exports){'use strict';var supplant=require('@marcom/ac-string/supplant');var Time={addLeadingZero:function addLeadingZero(number,size){size=size||2;if(number<10||size>2){number=String(number);while(number.length<size){number='0'+number}}
return number},formatTime:function formatTime(time,totalTime,leadingZero){if(isNaN(time)){return'00:00'}
time=this.splitTime(Math.floor(time),totalTime,function(number){return this.addLeadingZero(number,leadingZero)}.bind(this));var template;if(totalTime>=3600){template='{PN}{hours}:{minutes}:{seconds}'}else{template='{PN}{minutes}:{seconds}'}
var currentTime=supplant(template,{PN:time.negativeModifier,hours:time.hours,minutes:time.minutes,seconds:time.seconds});return currentTime},splitTime:function splitTime(seconds,totalTime,formatingFunction){formatingFunction=formatingFunction||function(number){return number};var time={negativeModifier:'',hours:0,minutes:0,seconds:0};if(isNaN(seconds)){return time}
time.negativeModifier=seconds<0?'-':'';seconds=Math.abs(seconds);time.hours=totalTime>=3600?Math.floor(seconds/3600):0;time.minutes=time.hours?Math.floor(seconds/60%60):Math.floor(seconds/60);time.seconds=seconds%60;for(var property in time){if(typeof time[property]!=='number'){continue}
if(property!=='hours'){time[property]=formatingFunction(time[property])}}
return time},stringToNumber:function stringToNumber(timeString){var time=0;var split=timeString.split(':');while(split.length){if(split.length===3){time+=parseFloat(split.shift())*3600}else if(split.length===2){time+=parseFloat(split.shift())*60}else{time+=parseFloat(split.shift())}}
return time}};module.exports=Time},{"@marcom/ac-string/supplant":193}],275:[function(require,module,exports){'use strict';module.exports=require('../../../.versionfile')},{"../../../.versionfile":199}],276:[function(require,module,exports){'use strict';var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};var clone=require('@marcom/ac-object/clone');var merge=function merge(){var args=Array.prototype.slice.call(arguments);if(args.length<2){return clone(args[0])}
var dest=clone(args.shift(),!0);var source=args.shift();for(var prop in source){if(source.hasOwnProperty(prop)){if(!dest.hasOwnProperty(prop)||_typeof(dest[prop])!=='object'){dest[prop]=source[prop]}else if(_typeof(dest[prop])==='object'&&_typeof(source[prop])==='object'){dest[prop]=merge(dest[prop],source[prop])}}}
if(args.length){return merge.apply(null,[dest].concat(args))}else{return dest}};module.exports=merge},{"@marcom/ac-object/clone":123}],277:[function(require,module,exports){'use strict';module.exports=[{'width':384,'height':160,'type':'baseline-high','suffix':'h'},{'width':384,'height':160,'type':'small','suffix':'h'},{'width':384,'height':160,'type':'baseline-low','suffix':'l'},{'width':384,'height':160,'type':'baseline-medium','suffix':'m'},{'width':480,'height':200,'type':'medium','suffix':'h'},{'width':768,'height':320,'type':'large','suffix':''},{'width':960,'height':400,'type':'large','suffix':''},{'width':1536,'height':640,'type':'large','suffix':'h'},{'width':1536,'height':640,'type':'large','suffix':'l'},{'width':1920,'height':800,'type':'large','suffix':'l'},{'width':1920,'height':800,'type':'large','suffix':'h'}]},{}],278:[function(require,module,exports){'use strict';module.exports=[{'width':416,'height':234,'type':'baseline-high','suffix':'h'},{'width':416,'height':234,'type':'small','suffix':'h'},{'width':416,'height':234,'type':'baseline-low','suffix':'l'},{'width':416,'height':234,'type':'baseline-medium','suffix':'m'},{'width':640,'height':360,'type':'medium','suffix':'h'},{'width':848,'height':480,'type':'large','suffix':''},{'width':960,'height':540,'type':'large','suffix':''},{'width':1280,'height':720,'type':'large','suffix':'h'},{'width':1280,'height':720,'type':'large','suffix':'l'},{'width':1920,'height':1080,'type':'large','suffix':'l'},{'width':1920,'height':1080,'type':'large','suffix':'h'}]},{}],279:[function(require,module,exports){'use strict';module.exports=[{'width':528,'height':244,'type':'baseline-high','suffix':'h'},{'width':528,'height':244,'type':'small','suffix':'h'},{'width':528,'height':244,'type':'baseline-low','suffix':'l'},{'width':528,'height':244,'type':'baseline-medium','suffix':'m'},{'width':812,'height':375,'type':'medium','suffix':'h'},{'width':1082,'height':500,'type':'large','suffix':''},{'width':1218,'height':563,'type':'large','suffix':''},{'width':1624,'height':750,'type':'large','suffix':'h'},{'width':1624,'height':750,'type':'large','suffix':'l'},{'width':2436,'height':1126,'type':'large','suffix':'l'},{'width':2436,'height':1126,'type':'large','suffix':'h'}]},{}],280:[function(require,module,exports){'use strict';module.exports=[{'width':360,'height':360,'type':'baseline-high','suffix':'h'},{'width':360,'height':360,'type':'small','suffix':'h'},{'width':360,'height':360,'type':'baseline-low','suffix':'l'},{'width':480,'height':480,'type':'medium','suffix':''},{'width':540,'height':540,'type':'medium','suffix':''},{'width':720,'height':720,'type':'large','suffix':'h'},{'width':720,'height':720,'type':'large','suffix':'l'},{'width':1080,'height':1080,'type':'large','suffix':'l'},{'width':1080,'height':1080,'type':'large','suffix':'h'}]},{}],281:[function(require,module,exports){'use strict';var supplant=require('@marcom/ac-string/supplant');var LEGACY_REF_PATTERN=/_r[0-9].+\.mov$/;var REF_PATTERN=/_[0-9]+x[0-9].+\.mp4$/;var THUMBNAIL_REF_PATTERN=/_[0-9]+x[0-9].+\.(mp4|m3u8)/;var URL_SIZE=/_([0-9]+)x([0-9]+)/;var HAS_THUMBNAILS_PATTERN=/-tpl-.*-/;var HAS_CC_PATTERN=/-cc-[a-z].*-/;var IS_12X5_PATTERN=/-tft-.*-/;var m='m';var VAT_SOURCE_TEMPLATE='_{width}x{height}{suffix}.'+m+'p4';var VAT_SOURCE_TEMPLATE_VERTICAL='_{height}x{width}{suffix}.'+m+'p4';var j='j';var THUMBNAILS_SUFFIX='_thumbnails.'+j+'pg';var _1X1_ASSET_SIZES=require('./1X1AssetSizes');var _16X9_ASSET_SIZES=require('./16X9AssetSizes');var _12X5_ASSET_SIZES=require('./12X5AssetSizes');var _19X9_ASSET_SIZES=require('./19X9AssetSizes');var containsMatch=function containsMatch(array,urlSize){return array.find(function(size){return size.width===urlSize.width&&(size.height=urlSize.height)||size.width===urlSize.height&&(size.height=urlSize.width)})};var getVideoSource=function getVideoSource(originalUrl,width,type,options){var sizes;var defaultMaxWidth;URL_SIZE.test(originalUrl);var urlSize={};var isVertical;urlSize.width=parseInt(RegExp.$1,10);urlSize.height=parseInt(RegExp.$2,10);if(originalUrl.match(IS_12X5_PATTERN)){sizes=_12X5_ASSET_SIZES;defaultMaxWidth=1536}else if(urlSize.width===urlSize.height){sizes=_1X1_ASSET_SIZES;defaultMaxWidth=1080}else if(originalUrl.match(LEGACY_REF_PATTERN)||containsMatch(_16X9_ASSET_SIZES,urlSize)){sizes=_16X9_ASSET_SIZES;defaultMaxWidth=1280}else if(containsMatch(_19X9_ASSET_SIZES,urlSize)){sizes=_19X9_ASSET_SIZES;defaultMaxWidth=1624}else{return originalUrl}
if(urlSize.width<urlSize.height){isVertical=!0}
var minimumWidth=sizes[0].width;var maxWidth=options&&options.maxWidth?Math.max(options.maxWidth,minimumWidth):defaultMaxWidth;if(!originalUrl){throw 'Must provide an url to optimize'}
if(width===undefined||isNaN(width)){throw 'Must provide a width'}
if(width===0){width=urlSize.width}
if(type){sizes=sizes.filter(function(size){return size.type===type})}
if(maxWidth<1920){sizes=sizes.filter(function(size){return size.width<=maxWidth})}
var sourceData;if(!isVertical){sourceData=sizes.reduce(function(prev,curr){return Math.abs(curr.width-width)<Math.abs(prev.width-width)?curr:prev})}else{sourceData=sizes.reduce(function(prev,curr){return Math.abs(curr.height-width)<Math.abs(prev.height-width)?curr:prev})}
var vatTemplate=VAT_SOURCE_TEMPLATE;if(isVertical){vatTemplate=VAT_SOURCE_TEMPLATE_VERTICAL}
if(originalUrl.match(REF_PATTERN)){return originalUrl.replace(REF_PATTERN,supplant(vatTemplate,sourceData))}else if(originalUrl.match(LEGACY_REF_PATTERN)){return originalUrl.replace(LEGACY_REF_PATTERN,supplant(vatTemplate,sourceData))}else{return originalUrl}};var getCaptionsSource=function getCaptionsSource(url){if(!url.match(HAS_CC_PATTERN)){return null}
if(url.match(REF_PATTERN)){return{src:url.replace(REF_PATTERN,'_cc.vtt'),srclang:'en'}}else if(url.match(LEGACY_REF_PATTERN)){return{src:url.replace(LEGACY_REF_PATTERN,'_cc.vtt'),srclang:'en'}}else{return null}};var getThumbnailImageSource=function getThumbnailImageSource(url){if(!url.match(HAS_THUMBNAILS_PATTERN)){return null}else{return{url:url.replace(THUMBNAIL_REF_PATTERN,THUMBNAILS_SUFFIX)}}};module.exports={getVideoSource:getVideoSource,getCaptionsSource:getCaptionsSource,getThumbnailImageSource:getThumbnailImageSource}},{"./12X5AssetSizes":277,"./16X9AssetSizes":278,"./19X9AssetSizes":279,"./1X1AssetSizes":280,"@marcom/ac-string/supplant":193}],282:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var Hls=window.Hls;var log=require('@marcom/ac-console/log');var HTML5Video=require('./HTML5Video');var HLSVideo=function(_HTML5Video){_inherits(HLSVideo,_HTML5Video);function HLSVideo(options){_classCallCheck(this,HLSVideo);var _this=_possibleConstructorReturn(this,(HLSVideo.__proto__||Object.getPrototypeOf(HLSVideo)).call(this,options));_this._src=null;_this._initialize(options);return _this}
_createClass(HLSVideo,[{key:'_initialize',value:function _initialize(options){if(typeof window.Hls==='undefined'){throw new Error('Hls.js should be included on the page in a script tag')}
this._debugHls=options.debugHls;this._enablePerformanceLogging=options.enablePerformanceLogging;this._onTextTrackChangeAfterLoad=this._onTextTrackChangeAfterLoad.bind(this);this._onHlsError=this._onHlsError.bind(this);this._onDesiredRateChanged=this._onDesiredRateChanged.bind(this);this._onPlay=this._onPlay.bind(this);this.on('play',this._onPlay)}},{key:'_initHls',value:function _initHls(){if(this._hls){this.getTextTracksEventEmitter().off('addtrack',this._onTextTrackChangeAfterLoad);this._cachedVisibleTracks=Array.from(this.el.textTracks).filter(function(track){return track.mode==='showing'});this._hls.off(Hls.Events.ERROR,this._onHlsError);this._hls.off(Hls.Events.DESIRED_RATE_CHANGED,this._onDesiredRateChanged);this._hls.destroy();var newEl=this.el.cloneNode(!1);this.el.parentElement.replaceChild(newEl,this.el);this.el=newEl;this.replaceElement(newEl);var trackEmitter=this.getTextTracksEventEmitter();trackEmitter.replaceElement(this.el.textTracks);trackEmitter.on('addtrack',this._onTextTrackChangeAfterLoad)}
this._hls=new Hls({debug:this._debugHls,enableWorker:!0,enableStreaming:!0,autoRecoverError:!0,enablePerformanceLogging:this._enablePerformanceLogging||!1})}},{key:'load',value:function load(sourceUrls,textTracks){this._initHls();this._hls.on(Hls.Events.ERROR,this._onHlsError);this._hls.on(Hls.Events.DESIRED_RATE_CHANGED,this._onDesiredRateChanged);this._src=sourceUrls[0];var mediaAttached=function(){this._mediaAttached=!0;this._hls.off(Hls.Events.MEDIA_ATTACHED,mediaAttached);this.setSrc(sourceUrls[0]);this._createTextTrackTags(textTracks)}.bind(this);this._hls.on(Hls.Events.MEDIA_ATTACHED,mediaAttached);this._hls.attachMedia(this.el)}},{key:'setSrc',value:function setSrc(src){if(!this._hls){this._initHls()}
this._src=src;this._manifestParsed=!1;this._hls.loadSource(src,{appData:{}});this._hls.on(Hls.Events.MANIFEST_PARSED,this._boundManifestParsed=function(){this._manifestParsed=!0;this._hls.off(Hls.Events.MANIFEST_PARSED,this._boundManifestParsed);if(this._shouldPlay){this.play()}}.bind(this))}},{key:'getCurrentSrc',value:function getCurrentSrc(){return this._src}},{key:'canPlayType',value:function canPlayType(mimeType){if(mimeType==='vnd.apple.mpegURL'){return _get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'canPlayType',this).call(this,'video/mp4')}else{return _get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'canPlayType',this).call(this,mimeType)}}},{key:'_playPromiseRejected',value:function _playPromiseRejected(){if(typeof this._hls.desiredRate!=='undefined'){this._hls.desiredRate=0}
_get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'_playPromiseRejected',this).call(this)}},{key:'_onTextTrackChangeAfterLoad',value:function _onTextTrackChangeAfterLoad(){var _this2=this;if(this._cachedVisibleTracks&&this.el.textTracks.length>1){this._cachedVisibleTracks.forEach(function(oldTrack){var newTrack=Array.from(_this2.el.textTracks).find(function(newTrack){return oldTrack.language===newTrack.language});if(newTrack){newTrack.mode='showing'}});this.getTextTracksEventEmitter().off('addtrack',this._onTextTrackChangeAfterLoad);this._cachedVisibleTracks=null}}},{key:'_onPlay',value:function _onPlay(){if(this._hls&&this._hls.desiredRate===0){this._hls.desiredRate=1}}},{key:'getError',value:function getError(){return this.el.error||this._error}},{key:'destroy',value:function destroy(){this.off('play',this._onPlay);_get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'destroy',this).call(this);if(this._hls){this._hls.destroy();this._hls=null}}},{key:'_onHlsError',value:function _onHlsError(evt,data){if(data.fatal===!0){if(data.details==='fragLoadError'){log('HLS JS threw a fatal fragLoadError error, but we\'ll try to let it recover because it probably can if the network/stream recovers')}else{this._error=data.type;this.trigger('error',data)}}}},{key:'_onDesiredRateChanged',value:function _onDesiredRateChanged(evt){if(this._hls.desiredRate===0){this.trigger('pause')}else{this.trigger('play')}}},{key:'play',value:function play(){this._shouldPlay=!0;if(this._manifestParsed){if(!this._mediaAttached){this.load([this._src])}
_get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'play',this).call(this)}}},{key:'pause',value:function pause(){this._shouldPlay=!1;_get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'pause',this).call(this)}},{key:'getPaused',value:function getPaused(){if(this._hls&&typeof this._hls.desiredRate!=='undefined'){return this._hls.desiredRate===0}else{return _get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'getPaused',this).call(this)}}},{key:'isStalled',value:function isStalled(){if(this._hls.desiredRate!==undefined){return this._hls.desiredRate===1&&this._hls.desiredRate!==this._hls.effectiveRate||_get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'isStalled',this).call(this)}
return _get(HLSVideo.prototype.__proto__||Object.getPrototypeOf(HLSVideo.prototype),'isStalled',this).call(this)}}]);return HLSVideo}(HTML5Video);module.exports=HLSVideo},{"./HTML5Video":283,"@marcom/ac-console/log":51}],283:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var DOMEmitter=require('../dom-emitter/DOMEmitterMicro');var createTextTracks=require('../texttracks/createTextTracks');var log=require('@marcom/ac-console/log');var doc=window.document;var isSafari=require('@marcom/useragent-detect').browser.safari;var UNSTALLED_READY_STATE=isSafari?4:3;var HTML5Video=function(_DOMEmitter){_inherits(HTML5Video,_DOMEmitter);function HTML5Video(options){_classCallCheck(this,HTML5Video);var el=options&&options.mediaElement?options.mediaElement:doc.createElement('video');var _this=_possibleConstructorReturn(this,(HTML5Video.__proto__||Object.getPrototypeOf(HTML5Video)).call(this,el));_this.el=el;_this.options=options||{};_this._textTracks=createTextTracks(options);_this._initElement();_this._forwardCaptionEvent=_this._forwardCaptionEvent.bind(_this);_this._textTracksEmitter=_this.getTextTracksEventEmitter();_this._textTracksEmitter.on('addtrack',_this._forwardCaptionEvent);_this._textTracksEmitter.on('change',_this._forwardCaptionEvent);_this._textTracksEmitter.on('removetrack',_this._forwardCaptionEvent);return _this}
_createClass(HTML5Video,[{key:'_initElement',value:function _initElement(){this.el.classList.add('ac-video-media-controller');if(this.options.crossorigin!==null){this.el.setAttribute('crossorigin',this.options.crossorigin?this.options.crossorigin:'anonymous')}
this.el.setAttribute('preload',this.options.preload||'auto');this.el.setAttribute('x-webkit-airplay','')}},{key:'_forwardCaptionEvent',value:function _forwardCaptionEvent(evt){this.trigger(evt.type)}},{key:'load',value:function load(sourceUrls,textTracks,startTime){if(startTime){sourceUrls=sourceUrls.map(function(url){return url+'#t='+startTime})}
this._createSourceTags(sourceUrls);this._createTextTrackTags(textTracks);this.el.load()}},{key:'_createSourceTags',value:function _createSourceTags(sourceUrls){this.el.removeAttribute('src');this.el.innerHTML='';var i=0;var len=sourceUrls.length;if(len){this.el.setAttribute('src',sourceUrls[0])}
for(;i<len;i++){var source=doc.createElement('source');source.src=sourceUrls[i];this.el.appendChild(source)}}},{key:'_playPromiseRejected',value:function _playPromiseRejected(){this.trigger('PlayPromiseError')}},{key:'play',value:function play(){try{var promise=this.el.play();if(promise&&typeof promise['catch']==='function'){promise['catch'](function(err){if(this._playPromise===promise){this._playPromiseRejected()}}.bind(this));promise.then(function(){this.trigger('PlayPromiseResolved')}.bind(this),function(rejection){log(rejection)})}
this._playPromise=promise}catch(err){log(err)}}},{key:'refreshSize',value:function refreshSize(){}},{key:'pause',value:function pause(){this._playPromise=null;this.el.pause()}},{key:'addTextTrack',value:function addTextTrack(trackObject){this._addTextTrackTag(trackObject)}},{key:'removeTextTrack',value:function removeTextTrack(trackObject){this._removeTextTrackTag(trackObject)}},{key:'getRenderElement',value:function getRenderElement(){return this.getMediaElement()}},{key:'getMediaElement',value:function getMediaElement(){return this.el}},{key:'_createTextTrackTags',value:function _createTextTrackTags(){return this._textTracks.create.apply(this,arguments)}},{key:'_addTextTrackTag',value:function _addTextTrackTag(){return this._textTracks.add.apply(this,arguments)}},{key:'_removeTextTrackTag',value:function _removeTextTrackTag(){return this._textTracks.remove.apply(this,arguments)}},{key:'getTextTracks',value:function getTextTracks(){return this._textTracks.get.apply(this,arguments)}},{key:'getTextTracksEventEmitter',value:function getTextTracksEventEmitter(){return this._textTracks.getEmitter.apply(this,arguments)}},{key:'getReadyState',value:function getReadyState(){return this.el.readyState}},{key:'getPreload',value:function getPreload(){return this.el.preload}},{key:'setPreload',value:function setPreload(value){return this.el.preload=value}},{key:'setPoster',value:function setPoster(url){if(url){this.el.poster=url}else{this.el.removeAttribute('poster')}}},{key:'getVolume',value:function getVolume(){return this.el.volume}},{key:'getMuted',value:function getMuted(){return this.el.muted}},{key:'getPaused',value:function getPaused(){return this.el.paused}},{key:'getCurrentTime',value:function getCurrentTime(){return this.el.currentTime}},{key:'getDuration',value:function getDuration(){return this.el.duration}},{key:'setCurrentTime',value:function setCurrentTime(time){return this.el.currentTime=time}},{key:'setVolume',value:function setVolume(volume){return this.el.volume=volume}},{key:'setMuted',value:function setMuted(muted){this.el.muted=muted}},{key:'getEnded',value:function getEnded(){return this.el.ended}},{key:'getError',value:function getError(){return this.el.error}},{key:'setSrc',value:function setSrc(url){if(!this.el.childNodes.length||url!==this._getSrcNode().url){this._createSourceTags([url])}}},{key:'advanceLiveStream',value:function advanceLiveStream(){}},{key:'getCurrentSrc',value:function getCurrentSrc(){return this.el.src}},{key:'_getSrcNode',value:function _getSrcNode(){return this.el.childNodes[0]}},{key:'setControls',value:function setControls(enable){if(!enable){this.el.removeAttribute('controls');this.el.setAttribute('aria-hidden','true')}else{this.el.setAttribute('controls','');this.el.removeAttribute('aria-hidden')}}},{key:'isFullscreen',value:function isFullscreen(){return this.el.webkitDisplayingFullscreen}},{key:'supportsPictureInPicture',value:function supportsPictureInPicture(){return typeof this.el.webkitSetPresentationMode==='function'}},{key:'isPictureInPicture',value:function isPictureInPicture(){return this.el.webkitPresentationMode==='picture-in-picture'}},{key:'setPictureInPicture',value:function setPictureInPicture(enable){if(!this.supportsPictureInPicture()){return}
this.el.webkitSetPresentationMode(enable?'picture-in-picture':'inline')}},{key:'supportsAirPlay',value:function supportsAirPlay(){return!!window.WebKitPlaybackTargetAvailabilityEvent}},{key:'canPlayType',value:function canPlayType(mimeType){return this.el.canPlayType(mimeType)}},{key:'getBuffered',value:function getBuffered(){return this.el.buffered}},{key:'isStalled',value:function isStalled(){return this.getReadyState()<UNSTALLED_READY_STATE}},{key:'destroy',value:function destroy(){if(this._textTracksEmitter){this._textTracksEmitter.off('addtrack',this._forwardCaptionEvent);this._textTracksEmitter.off('change',this._forwardCaptionEvent);this._textTracksEmitter.off('removetrack',this._forwardCaptionEvent)}
if(this._textTracks){this._textTracks.destroy.call(this)}
this._textTracks=null;this._textTracksEmitter=null;this.el=null}}]);return HTML5Video}(DOMEmitter);module.exports=HTML5Video},{"../dom-emitter/DOMEmitterMicro":201,"../texttracks/createTextTracks":216,"@marcom/ac-console/log":51,"@marcom/useragent-detect":308}],284:[function(require,module,exports){'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor}}();var _get=function get(object,property,receiver){if(object===null)object=Function.prototype;var desc=Object.getOwnPropertyDescriptor(object,property);if(desc===undefined){var parent=Object.getPrototypeOf(object);if(parent===null){return undefined}else{return get(parent,property,receiver)}}else if("value" in desc){return desc.value}else{var getter=desc.get;if(getter===undefined){return undefined}return getter.call(receiver)}};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return call&&(typeof call==="object"||typeof call==="function")?call:self}
function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass)}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass}
var HTML5Video=require('./HTML5Video');var AC360=require('@marcom/ac-360');var ThreeSixytyVideo=function(_HTML5Video){_inherits(ThreeSixytyVideo,_HTML5Video);function ThreeSixytyVideo(options){_classCallCheck(this,ThreeSixytyVideo);var _this=_possibleConstructorReturn(this,(ThreeSixytyVideo.__proto__||Object.getPrototypeOf(ThreeSixytyVideo)).call(this,options));_this._renderElement=document.createElement('div');_this._renderElement.classList.add('threesixty-video-container');_this.el.style.visibility='hidden';_this.el.style.opacity=0;_this._renderElement.appendChild(_this.el);_this._ac360=new AC360({el:_this._renderElement,src:_this.getMediaElement()});_this._ac360.on('error',function(){this._error='360_ERROR';this.trigger('error')}.bind(_this));_this.sendMouseDown=_this.sendMouseDown.bind(_this);return _this}
_createClass(ThreeSixytyVideo,[{key:'load',value:function load(){this._ac360.setPos(0,0);_get(ThreeSixytyVideo.prototype.__proto__||Object.getPrototypeOf(ThreeSixytyVideo.prototype),'load',this).apply(this,arguments)}},{key:'play',value:function play(){if(this.getEnded()){this._ac360.setPos(0,0)}
_get(ThreeSixytyVideo.prototype.__proto__||Object.getPrototypeOf(ThreeSixytyVideo.prototype),'play',this).call(this)}},{key:'sendMouseDown',value:function sendMouseDown(evt){this._ac360.sendMouseDown(evt)}},{key:'getRenderElement',value:function getRenderElement(){return this._renderElement}},{key:'get360',value:function get360(){return this._ac360}},{key:'setControls',value:function setControls(enable){_get(ThreeSixytyVideo.prototype.__proto__||Object.getPrototypeOf(ThreeSixytyVideo.prototype),'setControls',this).call(this,!1)}},{key:'supportsPictureInPicture',value:function supportsPictureInPicture(){return!1}},{key:'supportsAirPlay',value:function supportsAirPlay(){return!1}},{key:'refreshSize',value:function refreshSize(){this._ac360.refreshSize()}},{key:'getError',value:function getError(){return this._error||_get(ThreeSixytyVideo.prototype.__proto__||Object.getPrototypeOf(ThreeSixytyVideo.prototype),'getError',this).call(this)}}]);return ThreeSixytyVideo}(HTML5Video);module.exports=ThreeSixytyVideo},{"./HTML5Video":283,"@marcom/ac-360":13}],285:[function(require,module,exports){'use strict';var userAgent=require('@marcom/useragent-detect');var SUPPORTS_NATIVE_HLS=userAgent.browser.safari||userAgent.browser.edge;var SUPPORTS_MSE='MediaSource' in window;var VideoFactory=function VideoFactory(){};var proto=VideoFactory.prototype;proto.create=function(options,parentElement){if(options.hls&&!SUPPORTS_NATIVE_HLS&&SUPPORTS_MSE){var HLSVideo=require('./HLSVideo');return new HLSVideo(Object.assign({},options,{parentElement:parentElement}))}else if(options.threesixty){var ThreeSixtyVideo=require('./ThreeSixtyVideo');return new ThreeSixtyVideo(Object.assign({},options,{parentElement:parentElement}))}else{var HTML5Video=require('./HTML5Video');return new HTML5Video(Object.assign({},options,{parentElement:parentElement}))}};module.exports=Object.create(VideoFactory.prototype)},{"./HLSVideo":282,"./HTML5Video":283,"./ThreeSixtyVideo":284,"@marcom/useragent-detect":308}],286:[function(require,module,exports){'use strict';module.exports={getContentDimensions:require('./getContentDimensions'),getDimensions:require('./getDimensions'),getMaxScrollPosition:require('./getMaxScrollPosition'),getPagePosition:require('./getPagePosition'),getPercentInViewport:require('./getPercentInViewport'),getPixelsInViewport:require('./getPixelsInViewport'),getPosition:require('./getPosition'),getScrollPosition:require('./getScrollPosition'),getViewportPosition:require('./getViewportPosition'),isInViewport:require('./isInViewport')}},{"./getContentDimensions":287,"./getDimensions":288,"./getMaxScrollPosition":289,"./getPagePosition":290,"./getPercentInViewport":291,"./getPixelsInViewport":292,"./getPosition":293,"./getScrollPosition":294,"./getViewportPosition":295,"./isInViewport":296}],287:[function(require,module,exports){'use strict';module.exports=function getContentDimensions(el,rendered){var scale=1;if(rendered){scale=el.getBoundingClientRect().width/el.offsetWidth}
return{width:el.scrollWidth*scale,height:el.scrollHeight*scale}}},{}],288:[function(require,module,exports){'use strict';module.exports=function getDimensions(el,rendered){var rect;if(rendered){rect=el.getBoundingClientRect();return{width:rect.width,height:rect.height}}
return{width:el.offsetWidth,height:el.offsetHeight}}},{}],289:[function(require,module,exports){'use strict';function getTargetMaxScroll(el,axis){return axis==='x'?el.scrollWidth-el.clientWidth:el.scrollHeight-el.clientHeight}
module.exports=function getMaxScrollPosition(el,axis){var elType=typeof el;axis=elType==='string'?el:axis;el=(!el||elType==='string'||el===window)?document.documentElement:el;return(axis&&(/^[xy]$/i).test(axis))?getTargetMaxScroll(el,axis):{x:getTargetMaxScroll(el,'x'),y:getTargetMaxScroll(el,'y')}}},{}],290:[function(require,module,exports){'use strict';var getDimensions=require('./getDimensions');var getScrollPosition=require('./getScrollPosition');module.exports=function getPagePosition(el,rendered){var rect;if(rendered){var windowPosition=getScrollPosition();var bcRect=el.getBoundingClientRect();rect={top:bcRect.top+windowPosition.y,right:bcRect.right+windowPosition.x,bottom:bcRect.bottom+windowPosition.y,left:bcRect.left+windowPosition.x}}else{var dimensions=getDimensions(el);rect={top:el.offsetTop,right:dimensions.width,bottom:dimensions.height,left:el.offsetLeft};while((el=el.offsetParent)){rect.top+=el.offsetTop;rect.left+=el.offsetLeft}
rect.right+=rect.left;rect.bottom+=rect.top}
var htmlOffsetTop=document.documentElement.offsetTop;var htmlOffsetLeft=document.documentElement.offsetLeft;return{top:rect.top+htmlOffsetTop,right:rect.right+htmlOffsetLeft,bottom:rect.bottom+htmlOffsetTop,left:rect.left+htmlOffsetLeft}}},{"./getDimensions":288,"./getScrollPosition":294}],291:[function(require,module,exports){'use strict';var getDimensions=require('./getDimensions');var getPixelsInViewport=require('./getPixelsInViewport');module.exports=function getPercentInViewport(el,rendered){var inViewport=getPixelsInViewport(el,rendered);var dimensions=getDimensions(el,rendered);return({x:inViewport.x/dimensions.width,y:inViewport.y/dimensions.height})}},{"./getDimensions":288,"./getPixelsInViewport":292}],292:[function(require,module,exports){'use strict';var getViewportPosition=require('./getViewportPosition');module.exports=function getPixelsInViewport(el,rendered){var vw=window.innerWidth;var vh=window.innerHeight;var position=getViewportPosition(el,rendered);var pixels={x:(position.right-position.left),y:(position.bottom-position.top)};if(position.top<0){pixels.y+=position.top}
if(position.bottom>vh){pixels.y-=position.bottom-vh}
if(position.left<0){pixels.x+=position.left}
if(position.right>vw){pixels.x-=position.right-vw}
pixels.x=pixels.x<0?0:pixels.x;pixels.y=pixels.y<0?0:pixels.y;return pixels}},{"./getViewportPosition":295}],293:[function(require,module,exports){'use strict';var getDimensions=require('./getDimensions');module.exports=function getPosition(el,rendered){var rect;var rectTop;var rectLeft;var rectWidth;var rectHeight;var parentRect;var dimensions;if(rendered){rect=el.getBoundingClientRect();rectTop=rect.top;rectLeft=rect.left;rectWidth=rect.width;rectHeight=rect.height;if(el.offsetParent){parentRect=el.offsetParent.getBoundingClientRect();rectTop-=parentRect.top;rectLeft-=parentRect.left}}else{dimensions=getDimensions(el,rendered);rectTop=el.offsetTop;rectLeft=el.offsetLeft;rectWidth=dimensions.width;rectHeight=dimensions.height}
return{top:rectTop,right:rectLeft+rectWidth,bottom:rectTop+rectHeight,left:rectLeft}}},{"./getDimensions":288}],294:[function(require,module,exports){'use strict';function getWindowPosition(axis){return axis==='x'?(window.scrollX||window.pageXOffset):(window.scrollY||window.pageYOffset)}
function getTargetPosition(el,axis,isWindow){if(axis==='x'){return isWindow?getWindowPosition('x'):el.scrollLeft}
return isWindow?getWindowPosition('y'):el.scrollTop}
module.exports=function getScrollPosition(el,axis){var elType=typeof el;axis=elType==='string'?el:axis;el=(!el||elType==='string')?window:el;var isWindow=el===window;return(axis&&(/^[xy]$/i).test(axis))?getTargetPosition(el,axis,isWindow):{x:getTargetPosition(el,'x',isWindow),y:getTargetPosition(el,'y',isWindow)}}},{}],295:[function(require,module,exports){'use strict';var getPagePosition=require('./getPagePosition');var getScrollPosition=require('./getScrollPosition');module.exports=function getViewportPosition(el,rendered){var position;if(rendered){position=el.getBoundingClientRect();return{top:position.top,right:position.right,bottom:position.bottom,left:position.left}}
position=getPagePosition(el);var windowPosition=getScrollPosition();return{top:position.top-windowPosition.y,right:position.right-windowPosition.x,bottom:position.bottom-windowPosition.y,left:position.left-windowPosition.x}}},{"./getPagePosition":290,"./getScrollPosition":294}],296:[function(require,module,exports){'use strict';var getPercentInViewport=require('./getPercentInViewport');var getDimensions=require('./getDimensions');function normalizeThreshold(el,threshold,rendered){var defaultThreshold={x:0,y:0};if(!threshold){return defaultThreshold}
var thresholdType=typeof threshold;threshold=(thresholdType==='number'||thresholdType==='string')?{x:threshold,y:threshold}:Object.assign(defaultThreshold,threshold);var elDimensions;Object.keys(defaultThreshold).forEach(function(axis){var axisValue=threshold[axis];if(typeof axisValue==='string'||axisValue>1){elDimensions=elDimensions||getDimensions(el,rendered);var parsedAxisValue=parseInt(axisValue,10)||0;axisValue=parsedAxisValue/(axis==='x'?elDimensions.width:elDimensions.height)}
threshold[axis]=axisValue});return threshold}
module.exports=function isInViewport(el,rendered,threshold){var inViewport=getPercentInViewport(el,rendered);threshold=normalizeThreshold(el,threshold,rendered);return(inViewport.y>0&&inViewport.y>=threshold.y&&inViewport.x>0&&inViewport.x>=threshold.x)}},{"./getDimensions":288,"./getPercentInViewport":291}],297:[function(require,module,exports){'use strict';module.exports={getWindow:function(){return window},getDocument:function(){return document},getNavigator:function(){return navigator}}},{}],298:[function(require,module,exports){'use strict';var os=require('@marcom/useragent-detect').os;var touchAvailable=require('./touchAvailable').original;var globalsHelper=require('./helpers/globals');var once=require('@marcom/function-utils/once');function isDesktop(){var windowObj=globalsHelper.getWindow();return((!touchAvailable()&&!windowObj.orientation)||os.windows)}
module.exports=once(isDesktop);module.exports.original=isDesktop},{"./helpers/globals":297,"./touchAvailable":302,"@marcom/function-utils/once":303,"@marcom/useragent-detect":308}],299:[function(require,module,exports){'use strict';var isDesktop=require('./isDesktop').original;var isTablet=require('./isTablet').original;var once=require('@marcom/function-utils/once');function isHandheld(){return(!isDesktop()&&!isTablet())}
module.exports=once(isHandheld);module.exports.original=isHandheld},{"./isDesktop":298,"./isTablet":301,"@marcom/function-utils/once":303}],300:[function(require,module,exports){'use strict';var globalsHelper=require('./helpers/globals');module.exports=function isRetina(){var windowObj=globalsHelper.getWindow();return('devicePixelRatio' in windowObj&&windowObj.devicePixelRatio>=1.5)}},{"./helpers/globals":297}],301:[function(require,module,exports){'use strict';var isDesktop=require('./isDesktop').original;var globalsHelper=require('./helpers/globals');var once=require('@marcom/function-utils/once');var MIN_TABLET_WIDTH=600;function isTablet(){var windowObj=globalsHelper.getWindow();var width=windowObj.screen.width;if(windowObj.orientation&&windowObj.screen.height<width){width=windowObj.screen.height}
return(!isDesktop()&&width>=MIN_TABLET_WIDTH)}
module.exports=once(isTablet);module.exports.original=isTablet},{"./helpers/globals":297,"./isDesktop":298,"@marcom/function-utils/once":303}],302:[function(require,module,exports){'use strict';var globalsHelper=require('./helpers/globals');var once=require('@marcom/function-utils/once');function touchAvailable(){var windowObj=globalsHelper.getWindow();var documentObj=globalsHelper.getDocument();var navigatorObj=globalsHelper.getNavigator();return!!(('ontouchstart' in windowObj)||(windowObj.DocumentTouch&&documentObj instanceof windowObj.DocumentTouch)||(navigatorObj.maxTouchPoints>0)||(navigatorObj.msMaxTouchPoints>0))}
module.exports=once(touchAvailable);module.exports.original=touchAvailable},{"./helpers/globals":297,"@marcom/function-utils/once":303}],303:[function(require,module,exports){'use strict';module.exports=function once(func){var result;return function(){if(typeof result==='undefined'){result=func.apply(this,arguments)}
return result}}},{}],304:[function(require,module,exports){'use strict';module.exports=function throttle(func,wait){var timeout=null;var throttle=function(){if(timeout===null){func.apply(this,arguments);timeout=setTimeout(function(){timeout=null},wait)}};throttle.cancel=function(){clearTimeout(timeout)};return throttle}},{}],305:[function(require,module,exports){'use strict';module.exports={browser:{safari:!1,chrome:!1,firefox:!1,ie:!1,opera:!1,android:!1,edge:!1,version:{string:'',major:0,minor:0,patch:0,documentMode:!1}},os:{osx:!1,ios:!1,android:!1,windows:!1,linux:!1,fireos:!1,chromeos:!1,version:{string:'',major:0,minor:0,patch:0}}}},{}],306:[function(require,module,exports){'use strict';module.exports={browser:[{name:'edge',userAgent:'Edge',version:['rv','Edge'],test:function(navigatorObj){return(navigatorObj.ua.indexOf('Edge')>-1||navigatorObj.ua==='Mozilla/5.0 (Windows NT 10.0; Win64; x64)')}},{name:'chrome',userAgent:'Chrome'},{name:'firefox',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Firefox')>-1&&navigatorObj.ua.indexOf('Opera')===-1)},version:'Firefox'},{name:'android',userAgent:'Android'},{name:'safari',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Safari')>-1&&navigatorObj.vendor.indexOf('Apple')>-1)},version:'Version'},{name:'ie',test:function(navigatorObj){return(navigatorObj.ua.indexOf('IE')>-1||navigatorObj.ua.indexOf('Trident')>-1)},version:['MSIE','rv'],parseDocumentMode:function(){var documentModeForIE=!1;if(document.documentMode){documentModeForIE=parseInt(document.documentMode,10)}
return documentModeForIE}},{name:'opera',userAgent:'Opera',version:['Version','Opera']}],os:[{name:'windows',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Windows')>-1)},version:'Windows NT'},{name:'osx',userAgent:'Mac',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Macintosh')>-1)}},{name:'ios',test:function(navigatorObj){return(navigatorObj.ua.indexOf('iPhone')>-1||navigatorObj.ua.indexOf('iPad')>-1)},version:['iPhone OS','CPU OS']},{name:'linux',userAgent:'Linux',test:function(navigatorObj){return((navigatorObj.ua.indexOf('Linux')>-1||navigatorObj.platform.indexOf('Linux')>-1)&&navigatorObj.ua.indexOf('Android')===-1)}},{name:'fireos',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Firefox')>-1&&navigatorObj.ua.indexOf('Mobile')>-1)},version:'rv'},{name:'android',userAgent:'Android',test:function(navigatorObj){return(navigatorObj.ua.indexOf('Android')>-1)}},{name:'chromeos',userAgent:'CrOS'}]}},{}],307:[function(require,module,exports){'use strict';var defaults=require('./defaults');var dictionary=require('./dictionary');function _matchVersionStrRegExp(str){return new RegExp(str+'[a-zA-Z\\s/:]+([0-9_.]+)','i')}
function _parseVersion(data,ua){if(typeof data.parseVersion==='function'){return data.parseVersion(ua)}else{var versionSearchStr=data.version||data.userAgent;if(typeof versionSearchStr==='string'){versionSearchStr=[versionSearchStr]}
var versionSearchStrLength=versionSearchStr.length;var match;for(var i=0;i<versionSearchStrLength;i++){match=ua.match(_matchVersionStrRegExp(versionSearchStr[i]));if(match&&match.length>1){return match[1].replace(/_/g,'.')}}}
return!1}
function _parseUserAgent(dictionaryData,defaultObj,navigatorObj){var dictionaryDataLength=dictionaryData.length;var current;var currentVersion;for(var i=0;i<dictionaryDataLength;i++){if(typeof dictionaryData[i].test==='function'){if(dictionaryData[i].test(navigatorObj)===!0){current=dictionaryData[i].name}}else{if(navigatorObj.ua.indexOf(dictionaryData[i].userAgent)>-1){current=dictionaryData[i].name}}
if(current){defaultObj[current]=!0;currentVersion=_parseVersion(dictionaryData[i],navigatorObj.ua);if(typeof currentVersion==='string'){var versionBreakdown=currentVersion.split('.');defaultObj.version.string=currentVersion;if(versionBreakdown&&versionBreakdown.length>0){defaultObj.version.major=parseInt(versionBreakdown[0]||0);defaultObj.version.minor=parseInt(versionBreakdown[1]||0);defaultObj.version.patch=parseInt(versionBreakdown[2]||0)}}else if(current==='edge'){defaultObj.version.string='12.0.0';defaultObj.version.major='12';defaultObj.version.minor='0';defaultObj.version.patch='0'}
if(typeof dictionaryData[i].parseDocumentMode==='function'){defaultObj.version.documentMode=dictionaryData[i].parseDocumentMode()}
return defaultObj}}
return defaultObj}
function parseUserAgent(navigatorObj){var userAgent={};userAgent.browser=_parseUserAgent(dictionary.browser,defaults.browser,navigatorObj);userAgent.os=_parseUserAgent(dictionary.os,defaults.os,navigatorObj);return userAgent}
module.exports=parseUserAgent},{"./defaults":305,"./dictionary":306}],308:[function(require,module,exports){'use strict';var navigatorObj={ua:window.navigator.userAgent,platform:window.navigator.platform,vendor:window.navigator.vendor};module.exports=require('./parseUserAgent')(navigatorObj)},{"./parseUserAgent":307}],309:[function(require,module,exports){arguments[4][91][0].apply(exports,arguments)},{"./ac-event-emitter/EventEmitter":310,"dup":91}],310:[function(require,module,exports){arguments[4][92][0].apply(exports,arguments)},{"dup":92}],311:[function(require,module,exports){'use strict';var AUTOFILM_MODAL_DATA_ATTRIBUTE='data-films-modal-link';var INLINE_TARGET_DATA_ATTRIBUTE='data-films-inline-target';var createFilms=require('./factory/createFilms');var defer=!0;var timeout;function AutoFilms(context,options){if(!(this instanceof AutoFilms)&&defer){defer=!1;timeout=setTimeout(AutoFilms,1);return function(context,options){clearTimeout(timeout);return new AutoFilms(context,options)}}
context=context||document;var modalAnchors=Array.prototype.slice.call(context.querySelectorAll('['+AUTOFILM_MODAL_DATA_ATTRIBUTE+']'));var inlineAnchors=Array.prototype.slice.call(context.querySelectorAll('['+INLINE_TARGET_DATA_ATTRIBUTE+']'));var returnObject;if(modalAnchors.length){returnObject=createFilms(modalAnchors,Object.assign(options||{},{modal:!0}))}else if(inlineAnchors.length){var targets={};var i=0;var len=inlineAnchors.length;for(;i<len;i++){var curr=inlineAnchors[i];var target=curr.getAttribute(INLINE_TARGET_DATA_ATTRIBUTE);if(!targets[target]){targets[target]=[]}
targets[target].push(curr)}
for(var key in targets){if(targets.hasOwnProperty(key)){returnObject=createFilms(targets[key],Object.assign(options||{},{targetElement:context.querySelector('#'+key)}))}}}
return returnObject}
module.exports=AutoFilms()},{"./factory/createFilms":316}],312:[function(require,module,exports){'use strict';var ac_analytics;try{ac_analytics=require('@marcom/ac-analytics')}catch(e){}
var browser=require('@marcom/useragent-detect').browser;var IS_IE_OR_EDGE=browser.ie||browser.edge;var EventEmitterMicro=require('@marcom/ac-video/event-emitter-shim/EventEmitterShim');var specialOnce=function specialOnce(eventName,callback,context){if(context){var cb=function cb(){callback.apply(context,arguments)};EventEmitterMicro.prototype.once.apply(this,[eventName,cb])}else{EventEmitterMicro.prototype.once.apply(this,arguments)}};function AnalyticsTranslator(player,options,anchors){this.player=player;this.sources={};this.currentStubPlayer=null;this.playerType='';this.videoType='';this.options=options;if(anchors){this._bindAnchors(anchors)}}
var proto=AnalyticsTranslator.prototype;proto._bindAnchors=function(anchors){var i=0;var len=anchors.length;for(;i<len;i++){this._bindAnchorForAnalytics(anchors[i])}};proto.activate=function(){this._onPlay=this._onPlay.bind(this);this._onEnded=this._onEnded.bind(this);this._onTimeupdate=this._onTimeupdate.bind(this);this._onTexttrackshow=this._onTexttrackshow.bind(this);this._onLoadStart=this._onLoadStart.bind(this);this.setCurrentStubPlayer=this.setCurrentStubPlayer.bind(this);this._onPlayPromiseResolved=this._onPlayPromiseResolved.bind(this);if(IS_IE_OR_EDGE){this.player.on('playing',this._onPlay)}else{this.player.on('play',this._onPlay)}
this.player.on('ended',this._onEnded);this.player.on('loadstart',this._onLoadStart);this.player.on('timeupdate',this._onTimeupdate);this.player.on('texttrackshow',this._onTexttrackshow);this.player.on('PlayPromiseResolved',this._onPlayPromiseResolved);this.player.on('durationchange',this.setCurrentStubPlayer)};proto.deactivate=function(){if(IS_IE_OR_EDGE){this.player.off('playing',this._onPlay)}else{this.player.off('play',this._onPlay)}
this.player.off('ended',this._onEnded);this.player.off('timeupdate',this._onTimeupdate);this.player.off('texttrackshow',this._onTexttrackshow);this.player.off('durationchange',this.setCurrentStubPlayer);this.player.off('PlayPromiseResolved',this._onPlayPromiseResolved)};proto._bindAnchorForAnalytics=function(anchor){var stubPlayer;var analyticsVideoId;if(anchor){if(this.sources[anchor.id]){return}
stubPlayer=this._createStubPlayer(anchor);analyticsVideoId=anchor.getAttribute('data-'+this.options.dataAttribute);if(!analyticsVideoId){stubPlayer.videoId=anchor.id}
this.sources[anchor.id]={stubPlayer:stubPlayer,observer:this._createObserver(stubPlayer)}}};proto.addSourceObject=proto._bindAnchorForAnalytics;proto.setCurrentStubPlayer=function(){var currentSrc;var playerEl=this.player.el;var currentSrcId=playerEl.getAttribute('data-'+this.options.dataAttribute);var srcObj=this._getCurrentSourceObject(currentSrcId);if(srcObj&&srcObj.stubPlayer){this.currentStubPlayer=srcObj.stubPlayer;this.playerType='html5';currentSrc=this.player.getCurrentSrc();if(currentSrc){this.videoType=currentSrc.split('.').pop()}}};proto.destroy=function(){this.deactivate();this.player=null;this.sources=null;this.currentStubPlayer=null;this.options=null};proto._onPlay=function(){this.setCurrentStubPlayer();if(!this._started){this._proxyEvent('play');this._started=!0}};proto._onPlayPromiseResolved=function(){this.setCurrentStubPlayer();this._proxyEvent('PlayPromiseResolved')};proto._onLoadStart=function(){this._started=!1};proto._onEnded=function(){this._started=!1;this._proxyEvent('ended')};proto._onTimeupdate=function(){this._proxyEvent('timeupdate');if(this._started&&this.player.getCurrentTime()===0&&this.player.getPaused()){this._started=!1}};proto._onTexttrackshow=function(){this._proxyEvent('captions-enabled')};proto._getSourceObjectBySrcObjId=function(srcObjId){return this.sources[srcObjId]||null};proto._getCurrentSourceObject=function(srcObjId){var assoc;if(srcObjId){assoc=this._getSourceObjectBySrcObjId(srcObjId)}
return assoc};proto._createStubPlayer=function(el){var stubPlayer=new EventEmitterMicro();stubPlayer.once=specialOnce;stubPlayer.el=el;stubPlayer.VERSION=this.player.VERSION;return stubPlayer};proto._getEventData=function(){return{currentTime:this.player.getCurrentTime(),playerType:this.playerType||'html5',videoType:this.videoType||null}};proto._createObserver=function(stubPlayer){var observer;if(ac_analytics&&ac_analytics.observer&&ac_analytics.observer.Video){observer=new ac_analytics.observer.Video(stubPlayer,{dataAttribute:this.options.dataAttribute})}
return observer};proto._proxyEvent=function(eventName){if(this.currentStubPlayer){this.currentStubPlayer.trigger(eventName,this._getEventData())}};module.exports=AnalyticsTranslator},{"@marcom/ac-analytics":"@marcom/ac-analytics","@marcom/ac-video/event-emitter-shim/EventEmitterShim":202,"@marcom/useragent-detect":308}],313:[function(require,module,exports){'use strict';var windowLoad=require('../windowload/windowLoad');var userAgent=require('@marcom/useragent-detect');var touchAvailable=require('@marcom/feature-detect/touchAvailable')();var IS_MOBILE=userAgent.os.ios||userAgent.os.android||userAgent.os.osx&&touchAvailable;module.exports=function bindAnchor(anchor,clickHandler,playHandler,router){var callbackObj={'click':function click(evt){evt.preventDefault();clickHandler(anchor)},'TriggerAnchor':function TriggerAnchor(){clickHandler(anchor)}};Object.keys(callbackObj).forEach(function(key){anchor.addEventListener(key,callbackObj[key])});if(router&&anchor.id){router.createRoute(anchor.id,function(){windowLoad(function(){clickHandler(anchor,!IS_MOBILE)})})}
return{detatch:function detatch(){Object.keys(callbackObj).forEach(function(key){anchor.removeEventListener(key,callbackObj[key])})}}}},{"../windowload/windowLoad":323,"@marcom/feature-detect/touchAvailable":302,"@marcom/useragent-detect":308}],314:[function(require,module,exports){'use strict';var Router=require('@marcom/ac-router').Router;var createPlayer=require('@marcom/ac-video/player/factory/createShareablePlayer');var optimizeVideoUrl=require('@marcom/ac-video/optimizeVideoUrl');var userAgent=require('@marcom/useragent-detect');var bindAnchor=require('./bindAnchor');var createClickHandler=require('./createClickHandler');var createModalLink=require('./createModalLink');var createHandheldModalLink=require('./createHandheldModalLink');var createInlineLink=require('./createInlineLink');var OPTIONS_DATA_ATTRIBUTE='data-films-options';var IS_HANDHELD=require('@marcom/feature-detect/isHandheld')();var IS_IOS=userAgent.os.ios;var DEFAULT_OPTIONS={controls:!0,urlOptimizer:optimizeVideoUrl};module.exports=function bindAnchors(anchors,options){options=options||{};options=Object.assign({},DEFAULT_OPTIONS,options);var router;anchors.forEach(function(a){if(a.hasAttribute(OPTIONS_DATA_ATTRIBUTE)){var opts=JSON.parse(a.getAttribute(OPTIONS_DATA_ATTRIBUTE));if(opts.closeOnEnd===!1&&!options.closeOnEnd){options.closeOnEnd=!1}}});if(!options.maxWidth){options.maxWidth=1280}
var player=createPlayer(options);var filmsObj;router=new Router({hashChange:!0,pushState:!1});if(options.modal&&(!IS_HANDHELD||!IS_IOS||options.threesixty)){filmsObj=createModalLink(player,options)}else if(options.modal){filmsObj=createHandheldModalLink(player,document.body,options)}else{filmsObj=createInlineLink(player,options)}
var boundFilmsObjectPlay=filmsObj.play.bind(filmsObj);var playHandler=function playHandler(id){var i=0;var len=anchors.length;for(;i<len;i++){if(anchors[i].id===id||anchors[i]===id){boundFilmsObjectPlay(anchors[i].href)}}};var clickHandler=createClickHandler({player:player,playHandler:boundFilmsObjectPlay,attr:'data-'+options.dataAttribute});var anchorMap=new Map();anchors.forEach(function(anchor){anchorMap.set(anchor,bindAnchor(anchor,clickHandler,boundFilmsObjectPlay,router))});var detatch=function detatch(anchor,key){anchor.detatch();anchorMap.delete(key)};router.start();return{play:playHandler,player:player,modalVideo:filmsObj.modal,destroy:function destroy(){anchorMap.forEach(detatch);filmsObj.destroy()}}}},{"./bindAnchor":313,"./createClickHandler":315,"./createHandheldModalLink":317,"./createInlineLink":318,"./createModalLink":319,"@marcom/ac-router":157,"@marcom/ac-video/optimizeVideoUrl":203,"@marcom/ac-video/player/factory/createShareablePlayer":209,"@marcom/feature-detect/isHandheld":299,"@marcom/useragent-detect":308}],315:[function(require,module,exports){'use strict';var OPTIONS_DATA_ATTRIBUTE='data-films-options';var MODAL_LABEL_ATTRIBUTE='data-films-modal-label';var DEFAULT_LABEL='Video Player';var DARK_THEME_SELECTOR='.theme-dark';var DEFAULT_DARK_POSTER='https://www.apple.com/ac/ac-video-posterframe/4.0/images/ac_video_poster_dark_960x540.jpg';var DEFAULT_DARK_POSTER_2X='https://www.apple.com/ac/ac-video-posterframe/4.0/images/ac_video_poster_dark_960x540_2x.jpg';var isRetina=require('@marcom/feature-detect/isRetina');module.exports=function createClickHandler(options){return function(target,autoplay){var defaultPoster=null;if(Array.from(document.querySelectorAll(DARK_THEME_SELECTOR)).find(function(el){return el.contains(options.player.el)})){defaultPoster=isRetina()?DEFAULT_DARK_POSTER_2X:DEFAULT_DARK_POSTER}
var optionsAttr=target.getAttribute(OPTIONS_DATA_ATTRIBUTE);var metadata=void 0;if(optionsAttr){metadata=JSON.parse(optionsAttr)}else{metadata=null}
if(metadata&&metadata.endState){metadata.endState.items.forEach(function(item){if(item.url&&item.url.indexOf('#')===0){var realLink=document.querySelector(item.url);item.onclick=function(){realLink.dispatchEvent(new CustomEvent('TriggerAnchor'))}}})}
if(!metadata){metadata={}}
if(!metadata.poster){metadata.poster=defaultPoster}
var label=target.getAttribute(MODAL_LABEL_ATTRIBUTE)||metadata&&metadata.modalLabel||options.player.options.modalLabel||DEFAULT_LABEL;options.player.el.setAttribute(options.attr,target.getAttribute(options.attr)||target.id);options.playHandler(target.href,metadata,autoplay,label)}}},{"@marcom/feature-detect/isRetina":300}],316:[function(require,module,exports){'use strict';var bindAnchors=require('./bindAnchors');var AnalyticsTranslator=require('../analytics/AnalyticsTranslator');var defaults={dataAttribute:'analytics-video-id',analytics:!0};var log=require('@marcom/ac-console/log');var VERSION=require('../../../.versionfile');log('@marcom/ac-films version: '+VERSION.toString());module.exports=function createFilms(anchors,options){options=options||{};options=Object.assign({},defaults,options);var bindObj=bindAnchors(anchors,options);if(options.analytics){var analyticsTranslator=new AnalyticsTranslator(bindObj.player,options,anchors);analyticsTranslator.activate()}
return bindObj}},{"../../../.versionfile":1,"../analytics/AnalyticsTranslator":312,"./bindAnchors":314,"@marcom/ac-console/log":51}],317:[function(require,module,exports){'use strict';var AC_FILMS_HANDHELD_PLAYER='ac-films-handheld-player';var PLAYER_FULLSCREEN='player-fullscreen';module.exports=function createHandheldModalLink(player,targetElement,options){player.el.classList.add(AC_FILMS_HANDHELD_PLAYER);var playHandler=function playHandler(url,autoplay){var endHandler=function endHandler(){if(!player.getPaused()){player.pause()}
player.el.classList.remove(PLAYER_FULLSCREEN)};player.el.classList.add(PLAYER_FULLSCREEN);player.once('ended',endHandler);player.once('exitfullscreen',endHandler);player.load(url);if(autoplay!==!1){player.play()}};targetElement.appendChild(player.el);return{play:playHandler,player:player,destroy:function destroy(){player.destroy()}}}},{}],318:[function(require,module,exports){'use strict';module.exports=function createInlineLink(player,options){var targetElement=options.targetElement;var playHandler=function playHandler(url,metadata){player.load(url,null,0,metadata);player.play()};options.playHandler=playHandler;if(targetElement){targetElement.appendChild(player.el)}
return{play:playHandler,player:player,destroy:function destroy(){player.destroy()}}}},{}],319:[function(require,module,exports){'use strict';var createFullViewportModal=require('@marcom/ac-modal').createFullViewportModal;var userAgent=require('@marcom/useragent-detect');var touchAvailable=require('@marcom/feature-detect/touchAvailable')();var IS_MOBILE=userAgent.os.ios||userAgent.os.android||userAgent.os.osx&&touchAvailable;var MOBILE_CLASSNAME='ac-films-modal-mobile';var ModalLink=require('./link/ModalLink');var AC_MODAL_VIDEO='ac-modal-video';module.exports=function createModalLink(player,options){options=options||{};var container=document.createElement('div');container.classList.add('ac-player-container');if(IS_MOBILE){container.classList.add(MOBILE_CLASSNAME)}
container.appendChild(player.el);var modal=createFullViewportModal(container);modal.modalElement.classList.add(AC_MODAL_VIDEO);var link=new ModalLink({player:player,modal:modal,closeOnEnd:options.closeOnEnd});return link}},{"./link/ModalLink":320,"@marcom/ac-modal":118,"@marcom/feature-detect/touchAvailable":302,"@marcom/useragent-detect":308}],320:[function(require,module,exports){'use strict';var CINEMATIC_ASPECT_RATIO_MARKER='-tft-';var URL_SIZE=/_([0-9]+)x([0-9]+)/;var PLAYER_CINEMATIC_CLASS='ac-video-cinematic-aspect-ratio';var PLAYER_SQUARE_CLASS='ac-video-square-aspect-ratio';var PLAYER_VERTICAL_CLASS='ac-video-vertical-aspect-ratio';var PLAYER_19X9_CLASS='ac-video-19x9-aspect-ratio';var PLAYER_9X19_CLASS='ac-video-9x19-aspect-ratio';var AC_MODAL_VIDEO_PIP='ac-modal-video-pip';var PIP_CHANGE_EVENT='pictureinpicture:change';var HAS_MODAL='has-modal';var ResizeHandler=require('../../resize/ResizeHandler');var _19X9_ASSET_SIZES=require('@marcom/ac-video/utils/urlOptimizer/19X9AssetSizes');var containsMatch=function containsMatch(array,urlSize){return array.find(function(size){return size.width===urlSize.width&&(size.height=urlSize.height)||size.width===urlSize.height&&(size.height=urlSize.width)})};var ModalLink=function ModalLink(options){this.modal=options.modal;this.player=options.player;this._resizeHandler=new ResizeHandler({player:this.player,modal:this.modal});this._closeOnEnd=options.closeOnEnd!==undefined?options.closeOnEnd:!0;this._ended=!1;this._pauseTime=0;this._playing=!1;this._initialize()};var proto=ModalLink.prototype;proto._initialize=function(){this._bindMethods();this.player.on('ended',this._onEnded);this.player.on('pause',this._onPaused);this.modal.on('open',this._onOpen);if(this.player.supportsPictureInPicture()){this.player.on(PIP_CHANGE_EVENT,this._onPipModeChanged)}};proto._bindMethods=function(){this._onEnded=this._onEnded.bind(this);this._onPipModeChanged=this._onPipModeChanged.bind(this);this._onPaused=this._onPaused.bind(this);this._onModalWillClose=this._onModalWillClose.bind(this);this._onOpen=this._onOpen.bind(this)};proto._onOpen=function(){this.player.refreshSize()};proto._onPaused=function(){this._pauseTime=Date.now()};proto._onEnded=function(){this._ended=!0;if(!this.player.isPictureInPicture()&&this._closeOnEnd){this.modal.close()}else if(this.player.isPictureInPicture()){this.player.setPictureInPicture(!1);this.modal.modalElement.classList.remove(AC_MODAL_VIDEO_PIP);if(!this._closeOnEnd){this.modal.open();this._bindWillClose()}}};proto._onPipModeChanged=function(){if(this._ended){return}
if(this.player.isPictureInPicture()&&this._isModalOpen()){this._unBindWillClose();this.modal.modalElement.classList.add(AC_MODAL_VIDEO_PIP);this.modal.close()}else if(!this._isModalOpen()){this.modal.modalElement.classList.remove(AC_MODAL_VIDEO_PIP);if(!this._pauseTime||Date.now()-this._pauseTime>400){this._bindWillClose();this.modal.open()}else{this._resetVideo()}}};proto._resetVideo=function(){this.player.pause();this.player.setCurrentTime(0)};proto._onModalWillClose=function(){this._unBindWillClose();this._resetVideo();this.player.setPictureInPicture(!1);this.modal.modalElement.classList.remove(AC_MODAL_VIDEO_PIP)};proto._clearAspectRatio=function(){this.player.el.parentElement.classList.remove(PLAYER_CINEMATIC_CLASS);this.player.el.parentElement.classList.remove(PLAYER_SQUARE_CLASS);this.player.el.parentElement.classList.remove(PLAYER_VERTICAL_CLASS);this.player.el.parentElement.classList.remove(PLAYER_19X9_CLASS);this.player.el.parentElement.classList.remove(PLAYER_9X19_CLASS)};proto._set19X9Mode=function(){this.player.el.parentElement.classList.add(PLAYER_19X9_CLASS)};proto._set9X19Mode=function(){this.player.el.parentElement.classList.add(PLAYER_9X19_CLASS)};proto._setCinematicMode=function(){this.player.el.parentElement.classList.add(PLAYER_CINEMATIC_CLASS)};proto._setSquareVideo=function(){this.player.el.parentElement.classList.add(PLAYER_SQUARE_CLASS)};proto._setVerticalVideo=function(){this.player.el.parentElement.classList.add(PLAYER_VERTICAL_CLASS)};proto._resetPiPVideo=function(){var visibleTracks=this.player.getVisibleTextTracks();visibleTracks.forEach(function(tt){tt.mode='hidden'});this._resetVideo();visibleTracks.forEach(function(tt){tt.mode='showing'})};proto.play=function(url,metadata,autoplay,label){this._ended=!1;this._clearAspectRatio();if(url.match(CINEMATIC_ASPECT_RATIO_MARKER)){this._setCinematicMode()}else if(URL_SIZE.test(url)){var width=parseInt(RegExp.$1,10);var height=parseInt(RegExp.$2,10);if(containsMatch(_19X9_ASSET_SIZES,{width:width,height:height})){if(height>width){this._set9X19Mode(!0)}else{this._set19X9Mode(!0)}}else if(height>width){this._setVerticalVideo(!0)}else if(height===width){this._setSquareVideo(!0)}}
this.modal.modalElement.setAttribute('aria-label',label);this.player.load(url,null,0,Object.assign({},metadata,{maxWidth:window.innerWidth}));if(!this.player.isPictureInPicture()){this.modal.open();this._bindWillClose()}else{this._resetPiPVideo()}
if(autoplay!==!1){this.player.play()}};proto._bindWillClose=function(){this.modal.on('willclose',this._onModalWillClose)};proto._unBindWillClose=function(){this.modal.off('willclose',this._onModalWillClose)};proto._isModalOpen=function(){return document.documentElement.classList.contains(HAS_MODAL)};proto.destroy=function(){this.player.off('ended',this._onEnded);this.player.off('paused',this._onPaused);this.player.off(PIP_CHANGE_EVENT,this._onPipModeChanged);this._unBindWillClose();this._resizeHandler.destroy();this.modal.destroy();this.player.destroy()};module.exports=ModalLink},{"../../resize/ResizeHandler":322,"@marcom/ac-video/utils/urlOptimizer/19X9AssetSizes":279}],321:[function(require,module,exports){'use strict';require('../AutoFilms')()},{"../AutoFilms":311}],322:[function(require,module,exports){'use strict';var URL_SIZE=/_([0-9]+)x([0-9]+)/;var userAgent=require('@marcom/useragent-detect');var touchAvailable=require('@marcom/feature-detect/touchAvailable')();var IS_MOBILE=userAgent.os.ios||userAgent.os.android||userAgent.os.osx&&touchAvailable;function ResizeHandler(options){this._modal=options.modal;this._player=options.player;this._mediaElement=options.player.getMediaElement();this._posterEl=this._player.el.querySelector('.ac-video-poster img');this._playerContainer=this._player.el.parentElement;this._bindMethods();this._addEventListeners();this._calcAspectRatio()}
var proto=ResizeHandler.prototype;proto._bindMethods=function(){this._onLoadStart=this._onLoadStart.bind(this);this._onResize=this._onResize.bind(this);this._fullScreenChange=this._fullScreenChange.bind(this);this._calcAspectRatio=this._calcAspectRatio.bind(this);this._addResizeListeners=this._addResizeListeners.bind(this);this._removeResizeListeners=this._removeResizeListeners.bind(this);this._onModalOpen=this._onModalOpen.bind(this)};proto._addEventListeners=function(){if(this._posterEl){this._posterEl.addEventListener('load',this._calcAspectRatio)}
this._modal.on('willopen',this._addResizeListeners);this._modal.on('open',this._onModalOpen);this._modal.on('close',this._removeResizeListeners)};proto._onModalOpen=function(){if(this._loadStarted){this._onResize();this._player.el.style.display='';this._player.el.style.opacity=''}};proto._addResizeListeners=function(){this._mediaElement=this._player.getMediaElement();this._player.el.style.display='block';this._player.el.style.opacity=0;window.addEventListener('resize',this._onResize);window.addEventListener('orientationchange',this._onResize);this._player.on('loadstart',this._onLoadStart);this._player.on('loadeddata',this._calcAspectRatio);this._player.on('fullscreen:change',this._fullScreenChange);this._player.on('fullscreen:willenter',this._fullScreenChange);this._calcAspectRatio()};proto._removeResizeListeners=function(){this._onResize();window.removeEventListener('resize',this._onResize);window.removeEventListener('orientationchange',this._onResize);this._player.off('loadstart',this._onLoadStart);this._player.off('loadeddata',this._calcAspectRatio);this._player.off('fullscreen:change',this._fullScreenChange)};proto._removeEventListeners=function(){this._removeResizeListeners();this._modal.off('willopen',this._addResizeListeners);this._modal.off('open',this._onModalOpen);this._modal.off('close',this._removeResizeListeners);if(this._posterEl){this._posterEl.removeEventListener('load',this._calcAspectRatio)}};proto._onLoadStart=function(){this._mediaElement=this._player.getMediaElement();this._loadStarted=!1;requestAnimationFrame(function(){this._loadStarted=!0;this._onModalOpen()}.bind(this));this._calcAspectRatio()};proto._calcAspectRatio=function(){this._aspectRatio=this._player.getMediaWidth()/this._player.getMediaHeight();if((isNaN(this._aspectRatio)||this._aspectRatio<=0)&&this._player.getCurrentSrc()){if(URL_SIZE.test(this._player.getCurrentSrc())){this._aspectRatio=parseInt(RegExp.$1,10)/parseInt(RegExp.$2,10)}}
if((isNaN(this._aspectRatio)||this._aspectRatio<=0)&&this._posterEl){this._aspectRatio=this._posterEl.naturalWidth/this._posterEl.naturalHeight}
this._onResize()};proto._fullScreenChange=function(evt){if(evt&&evt.type==='enter'){clearTimeout(this._fullScreenChangeTimeout);this._fullScreenChangeTimeout=setTimeout(function(){this._isFullScreen=!0;this._onResize()}.bind(this),60);return}
this._isFullScreen=this._player.isFullscreen();this._onResize()};proto.destroy=function(){clearTimeout(this._fullScreenChangeTimeout);this._removeEventListeners()};proto._onResize=function(){var aspectRatio=this._aspectRatio;if(isNaN(aspectRatio)){this._mediaElement.style.width='';this._mediaElement.style.height='';return}
var windowWidth=window.innerWidth;var windowHeight=window.innerHeight;var windowAspectRatio=windowWidth/windowHeight;if(this._mediaElement.readyState<1){var maxWidth=parseInt(getComputedStyle(this._playerContainer).maxWidth.replace('px',''));var maxHeight=maxWidth/aspectRatio;var playerMaxHeight=IS_MOBILE?parseInt(getComputedStyle(this._player.el).maxHeight.replace('px','')):maxHeight;if(maxHeight>windowHeight||playerMaxHeight&&maxHeight>playerMaxHeight){maxWidth=(playerMaxHeight||windowHeight)*aspectRatio;maxHeight=Math.min(maxWidth/aspectRatio,windowHeight)}
if(maxWidth>windowWidth||maxWidth>maxHeight*aspectRatio){maxHeight=Math.min(windowWidth/aspectRatio,windowHeight);maxWidth=maxHeight*aspectRatio}
this._mediaElement.style.width=maxWidth+'px';this._mediaElement.style.height=Math.min(maxHeight,windowHeight)+'px'}else{this._mediaElement.style.width='';this._mediaElement.style.height=''}
if(windowAspectRatio>aspectRatio&&!this._isFullScreen){this._playerContainer.parentElement.classList.add('center-horizontal')}else{this._playerContainer.parentElement.classList.remove('center-horizontal')}
this._player.refreshSize()};module.exports=ResizeHandler},{"@marcom/feature-detect/touchAvailable":302,"@marcom/useragent-detect":308}],323:[function(require,module,exports){'use strict';var isLoaded=!1;window.addEventListener('load',function(){isLoaded=!0});function windowLoad(func){if(isLoaded){func()}else{window.addEventListener('load',func)}}
module.exports=windowLoad},{}]},{},[321])